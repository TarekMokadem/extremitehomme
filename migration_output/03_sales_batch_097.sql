-- Migration des ventes (tickets) - Batch 97/97
-- Généré automatiquement
-- Tickets 48001 à 48051

-- Insertion des ventes
INSERT INTO sales (id, ticket_number, vendor_id, client_id, subtotal_ht, total_tva, subtotal_ttc, total, status, created_at, old_mysql_id)
VALUES
(gen_random_uuid(), 'T-20260107-0007', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 1007), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-07 00:00:00', 48019),
(gen_random_uuid(), 'T-20260107-0008', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3398), 13.33, 2.67, 16.0, 16.0, 'completed', '2026-01-07 00:00:00', 48020),
(gen_random_uuid(), 'T-20260107-0009', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3667), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-07 00:00:00', 48021),
(gen_random_uuid(), 'T-20260107-0010', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), NULL, 16.67, 3.33, 20.0, 20.0, 'completed', '2026-01-07 00:00:00', 48022),
(gen_random_uuid(), 'T-20260107-0011', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 1933), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-07 00:00:00', 48023),
(gen_random_uuid(), 'T-20260107-0012', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 2697), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-07 00:00:00', 48024),
(gen_random_uuid(), 'T-20260107-0013', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3287), 16.67, 3.33, 20.0, 20.0, 'completed', '2026-01-07 00:00:00', 48025),
(gen_random_uuid(), 'T-20260107-0014', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 1747), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-07 00:00:00', 48026),
(gen_random_uuid(), 'T-20260107-0015', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3224), 42.5, 8.5, 51.0, 51.0, 'completed', '2026-01-07 00:00:00', 48027),
(gen_random_uuid(), 'T-20260107-0016', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 1246), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-07 00:00:00', 48028),
(gen_random_uuid(), 'T-20260107-0017', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 506), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-07 00:00:00', 48029),
(gen_random_uuid(), 'T-20260107-0018', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3717), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-07 00:00:00', 48030),
(gen_random_uuid(), 'T-20260107-0019', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 1341), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-07 00:00:00', 48031),
(gen_random_uuid(), 'T-20260107-0020', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), NULL, 82.5, 16.5, 99.0, 99.0, 'completed', '2026-01-07 00:00:00', 48032),
(gen_random_uuid(), 'T-20260107-0021', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3760), 13.33, 2.67, 16.0, 16.0, 'completed', '2026-01-07 00:00:00', 48033),
(gen_random_uuid(), 'T-20260107-0022', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3742), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-07 00:00:00', 48034),
(gen_random_uuid(), 'T-20260107-0023', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 2639), 16.67, 3.33, 20.0, 20.0, 'completed', '2026-01-07 00:00:00', 48035),
(gen_random_uuid(), 'T-20260107-0024', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3782), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-07 00:00:00', 48036),
(gen_random_uuid(), 'T-20260108-0001', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3170), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48037),
(gen_random_uuid(), 'T-20260108-0002', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 277), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48038),
(gen_random_uuid(), 'T-20260108-0003', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 885), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48039),
(gen_random_uuid(), 'T-20260108-0004', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 365), 16.67, 3.33, 20.0, 20.0, 'completed', '2026-01-08 00:00:00', 48040),
(gen_random_uuid(), 'T-20260108-0005', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), NULL, 16.67, 3.33, 20.0, 20.0, 'completed', '2026-01-08 00:00:00', 48041),
(gen_random_uuid(), 'T-20260108-0006', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 1447), 16.67, 3.33, 20.0, 20.0, 'completed', '2026-01-08 00:00:00', 48042),
(gen_random_uuid(), 'T-20260108-0007', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 1160), 20.83, 4.17, 25.0, 25.0, 'completed', '2026-01-08 00:00:00', 48043),
(gen_random_uuid(), 'T-20260108-0008', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 1259), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48044),
(gen_random_uuid(), 'T-20260108-0009', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3169), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48045),
(gen_random_uuid(), 'T-20260108-0010', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3773), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48046),
(gen_random_uuid(), 'T-20260108-0011', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 786), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48047),
(gen_random_uuid(), 'T-20260108-0012', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3649), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48048),
(gen_random_uuid(), 'T-20260108-0013', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 425), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48049),
(gen_random_uuid(), 'T-20260108-0014', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3227), 13.33, 2.67, 16.0, 16.0, 'completed', '2026-01-08 00:00:00', 48050),
(gen_random_uuid(), 'T-20260108-0015', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 2528), 16.67, 3.33, 20.0, 20.0, 'completed', '2026-01-08 00:00:00', 48051),
(gen_random_uuid(), 'T-20260108-0016', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 603), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48052),
(gen_random_uuid(), 'T-20260108-0017', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 1918), 69.67, 13.93, 83.6, 83.6, 'completed', '2026-01-08 00:00:00', 48053),
(gen_random_uuid(), 'T-20260108-0018', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 961), 41.67, 8.33, 50.0, 50.0, 'completed', '2026-01-08 00:00:00', 48054),
(gen_random_uuid(), 'T-20260108-0019', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3426), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48055),
(gen_random_uuid(), 'T-20260108-0020', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3344), 16.67, 3.33, 20.0, 20.0, 'completed', '2026-01-08 00:00:00', 48056),
(gen_random_uuid(), 'T-20260108-0021', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), NULL, 13.33, 2.67, 16.0, 16.0, 'completed', '2026-01-08 00:00:00', 48057),
(gen_random_uuid(), 'T-20260108-0022', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 931), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48058),
(gen_random_uuid(), 'T-20260108-0023', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 1240), 15.0, 3.0, 18.0, 18.0, 'completed', '2026-01-08 00:00:00', 48059),
(gen_random_uuid(), 'T-20260108-0024', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), NULL, 25.0, 5.0, 30.0, 30.0, 'completed', '2026-01-08 00:00:00', 48060),
(gen_random_uuid(), 'T-20260108-0025', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3419), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48061),
(gen_random_uuid(), 'T-20260108-0026', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 2429), 29.17, 5.83, 35.0, 35.0, 'completed', '2026-01-08 00:00:00', 48062),
(gen_random_uuid(), 'T-20260108-0027', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 2269), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48063),
(gen_random_uuid(), 'T-20260108-0028', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), NULL, 16.67, 3.33, 20.0, 20.0, 'completed', '2026-01-08 00:00:00', 48064),
(gen_random_uuid(), 'T-20260108-0029', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3853), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-08 00:00:00', 48065),
(gen_random_uuid(), 'T-20260109-0001', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 1713), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-09 00:00:00', 48066),
(gen_random_uuid(), 'T-20260109-0002', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 7), (SELECT id FROM vendors LIMIT 1)), NULL, 41.67, 8.33, 50.0, 50.0, 'completed', '2026-01-09 00:00:00', 48067),
(gen_random_uuid(), 'T-20260109-0003', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 2), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3119), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-09 00:00:00', 48068),
(gen_random_uuid(), 'T-20260109-0004', COALESCE((SELECT new_id FROM migration_vendor_mapping WHERE old_id = 1), (SELECT id FROM vendors LIMIT 1)), (SELECT new_id FROM migration_client_mapping WHERE old_id = 3703), 23.33, 4.67, 28.0, 28.0, 'completed', '2026-01-09 00:00:00', 48069)
ON CONFLICT DO NOTHING;

-- Mettre à jour le mapping
INSERT INTO migration_sale_mapping (old_id, new_id)
SELECT old_mysql_id, id FROM sales WHERE old_mysql_id IS NOT NULL
ON CONFLICT DO NOTHING;

-- Vérification finale
SELECT 'Ventes migrées:' as info, COUNT(*) as total FROM sales;
SELECT 'Mapping créé:' as info, COUNT(*) as total FROM migration_sale_mapping;
