import{c as ee,a as q,r as C,s as N,i as Me,d as te,u as Be,b as y,e,t as g,f as s,F as K,g as O,n as L,h as E,j as F,k as Ve,l as X,m as ce,o as p,p as Ae,w as be,T as we,q as fe,v as ne,x as ie,H as Ue,L as He}from"./index-DodYGpJ8.js";import{E as Ke}from"./euro-_aVnEfKE.js";import{P as Ge,f as Ne,I as je,S as Oe,a as ue}from"./formatInputs-eH51u1C3.js";import{M as Qe,U as qe,a as Je}from"./user-plus-Be-_qFL1.js";import{M as We}from"./minus-DHnZ2jXn.js";import{P as Ze}from"./plus-Bh6hCo_W.js";import{T as De}from"./trash-2-BKEdKMe_.js";import{B as Ye,C as Xe,S as et,G as Ie}from"./smartphone-WB621kRV.js";import{F as tt}from"./file-text-C3Ju1Lll.js";import{C as st}from"./clock-DXDJg47w.js";import{S as ge}from"./search-By6t2NqO.js";const xe=ee("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const at=ee("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);const lt=ee("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);const ot=ee("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);const rt=ee("user-pen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]]);const nt=ee("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const it=ee("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),D=C([]),le=C("euro"),W=C(0),B=C([]),me=C([]),pe=C(!1),Y=C(null),ct=.2;function Ce(){const x=(a,c=1,r)=>{const o=D.value.find(v=>v.product.id===a.id&&(r?v.vendor_id===r.id:!v.vendor_id));if(o)o.quantity+=c,l(o);else{const v={product:a,quantity:c,vendor_id:r?.id,vendor:r,price_ht:a.price_ht,tva_rate:a.tva_rate||ct,subtotal_ht:0,tva:0,subtotal_ttc:0};l(v),D.value.push(v)}},l=a=>{const c=a.product.price_ttc;a.subtotal_ttc=c*a.quantity;const r=1+a.tva_rate;a.subtotal_ht=a.subtotal_ttc/r,a.tva=a.subtotal_ttc-a.subtotal_ht,a.price_ht=a.subtotal_ht/a.quantity},f=(a,c)=>c?D.value.find(r=>r.product.id===a&&r.vendor_id===c):D.value.find(r=>r.product.id===a),S=(a,c,r)=>{const o=f(a,r);o&&(c<=0?b(a,o.vendor_id):(o.quantity=c,l(o)))},b=(a,c)=>{if(c)D.value=D.value.filter(r=>!(r.product.id===a&&r.vendor_id===c));else{const r=D.value.findIndex(o=>o.product.id===a);r!==-1&&D.value.splice(r,1)}},h=()=>{D.value=[],W.value=0,B.value=[]},P=q(()=>D.value.reduce((a,c)=>a+c.subtotal_ht,0)),T=q(()=>D.value.reduce((a,c)=>a+c.tva,0)),t=q(()=>P.value+T.value),n=q(()=>{if(W.value<=0)return 0;if(le.value==="euro")return Math.min(W.value,t.value);{const a=Math.min(W.value,100);return t.value*a/100}}),i=q(()=>Math.max(0,t.value-n.value)),$=q(()=>D.value.reduce((a,c)=>a+c.quantity,0)),z=q(()=>D.value.length===0),I=(a,c)=>{le.value=a,W.value=Math.max(0,c)},U=()=>{le.value="euro",W.value=0},G=(a,c)=>{const r=B.value.find(o=>o.method===a);r?r.amount+=c:B.value.push({method:a,amount:c})},R=(a,c)=>{const r=B.value.find(o=>o.method===a);r?r.amount=c:B.value.push({method:a,amount:c})},Z=a=>{B.value=B.value.filter(c=>c.method!==a)},J=()=>{B.value=[]},V=q(()=>B.value.reduce((a,c)=>a+c.amount,0)),A=q(()=>Math.max(0,i.value-V.value)),H=q(()=>Math.max(0,V.value-i.value)),_=q(()=>V.value>=i.value&&i.value>0),u=()=>{const a=new Date,c=a.toISOString().split("T")[0].replace(/-/g,""),r=a.getTime().toString().slice(-4);return`T-${c}-${r}`};return{cartItems:D,discountType:le,discountValue:W,selectedPaymentMethods:B,recentSales:me,isProcessing:pe,error:Y,subtotalHT:P,totalTVA:T,subtotalTTC:t,discountAmount:n,total:i,itemCount:$,isEmpty:z,totalPaid:V,remainingToPay:A,change:H,isPaymentComplete:_,addToCart:x,updateQuantity:S,removeFromCart:b,clearCart:h,setDiscount:I,clearDiscount:U,addPayment:G,setPayment:R,removePayment:Z,clearPayments:J,validateSale:async(a,c)=>{if(z.value)return Y.value="Le panier est vide",null;if(!c)return Y.value="Veuillez sélectionner ou créer un client avant de valider",null;if(!_.value)return Y.value="Le paiement n'est pas complet",null;if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(a))return Y.value="Aucun vendeur sélectionné. Veuillez sélectionner un vendeur.",console.error("vendorId invalide:",a),null;pe.value=!0,Y.value=null,console.log("Validation vente - vendorId:",a,"clientId:",c);try{let o;if(Me()){const{data:w}=await N.rpc("generate_ticket_number");o=w||u()}const v={ticket_number:o,vendor_id:a,client_id:c||null,subtotal_ht:P.value,total_tva:T.value,subtotal_ttc:t.value,discount_type:le.value,discount_value:W.value,discount_amount:n.value,total:i.value,status:"completed"},se=D.value.map(w=>({product_id:w.product.id,variant_id:w.variant?.id||null,vendor_id:w.vendor_id||a,product_name:w.product.name,price_ht:w.price_ht,tva_rate:w.tva_rate,quantity:w.quantity,subtotal_ht:w.subtotal_ht,tva:w.tva,subtotal_ttc:w.subtotal_ttc})),ze=B.value.map(w=>({method:w.method,amount:w.amount}));Me();const{data:ae,error:Te}=await N.from("sales").insert(v).select().single();if(Te)throw Te;const Fe=se.map(w=>({...w,sale_id:ae.id})),{error:Ee}=await N.from("sale_items").insert(Fe);if(Ee)throw Ee;const Re=ze.map(w=>({...w,sale_id:ae.id})),{error:Pe}=await N.from("payments").insert(Re);if(Pe)throw Pe;for(const w of D.value)w.product.type==="product"&&(await N.from("products").update({stock:w.product.stock-w.quantity}).eq("id",w.product.id),await N.from("stock_movements").insert({product_id:w.product.id,variant_id:w.variant?.id||null,type:"out",quantity:-w.quantity,reason:"Vente",reference_id:ae.id,vendor_id:a}));if(c){const{data:w}=await N.from("clients").select("visit_count, total_spent, loyalty_points").eq("id",c).single();w&&await N.from("clients").update({visit_count:w.visit_count+1,total_spent:w.total_spent+i.value,last_visit_at:new Date().toISOString()}).eq("id",c)}return me.value.unshift(ae),h(),ae}catch(o){return console.error("Erreur validation vente:",o),Y.value=o.message||"Erreur lors de la validation",null}finally{pe.value=!1}},loadRecentSales:async(a=10)=>{try{const{data:c,error:r}=await N.from("sales").select(`
          *,
          vendor:vendors(*),
          client:clients(*),
          items:sale_items(*),
          payments(*)
        `).order("created_at",{ascending:!1}).limit(a);if(r)throw r;return me.value=c||[],c}catch(c){return console.error("Erreur chargement ventes:",c),[]}},getSaleById:async a=>{try{const{data:c,error:r}=await N.from("sales").select(`
          *,
          vendor:vendors(*),
          client:clients(*),
          items:sale_items(*, product:products(*)),
          payments(*)
        `).eq("id",a).single();return r?null:c}catch{return null}},cancelSale:async(a,c)=>{try{const{error:r}=await N.from("sales").update({status:"cancelled",notes:c}).eq("id",a);if(r)throw r;return!0}catch(r){return console.error("Erreur annulation vente:",r),!1}}}}const dt=[{id:"1",first_name:"Jean",last_name:"Dupont",phone:"06 12 34 56 78",phone2:null,email:"jean.dupont@email.com",address:"123 Rue de la Paix",city:"Paris",postal_code:"75001",birth_date:"1985-03-15",notes:"Client fidèle",loyalty_points:150,total_spent:450,visit_count:15,last_visit_at:"2026-01-15",created_at:"",updated_at:""},{id:"2",first_name:"Marie",last_name:"Martin",phone:"06 98 76 54 32",phone2:"01 23 45 67 89",email:"marie.martin@email.com",address:"456 Avenue des Champs",city:"Lyon",postal_code:"69001",birth_date:"1990-07-22",notes:null,loyalty_points:75,total_spent:225,visit_count:8,last_visit_at:"2026-01-20",created_at:"",updated_at:""},{id:"3",first_name:"Pierre",last_name:"Bernard",phone:"07 11 22 33 44",phone2:null,email:null,address:null,city:null,postal_code:null,birth_date:null,notes:"Préfère les rendez-vous le samedi",loyalty_points:30,total_spent:90,visit_count:3,last_visit_at:"2026-01-10",created_at:"",updated_at:""}],ve=C([]),ye=C(null),he=C(!1),oe=C(null);function de(){return{clients:ve,selectedClient:ye,isLoading:he,error:oe,loadClients:async()=>{he.value=!0,oe.value=null;try{const{data:t,error:n}=await N.from("clients").select("*").order("last_name");if(n)throw n;ve.value=t||[]}catch(t){console.error("Erreur chargement clients:",t),oe.value=t.message,ve.value=dt}finally{he.value=!1}},searchClients:async t=>{if(!t||t.length<2)return[];try{const{data:n,error:i}=await N.from("clients").select("*").or(`first_name.ilike.%${t}%,last_name.ilike.%${t}%,phone.ilike.%${t}%`).limit(10);if(i)throw i;return n||[]}catch(n){return console.error("Erreur recherche clients:",n),[]}},getClientById:async t=>{try{const{data:n,error:i}=await N.from("clients").select("*").eq("id",t).single();return i?null:n}catch{return null}},createClient:async t=>{console.log("createClient appelé avec:",t);try{console.log("Insertion dans Supabase...");const{data:n,error:i}=await N.from("clients").insert({first_name:t.first_name,last_name:t.last_name,phone:t.phone,phone2:t.phone2||null,email:t.email||null,address:t.address||null,city:t.city||null,postal_code:t.postal_code||null,birth_date:t.birth_date||null,notes:t.notes||null}).select().single();if(i)throw console.error("Erreur Supabase:",i),i;return console.log("Client créé avec succès:",n),n}catch(n){return console.error("Erreur création client:",n),oe.value=n.message,null}},updateClient:async(t,n)=>{console.log("updateClient appelé avec:",t,n);try{const{data:i,error:$}=await N.from("clients").update(n).eq("id",t).select().single();if($)throw $;return console.log("Client mis à jour:",i),i}catch(i){return console.error("Erreur mise à jour client:",i),oe.value=i.message,null}},selectClient:t=>{ye.value=t},clearSelection:()=>{ye.value=null},updateClientAfterSale:async(t,n)=>{try{const{data:i}=await N.from("clients").select("visit_count, total_spent").eq("id",t).single();i&&await N.from("clients").update({visit_count:i.visit_count+1,total_spent:i.total_spent+n,last_visit_at:new Date().toISOString()}).eq("id",t)}catch(i){console.error("Erreur mise à jour client après vente:",i)}}}}const ke=C(null),Q=C([]),_e=C(!1),$e=()=>{Q.value=Array.from({length:10},(x,l)=>({position:l+1,isStamped:!1,date:null}))},ut=async x=>{ke.value=x,_e.value=!0;try{const{data:l,error:f}=await N.from("loyalty_transactions").select("*").eq("client_id",x).eq("type","earned").order("created_at",{ascending:!1}).limit(10);if(f)throw f;const S=l||[];Q.value=Array.from({length:10},(b,h)=>{const P=S[h];return{position:h+1,isStamped:!!P,date:P?.created_at||null}})}catch(l){console.error("Erreur chargement points:",l),Q.value.length===0&&$e()}finally{_e.value=!1}},mt=x=>{const l=Q.value.find(f=>f.position===x);l&&(l.isStamped=!l.isStamped,l.isStamped||(l.date=null))},Le=q(()=>Q.value.filter(x=>x.isStamped).length),pt=q(()=>Le.value===10),vt=async(x,l,f)=>{const S=Q.value.filter(b=>b.isStamped&&!b.date);if(S.length!==0)try{const b=S.map(t=>({client_id:x,vendor_id:l,sale_id:f,points:1,type:"earned",notes:`Point ${t.position}/10`})),{data:h,error:P}=await N.from("loyalty_transactions").insert(b).select("created_at");if(P)throw P;if(h&&h.length>0){let t=0;Q.value=Q.value.map(n=>{if(n.isStamped&&!n.date&&h[t]){const i=h[t].created_at;return t+=1,{...n,date:i}}return n})}const{data:T}=await N.from("clients").select("loyalty_points").eq("id",x).single();if(T){const{error:t}=await N.from("clients").update({loyalty_points:T.loyalty_points+S.length}).eq("id",x);t&&console.warn("Erreur mise à jour points client:",t)}console.log(`✅ ${S.length} point(s) de fidélité attribué(s)`)}catch(b){console.error("Erreur sauvegarde points:",b)}},yt=()=>{ke.value=null,$e()};function Se(){return{stamps:Q,selectedClientId:ke,isLoading:_e,checkedCount:Le,isCardComplete:pt,initializeCard:$e,loadClientStamps:ut,toggleStamp:mt,saveStamps:vt,clearStamps:yt}}const ht={class:"card h-full flex flex-col overflow-hidden"},ft={class:"p-4 md:p-5 border-b border-gray-200 bg-gray-50"},gt={class:"flex items-center justify-between"},xt={class:"text-xs md:text-sm font-semibold text-gray-900"},_t={class:"flex-1 overflow-y-auto p-4 md:p-5 space-y-2 md:space-y-3 min-h-0"},bt={class:"flex items-start justify-between gap-2 md:gap-3 mb-2 md:mb-3"},wt={class:"flex-1 min-w-0"},Ct={class:"font-medium text-gray-900 line-clamp-2 text-xs md:text-sm leading-snug"},kt={key:0,class:"text-[10px] text-gray-500 mt-0.5"},$t={class:"font-bold text-gray-900 whitespace-nowrap text-sm md:text-base tabular-nums"},St={class:"flex items-center justify-between"},Tt={class:"flex items-center gap-2"},Et=["onClick"],Pt={class:"w-7 md:w-9 text-center text-xs md:text-sm font-semibold tabular-nums"},Mt=["onClick"],Nt=["onClick"],jt={key:1,class:"h-full flex items-center justify-center py-8"},qt={class:"px-4 py-3 md:px-5 md:py-4 border-t border-gray-100"},Vt={class:"flex flex-col gap-2 md:gap-3"},At={class:"flex items-center justify-between gap-2"},Dt={class:"inline-flex items-center bg-gray-100 rounded-full p-0.5 shadow-inner border border-gray-200"},It={class:"flex items-center gap-2"},Lt=["value","max"],zt={class:"text-xs md:text-sm font-medium text-gray-500 min-w-[24px] md:min-w-[32px] text-center"},Ft={class:"px-4 py-3 md:px-5 md:py-4 border-t border-gray-100 bg-gray-50"},Rt={class:"grid grid-cols-3 md:grid-cols-2 gap-1.5 md:gap-2"},Bt=["onClick"],Ut={class:"font-medium truncate"},Ht={class:"p-4 md:p-5 border-t-2 border-gray-200 bg-white"},Kt={class:"space-y-2 md:space-y-2.5 mb-3 md:mb-4"},Gt={class:"flex justify-between text-xs md:text-sm"},Ot={class:"text-gray-700 tabular-nums"},Qt={class:"flex justify-between text-xs md:text-sm"},Jt={class:"text-gray-700 tabular-nums"},Wt={class:"flex justify-between text-xs md:text-sm font-medium"},Zt={class:"text-gray-900 tabular-nums"},Yt={key:0,class:"flex justify-between text-xs md:text-sm"},Xt={class:"text-gray-600"},es={class:"text-[10px] md:text-xs"},ts={class:"text-red-600 font-medium tabular-nums"},ss={class:"flex justify-between text-xl md:text-2xl font-bold pt-2 md:pt-3 border-t border-gray-200"},as={class:"text-gray-900 tabular-nums"},ls={class:"grid grid-cols-4 gap-1.5 md:gap-2"},os={class:"btn-icon-sm p-2 md:p-3",title:"Imprimer","aria-label":"Imprimer"},rs={class:"btn-icon-sm p-2 md:p-3",title:"Email","aria-label":"Envoyer par email"},ns=["disabled"],is={key:0,class:"animate-spin"},cs=te({__name:"TicketPanel",setup(x){const{cartItems:l,subtotalHT:f,totalTVA:S,subtotalTTC:b,total:h,discountAmount:P,selectedPaymentMethods:T,updateQuantity:t,removeFromCart:n,clearCart:i,setDiscount:$,setPayment:z,validateSale:I,isProcessing:U}=Ce(),{vendor:G}=Be(),{selectedClient:R}=de(),{saveStamps:Z,loadClientStamps:J}=Se(),V=C("euro"),A=C(0),H=C("card"),_=[{id:"cash",label:"Espèces",icon:Ye},{id:"card",label:"CB",icon:Xe},{id:"contactless",label:"Sans contact",icon:et},{id:"check",label:"Chèque",icon:tt},{id:"gift_card",label:"Cadeau",icon:Ie}],u=r=>r.toFixed(2),d=r=>{V.value=r,r==="percent"&&(A.value=Math.min(A.value,100)),$(V.value,A.value)},m=r=>{const o=r.target,v=Number(o.value);V.value==="percent"?A.value=Math.min(v,100):A.value=Math.min(v,b.value),$(V.value,A.value)},k=r=>{H.value=r,z(r,h.value)},j=async()=>{if(l.value.length===0)return;if(!R.value){alert("Veuillez sélectionner ou créer un client avant de valider la vente.");return}T.value.length===0&&z(H.value,h.value);const r=await I(G.value?.id||"demo",R.value?.id);r&&(R.value&&G.value&&(await Z(R.value.id,G.value.id,r.id),await J(R.value.id)),alert(`✅ Vente validée !
Ticket: ${r.ticket_number}
Total: ${u(r.total)}€`))},a=q(()=>new Date().toLocaleDateString("fr-FR")),c=q(()=>V.value==="percent"?100:b.value);return q(()=>b.value),(r,o)=>(p(),y("div",ht,[e("div",ft,[e("div",gt,[e("div",null,[o[3]||(o[3]=e("p",{class:"text-[10px] md:text-[11px] text-gray-500 uppercase tracking-wider font-semibold mb-1"},"Date",-1)),e("p",xt,g(a.value),1)]),o[4]||(o[4]=e("div",{class:"text-right"},[e("p",{class:"text-[10px] md:text-[11px] text-gray-500 uppercase tracking-wider font-semibold mb-1"},"Ticket"),e("p",{class:"text-xs md:text-sm font-semibold text-gray-900"},"#001")],-1))])]),e("div",_t,[s(l).length>0?(p(!0),y(K,{key:0},O(s(l),v=>(p(),y("div",{key:`${v.product.id}-${v.vendor_id||"default"}`,class:"cart-item"},[e("div",bt,[e("div",wt,[e("p",Ct,g(v.product.name),1),v.vendor?(p(),y("p",kt," par "+g(v.vendor.initials||`${v.vendor.first_name} ${v.vendor.last_name}`),1)):F("",!0)]),e("p",$t,g(u(v.subtotal_ttc))+"€ ",1)]),e("div",St,[e("div",Tt,[e("button",{onClick:se=>s(t)(v.product.id,v.quantity-1,v.vendor_id),class:"w-8 h-8 md:w-9 md:h-9 rounded-lg bg-white border border-gray-300 flex items-center justify-center hover:bg-gray-100 hover:border-gray-400 transition-colors","aria-label":"Diminuer la quantité"},[E(s(We),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})],8,Et),e("span",Pt,g(v.quantity),1),e("button",{onClick:se=>s(t)(v.product.id,v.quantity+1,v.vendor_id),class:"w-8 h-8 md:w-9 md:h-9 rounded-lg bg-white border border-gray-300 flex items-center justify-center hover:bg-gray-100 hover:border-gray-400 transition-colors","aria-label":"Augmenter la quantité"},[E(s(Ze),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})],8,Mt)]),e("button",{onClick:se=>s(n)(v.product.id,v.vendor_id),class:"p-1.5 md:p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors","aria-label":"Supprimer l'article"},[E(s(De),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})],8,Nt)])]))),128)):(p(),y("div",jt,[...o[5]||(o[5]=[e("p",{class:"text-gray-400 text-xs md:text-sm"},"Aucun article",-1)])]))]),e("div",qt,[e("div",Vt,[e("div",At,[o[10]||(o[10]=e("label",{class:"text-xs md:text-sm text-gray-600 font-medium"},"Réduction",-1)),e("div",Dt,[e("button",{onClick:o[0]||(o[0]=v=>d("euro")),class:L(["inline-flex items-center gap-0.5 md:gap-1 px-2 md:px-3 py-1 md:py-1.5 text-[10px] md:text-xs font-semibold rounded-full transition-all duration-150",V.value==="euro"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-800"])},[E(s(Ke),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),o[6]||(o[6]=e("span",{class:"hidden sm:inline"},"Montant",-1)),o[7]||(o[7]=e("span",{class:"sm:hidden"},"€",-1))],2),e("button",{onClick:o[1]||(o[1]=v=>d("percent")),class:L(["inline-flex items-center gap-0.5 md:gap-1 px-2 md:px-3 py-1 md:py-1.5 text-[10px] md:text-xs font-semibold rounded-full transition-all duration-150",V.value==="percent"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-800"])},[E(s(Ge),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),o[8]||(o[8]=e("span",{class:"hidden sm:inline"},"Pourcentage",-1)),o[9]||(o[9]=e("span",{class:"sm:hidden"},"%",-1))],2)])]),e("div",It,[e("input",{type:"number",value:A.value,onInput:m,min:"0",max:c.value,step:"0.01",class:"flex-1 px-3 md:px-4 py-2 md:py-2.5 bg-gray-50 border border-gray-300 rounded-lg text-xs md:text-sm text-right focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 hover:border-gray-400 transition-all tabular-nums"},null,40,Lt),e("span",zt,g(V.value==="percent"?"%":"€"),1)])])]),e("div",Ft,[o[11]||(o[11]=e("p",{class:"text-[10px] md:text-[11px] text-gray-600 uppercase tracking-wider font-semibold mb-2 md:mb-3"},"Règlement",-1)),e("div",Rt,[(p(),y(K,null,O(_,v=>e("button",{key:v.id,onClick:se=>k(v.id),class:L(["payment-btn text-[10px] md:text-xs",H.value===v.id&&"active"])},[(p(),X(ce(v.icon),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})),e("span",Ut,g(v.label),1)],10,Bt)),64))])]),e("div",Ht,[e("div",Kt,[e("div",Gt,[o[12]||(o[12]=e("span",{class:"text-gray-500"},"Sous-total HT",-1)),e("span",Ot,g(u(s(f)))+"€",1)]),e("div",Qt,[o[13]||(o[13]=e("span",{class:"text-gray-500"},"TVA (20%)",-1)),e("span",Jt,g(u(s(S)))+"€",1)]),e("div",Wt,[o[14]||(o[14]=e("span",{class:"text-gray-600"},"Sous-total TTC",-1)),e("span",Zt,g(u(s(b)))+"€",1)]),A.value>0?(p(),y("div",Yt,[e("span",Xt,[o[15]||(o[15]=Ve(" Réduction ",-1)),e("span",es,"("+g(V.value==="percent"?`${A.value}%`:`${u(A.value)}€`)+")",1)]),e("span",ts,"-"+g(u(s(P)))+"€",1)])):F("",!0),e("div",ss,[o[16]||(o[16]=e("span",{class:"text-gray-900"},"Total",-1)),e("span",as,g(u(s(h)))+"€",1)])]),e("div",ls,[e("button",os,[E(s(at),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})]),e("button",rs,[E(s(Qe),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})]),e("button",{onClick:o[2]||(o[2]=(...v)=>s(i)&&s(i)(...v)),class:"btn-icon-sm p-2 md:p-3 text-orange-600 hover:bg-orange-50 hover:border-orange-200",title:"Annuler","aria-label":"Annuler la transaction"},[E(s(lt),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})]),e("button",{onClick:j,disabled:s(l).length===0||s(U),class:L(["btn-icon-sm p-2 md:p-3",s(l).length>0&&!s(U)?"bg-emerald-600 text-white hover:bg-emerald-700 border-emerald-600":"bg-gray-100 text-gray-400 cursor-not-allowed border-gray-200"]),title:"Valider","aria-label":"Valider la transaction"},[s(U)?(p(),y("span",is,"⏳")):(p(),X(s(xe),{key:1,class:"w-4 h-4 md:w-5 md:h-5"}))],10,ns)])])]))}}),ds=["aria-label"],us=["aria-label"],ms={class:"service-name"},ps={class:"service-info"},vs={class:"service-price"},ys={key:0,class:"service-duration"},hs={class:"hidden sm:inline"},fs={class:"sm:hidden"},gs=te({__name:"ServiceCard",props:{service:{}},setup(x){const l=x,{addToCart:f,cartItems:S}=Ce(),{getCategoryBorderColor:b}=Ae(),h=q(()=>{const t=S.value.find(n=>n.product.id===l.service.id);return t?t.quantity:0}),P=q(()=>b(l.service)),T=()=>{f(l.service)};return(t,n)=>(p(),y("button",{onClick:T,"aria-label":`Ajouter ${x.service.name} au panier`,class:L(["service-card",P.value,h.value>0&&"active"])},[h.value>0?(p(),y("div",{key:0,class:"quantity-badge","aria-label":`Quantité: ${h.value}`},g(h.value),9,us)):F("",!0),e("h3",ms,g(x.service.name),1),e("div",ps,[e("span",vs,g(x.service.price_ttc?.toFixed(2)||x.service.price_ht?.toFixed(2))+"€",1),x.service.duration?(p(),y("span",ys,[E(s(st),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),e("span",hs,g(x.service.duration)+"min",1),e("span",fs,g(x.service.duration)+"'",1)])):F("",!0)])],10,ds))}}),xs=(x,l)=>{const f=x.__vccOpts||x;for(const[S,b]of l)f[S]=b;return f},_s=xs(gs,[["__scopeId","data-v-055b3dd1"]]),bs={class:"card p-4"},ws={class:"flex items-center justify-between mb-3"},Cs={class:"flex items-center gap-2"},ks={class:"w-8 h-8 rounded-full bg-yellow-100 flex items-center justify-center"},$s={class:"text-xs text-gray-500"},Ss={key:0,class:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold"},Ts={class:"grid grid-cols-10 gap-2 w-full"},Es=["onClick"],Ps={key:0,class:"absolute inset-0 flex items-center justify-center bg-yellow-500/20"},Ms={key:0,class:"absolute bottom-0.5 left-0 right-0 text-xs text-yellow-700 font-semibold leading-tight"},Ns=te({__name:"LoyaltyCard",setup(x){const{stamps:l,checkedCount:f,isCardComplete:S,toggleStamp:b}=Se(),h=P=>{if(!P)return"";const T=new Date(P),t=String(T.getDate()).padStart(2,"0"),n=String(T.getMonth()+1).padStart(2,"0"),i=T.getFullYear();return`${t}/${n}/${i}`};return(P,T)=>(p(),y("div",bs,[e("div",ws,[e("div",Cs,[e("div",ks,[E(s(Ie),{class:"w-4 h-4 text-yellow-600"})]),T[0]||(T[0]=e("span",{class:"text-sm font-semibold text-gray-900"},"Carte fidélité",-1)),e("span",$s,g(s(f))+"/10",1)]),s(S)?(p(),y("span",Ss,[E(s(xe),{class:"w-3.5 h-3.5"}),T[1]||(T[1]=Ve(" Complète ",-1))])):F("",!0)]),e("div",Ts,[(p(!0),y(K,null,O(s(l),t=>(p(),y("button",{key:t.position,onClick:n=>s(b)(t.position),class:L(["relative aspect-square w-full max-w-none rounded-xl border-2 transition-all duration-200 flex flex-col items-center justify-center overflow-hidden",t.isStamped?"border-yellow-500 bg-yellow-50 hover:bg-yellow-100":"border-gray-300 bg-white hover:bg-gray-50 hover:border-gray-400"])},[e("span",{class:L(["text-base font-bold",t.isStamped?"text-yellow-600":"text-gray-400"])},g(t.position),3),E(we,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"scale-0 opacity-0","enter-to-class":"scale-100 opacity-100"},{default:be(()=>[t.isStamped?(p(),y("div",Ps,[E(s(xe),{class:"w-6 h-6 text-yellow-600 drop-shadow"})])):F("",!0)]),_:2},1024),t.isStamped&&t.date?(p(),y("span",Ms,g(h(t.date)),1)):F("",!0)],10,Es))),128))])]))}}),js={class:"card flex flex-col bg-white h-full"},qs={class:"p-4 md:p-6 border-b border-gray-200 bg-white space-y-3"},Vs={class:"relative"},As={class:"flex items-center gap-3"},Ds={class:"relative flex-1"},Is={key:0,class:"text-xs text-red-500 mt-1.5"},Ls={class:"relative"},zs={class:"relative"},Fs=["value"],Rs={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-xl border border-gray-200 py-2 z-50 max-h-60 md:max-h-80 overflow-y-auto"},Bs=["onClick"],Us={class:"flex-1 min-w-0"},Hs={class:"text-sm font-medium text-gray-900 truncate"},Ks={class:"text-xs text-gray-500 mt-0.5"},Gs={class:"flex items-center gap-2 md:gap-3 ml-2 md:ml-3"},Os={class:"text-sm font-bold text-gray-900 tabular-nums"},Qs={key:0,class:"text-xs text-gray-400 hidden sm:inline"},Js={class:"flex-1 overflow-y-auto p-4 md:p-6 bg-gray-50 space-y-4"},Ws={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2.5 md:gap-3.5"},Zs={key:1,class:"h-full flex flex-col items-center justify-center text-gray-400 py-12"},Ys=te({__name:"ServiceGrid",setup(x){const{products:l,searchProducts:f}=Ae(),{addToCart:S}=Ce(),{selectedClient:b}=de(),{loadClientStamps:h,clearStamps:P}=Se(),T=C([]);(async()=>{const{data:m}=await N.from("vendors").select("*").eq("is_active",!0);T.value=m||[]})(),fe(b,m=>{m?h(m.id):P()});const n=C(""),i=C(!1),$=C([]),z=C(""),I=C(""),U=q(()=>{const m=n.value.toLowerCase().trim();return m?l.value.filter(k=>k.name.toLowerCase().includes(m)||k.code?.toLowerCase().includes(m)):l.value}),G=async m=>{const k=m.target;n.value=k.value,k.value.trim().length>=2?($.value=await f(k.value),i.value=$.value.length>0):($.value=[],i.value=!1)},R=()=>{n.value.trim().length>=2&&$.value.length>0&&(i.value=!0)},Z=()=>{setTimeout(()=>{i.value=!1},200)},J=m=>{n.value=m.name,i.value=!1},V=m=>{if(m.key==="Enter"&&$.value.length>0){m.preventDefault();const k=$.value[0];S(k),n.value="",$.value=[],i.value=!1}};fe(n,m=>{m.trim().length<2&&($.value=[],i.value=!1)});const A=m=>{const k=m.trim().toUpperCase();if(k.length<2)return null;const j=k.match(/^([A-Z]+)(\d+.*)$/);return j?{vendorInitials:j[1],productCode:j[2]}:null},H=m=>T.value.find(k=>k.initials?.toUpperCase()===m.toUpperCase()),_=m=>l.value.find(k=>k.code?.toUpperCase()===m.toUpperCase()),u=m=>{m.key==="Enter"&&(m.preventDefault(),d())},d=()=>{I.value="";const m=A(z.value);if(!m){I.value="Format invalide (ex: VL1)";return}const k=H(m.vendorInitials);if(!k){I.value=`Vendeur "${m.vendorInitials}" non trouvé`;return}const j=_(m.productCode);if(!j){I.value=`Service "${m.productCode}" non trouvé`;return}S(j,1,k),z.value="",I.value=""};return(m,k)=>(p(),y("div",js,[e("div",qs,[e("div",Vs,[e("div",As,[e("div",Ds,[E(s(it),{class:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-amber-500 pointer-events-none z-10"}),ne(e("input",{"onUpdate:modelValue":k[0]||(k[0]=j=>z.value=j),onKeydown:u,type:"text",placeholder:"Raccourci (ex: VL1)",class:"w-full pl-11 pr-4 py-2.5 bg-amber-50 border border-amber-300 rounded-xl text-sm font-mono font-semibold uppercase focus:outline-none focus:border-amber-500 focus:ring-2 focus:ring-amber-500/20 hover:border-amber-400 transition-all placeholder:normal-case placeholder:font-normal",autocomplete:"off"},null,544),[[ie,z.value]])]),e("button",{onClick:d,class:"px-4 py-2.5 bg-amber-500 text-white rounded-xl font-medium hover:bg-amber-600 transition-colors text-sm"}," OK ")]),I.value?(p(),y("p",Is,g(I.value),1)):F("",!0)]),e("div",Ls,[e("div",zs,[E(s(ge),{class:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-gray-400 pointer-events-none z-10"}),e("input",{value:n.value,onInput:G,onFocus:R,onBlur:Z,onKeydown:V,type:"text",placeholder:"Rechercher un service...",class:"w-full pl-11 md:pl-14 pr-4 md:pr-5 py-3 md:py-3.5 bg-gray-50 border border-gray-300 rounded-xl text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 hover:border-gray-400 transition-all",autocomplete:"off"},null,40,Fs)]),E(we,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:be(()=>[i.value&&$.value.length>0?(p(),y("div",Rs,[(p(!0),y(K,null,O($.value,j=>(p(),y("button",{key:j.id,onClick:a=>J(j),class:"w-full px-4 md:px-5 py-2.5 md:py-3 text-left hover:bg-gray-50 transition-colors flex items-center justify-between"},[e("div",Us,[e("p",Hs,g(j.name),1),e("p",Ks,g(j.code),1)]),e("div",Gs,[e("span",Os,g(j.price_ttc?.toFixed(2))+"€",1),j.duration?(p(),y("span",Qs,g(j.duration)+"min",1)):F("",!0)])],8,Bs))),128))])):F("",!0)]),_:1})])]),e("div",Js,[U.value.length>0?(p(),y("div",Ws,[(p(!0),y(K,null,O(U.value,j=>(p(),X(_s,{key:j.id,service:j},null,8,["service"]))),128))])):(p(),y("div",Zs,[E(s(ge),{class:"w-10 h-10 md:w-14 md:h-14 mb-4 opacity-40"}),k[1]||(k[1]=e("p",{class:"text-sm md:text-base font-medium text-gray-500"},"Aucun service trouvé",-1)),k[2]||(k[2]=e("p",{class:"text-xs md:text-sm text-gray-400 mt-1.5"},"Modifiez votre recherche",-1))])),s(b)?(p(),X(Ns,{key:2})):F("",!0)])]))}}),M=C({id:"",firstName:"",lastName:"",phone:"",phone2:"",email:"",address:"",city:"",postalCode:"",birthDate:"",notes:""}),re=C(!1);function Xs(){const{createClient:x,updateClient:l,selectClient:f}=de(),S=q(()=>!!(M.value.firstName.trim()||M.value.lastName.trim()||M.value.phone.trim())),b=()=>{M.value={id:"",firstName:"",lastName:"",phone:"",phone2:"",email:"",address:"",city:"",postalCode:"",birthDate:"",notes:""},re.value=!1,f(null)};return{currentClient:M,isEditMode:re,hasClientInfo:S,clearClient:b,loadClient:t=>{M.value={...t},re.value=!0},newClient:()=>{b()},saveClient:async()=>{if(!S.value)return{success:!1,isNew:!1,message:"Veuillez remplir au moins un champ (nom, prénom ou téléphone)"};if(!M.value.phone.trim())return{success:!1,isNew:!1,message:"Le numéro de téléphone est obligatoire"};try{const t={first_name:M.value.firstName,last_name:M.value.lastName,phone:M.value.phone,phone2:M.value.phone2||null,email:M.value.email||null,address:M.value.address||null,city:M.value.city||null,postal_code:M.value.postalCode||null,birth_date:M.value.birthDate||null,notes:M.value.notes||null};if(re.value&&M.value.id){console.log("Mise à jour du client:",t);const n=await l(M.value.id,t);return n?(f(n),{success:!0,isNew:!1,message:`Client ${M.value.firstName} ${M.value.lastName} mis à jour`}):{success:!1,isNew:!1,message:"Erreur lors de la mise à jour"}}else{console.log("Création du client:",t);const n=await x(t);return n?(M.value.id=n.id,re.value=!0,f(n),{success:!0,isNew:!0,message:`Client ${M.value.firstName} ${M.value.lastName} créé`}):{success:!1,isNew:!1,message:"Erreur lors de la création"}}}catch(t){return console.error("Erreur lors de l'enregistrement du client:",t),{success:!1,isNew:!1,message:"Erreur lors de l'enregistrement"}}}}}const ea={class:"card h-full flex flex-col overflow-hidden"},ta={class:"p-4 md:p-6 border-b border-gray-200 bg-white"},sa={class:"flex items-center justify-between mb-3 md:mb-4"},aa={class:"relative"},la={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-xl border border-gray-200 py-2 z-50"},oa=["onClick"],ra={class:"text-xs md:text-sm font-medium text-gray-900"},na={class:"text-[10px] md:text-xs text-gray-500 mt-0.5"},ia={class:"flex-1 overflow-y-auto p-4 md:p-6 min-h-0 space-y-4 md:space-y-5 bg-gray-50"},ca={class:"grid grid-cols-2 gap-3 md:gap-4"},da={class:"block text-[10px] md:text-xs text-gray-600 font-semibold uppercase tracking-wider"},ua=["value","type","placeholder","maxlength","inputmode","autocomplete","onInput"],ma={class:"block text-[10px] md:text-xs text-gray-600 font-semibold uppercase tracking-wider"},pa=["value","type","placeholder","onInput"],va={class:"col-span-2 space-y-1.5 md:space-y-2"},ya={class:"block text-[10px] md:text-xs text-gray-600 font-semibold uppercase tracking-wider flex items-center gap-1.5 md:gap-2"},ha={class:"grid grid-cols-2 gap-3 md:gap-4"},fa={class:"space-y-1.5 md:space-y-2"},ga={class:"space-y-1.5 md:space-y-2"},xa=["value","maxlength"],_a={class:"space-y-1.5 md:space-y-2"},ba={class:"p-4 md:p-6 border-t border-gray-200 bg-white"},wa={class:"grid grid-cols-3 gap-2 md:gap-3"},Ca=["disabled"],ka=["disabled"],$a=["disabled"],Sa={class:"hidden sm:inline"},Ta=te({__name:"ClientPanel",setup(x){const{currentClient:l,isEditMode:f,clearClient:S,loadClient:b,hasClientInfo:h,saveClient:P}=Xs(),{searchClients:T,selectClient:t,clearSelection:n}=de(),i=C(""),$=C([]),z=C(!1);let I=null;fe(i,_=>{if(I&&clearTimeout(I),_.trim().length<2){$.value=[];return}I=window.setTimeout(async()=>{z.value=!0;try{const u=await T(_);$.value=u}catch(u){console.error("Erreur recherche clients:",u),$.value=[]}finally{z.value=!1}},300)});const U=q(()=>i.value.trim().length>=2&&$.value.length>0),G=async()=>{const _=await P();_.success,alert(_.message)},R=()=>{S(),i.value="",n()},Z=()=>{alert("Historique client à implémenter")},J=_=>{t(_);const u={id:_.id,firstName:_.first_name,lastName:_.last_name,phone:ue(_.phone||""),phone2:ue(_.phone2||""),email:_.email||"",address:_.address||"",city:_.city||"",postalCode:Ne(_.postal_code||""),birthDate:_.birth_date||"",notes:_.notes||""};b(u),i.value=`${u.firstName} ${u.lastName}`,$.value=[]},V=_=>{_.key==="Enter"&&$.value.length>0&&(_.preventDefault(),J($.value[0]))},A=[{key:"lastName",label:"Nom",type:"text",placeholder:"Dupont",span:1,format:null},{key:"firstName",label:"Prénom",type:"text",placeholder:"Jean",span:1,format:null},{key:"phone",label:"Tél. 1",type:"tel",placeholder:"06 12 34 56 78",span:1,format:"phone"},{key:"phone2",label:"Tél. 2",type:"tel",placeholder:"01 23 45 67 89",span:1,format:"phone"},{key:"email",label:"Email",type:"email",placeholder:"jean@email.com",span:2,format:null},{key:"birthDate",label:"Anniversaire",type:"date",placeholder:"",span:2,format:null}];function H(_,u,d){const m=d==="phone"?ue(u):u;l[_]=m}return(_,u)=>(p(),y("div",ea,[e("div",ta,[e("div",sa,[u[5]||(u[5]=e("h2",{class:"text-xs md:text-sm font-semibold text-gray-900 uppercase tracking-wider"},"Client",-1)),s(h)?(p(),y("div",{key:0,class:L(["inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[10px] md:text-xs font-semibold transition-colors",s(f)?"bg-blue-100 text-blue-700":"bg-emerald-100 text-emerald-700"])},[(p(),X(ce(s(f)?s(rt):s(qe)),{class:"w-3 h-3"})),e("span",null,g(s(f)?"Modification":"Nouveau"),1)],2)):F("",!0)]),e("div",aa,[E(s(ge),{class:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-gray-400 pointer-events-none z-10"}),ne(e("input",{"onUpdate:modelValue":u[0]||(u[0]=d=>i.value=d),onKeydown:V,type:"text",placeholder:"Rechercher un client...",class:"w-full pl-11 md:pl-14 pr-4 md:pr-5 py-3 md:py-3.5 bg-gray-50 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 hover:border-gray-400 transition-all",autocomplete:"off"},null,544),[[ie,i.value]]),E(we,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:be(()=>[U.value?(p(),y("div",la,[(p(!0),y(K,null,O($.value,d=>(p(),y("button",{key:d.id,onClick:m=>J(d),class:"w-full px-4 md:px-5 py-2.5 md:py-3 text-left hover:bg-gray-50 transition-colors"},[e("p",ra,g(d.first_name)+" "+g(d.last_name),1),e("p",na,g(d.phone),1)],8,oa))),128))])):F("",!0)]),_:1})])]),e("div",ia,[e("div",ca,[(p(!0),y(K,null,O(A.filter(d=>d.span!==2),d=>(p(),y("div",{key:d.key,class:"space-y-1.5 md:space-y-2"},[e("label",da,g(d.label),1),e("input",{value:s(l)[d.key],type:d.type,placeholder:d.placeholder,maxlength:d.format==="phone"?s(je).phone:void 0,inputmode:d.format==="phone"?"numeric":void 0,autocomplete:d.format==="phone"?"tel":void 0,class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 hover:border-gray-400 transition-all",onInput:m=>H(d.key,m.target.value,d.format)},null,40,ua)]))),128)),(p(!0),y(K,null,O(A.filter(d=>d.span===2),d=>(p(),y("div",{key:d.key,class:"col-span-2 space-y-1.5 md:space-y-2"},[e("label",ma,g(d.label),1),e("input",{value:s(l)[d.key],type:d.type,placeholder:d.placeholder,class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 hover:border-gray-400 transition-all",onInput:m=>d.format?H(d.key,m.target.value,d.format):s(l)[d.key]=m.target.value},null,40,pa)]))),128))]),e("div",va,[e("label",ya,[E(s(Je),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),u[6]||(u[6]=e("span",null,"Adresse",-1))]),ne(e("input",{"onUpdate:modelValue":u[1]||(u[1]=d=>s(l).address=d),type:"text",placeholder:"123 Rue de la Paix",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 hover:border-gray-400 transition-all"},null,512),[[ie,s(l).address]])]),e("div",ha,[e("div",fa,[u[7]||(u[7]=e("label",{class:"block text-[10px] md:text-xs text-gray-600 font-semibold uppercase tracking-wider"}," Ville ",-1)),ne(e("input",{"onUpdate:modelValue":u[2]||(u[2]=d=>s(l).city=d),type:"text",placeholder:"Paris",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 hover:border-gray-400 transition-all"},null,512),[[ie,s(l).city]])]),e("div",ga,[u[8]||(u[8]=e("label",{class:"block text-[10px] md:text-xs text-gray-600 font-semibold uppercase tracking-wider"}," CP ",-1)),e("input",{value:s(l).postalCode,type:"text",inputmode:"numeric",maxlength:s(je).postalCode,placeholder:"75001",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 hover:border-gray-400 transition-all",onInput:u[3]||(u[3]=d=>s(l).postalCode=s(Ne)(d.target.value))},null,40,xa)])]),e("div",_a,[u[9]||(u[9]=e("label",{class:"block text-[10px] md:text-xs text-gray-600 font-semibold uppercase tracking-wider"}," Notes ",-1)),ne(e("textarea",{"onUpdate:modelValue":u[4]||(u[4]=d=>s(l).notes=d),placeholder:"Commentaires, préférences...",rows:"2",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 hover:border-gray-400 transition-all resize-none"},null,512),[[ie,s(l).notes]])])]),e("div",ba,[e("div",wa,[e("button",{onClick:Z,disabled:!s(f),class:"btn-secondary text-[10px] md:text-xs px-2 md:px-4 py-2.5 md:py-3"},[E(s(Ue),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),u[10]||(u[10]=e("span",{class:"hidden sm:inline"},"Historique",-1))],8,Ca),e("button",{onClick:R,disabled:!s(h),class:L(["inline-flex items-center justify-center gap-1 md:gap-2 px-2 md:px-4 py-2.5 md:py-3 text-[10px] md:text-xs font-medium rounded-xl transition-all duration-200",s(h)?"bg-white border border-gray-300 text-red-600 hover:bg-red-50 hover:border-red-200":"bg-gray-100 text-gray-400 cursor-not-allowed border border-gray-200"])},[E(s(De),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),u[11]||(u[11]=e("span",{class:"hidden sm:inline"},"Effacer",-1))],10,ka),e("button",{onClick:G,disabled:!s(h),class:L(["btn-primary text-[10px] md:text-xs px-2 md:px-4 py-2.5 md:py-3",s(f)?"bg-blue-600 hover:bg-blue-700":"bg-emerald-600 hover:bg-emerald-700"])},[(p(),X(ce(s(f)?s(Oe):s(qe)),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})),e("span",Sa,g(s(f)?"Modifier":"Créer"),1)],10,$a)])])]))}}),Ea={class:"flex-1 flex flex-col lg:flex-row gap-4 p-4 lg:gap-6 lg:p-6 pb-20 lg:pb-6"},Pa={class:"lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50"},Ma={class:"flex"},Na=["onClick"],ja={class:"text-xs font-medium"},Ha=te({__name:"CaissePage",setup(x){const l=C("services"),f=[{id:"services",label:"Services",icon:He},{id:"ticket",label:"Ticket",icon:ot},{id:"client",label:"Client",icon:nt}];return(S,b)=>(p(),y(K,null,[e("main",Ea,[e("aside",{class:L(["lg:w-80 lg:flex-shrink-0",l.value==="ticket"?"block":"hidden lg:block"])},[E(cs)],2),e("section",{class:L(["flex-1 min-w-0",l.value==="services"?"block":"hidden lg:block"])},[E(Ys)],2),e("aside",{class:L(["lg:w-80 xl:w-96 lg:flex-shrink-0",l.value==="client"?"block":"hidden lg:block"])},[E(Ta)],2)]),e("nav",Pa,[e("div",Ma,[(p(),y(K,null,O(f,h=>e("button",{key:h.id,onClick:P=>l.value=h.id,class:L(["flex-1 flex flex-col items-center justify-center py-3 transition-colors",l.value===h.id?"text-gray-900 bg-gray-100":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},[(p(),X(ce(h.icon),{class:"w-5 h-5 mb-1"})),e("span",ja,g(h.label),1)],10,Na)),64))])])],64))}});export{Ha as default};
