import{c as I,a as T,r as b,s as _,d as ve,u as pe,w as fe,C as ke,e as g,f as e,k as M,j as y,y as $,g as t,z as V,t as i,l as j,F as W,n as v,m as Y,o as Z,h as he,v as ee,T as re,q as c}from"./index-Bl-DGyDc.js";import{C as we}from"./calendar-DEXkU1dH.js";import{R as _e}from"./refresh-cw-DCDDjdqj.js";import{P as ne}from"./plus-CByRnsT9.js";import{C as Ce,a as Me}from"./circle-arrow-up-D6o3inEo.js";import{T as Re}from"./trash-2-BCpcxx1Q.js";import{X as te}from"./x-DNLlolV6.js";import{M as je}from"./minus-CrYUIxEy.js";const ie=I("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const Ee=I("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const Te=I("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);const ae=I("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);const se=I("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),x=b(null),h=b([]),E=b(!1),w=b(null);function Ae(){const oe=async o=>{E.value=!0,w.value=null;try{const{data:a,error:u}=await _.from("cash_registers").select("*, vendor:vendors(first_name, last_name, initials)").eq("date",o).maybeSingle();if(u)throw u;x.value=a,a?await l(a.id):h.value=[]}catch(a){console.error("Erreur chargement caisse:",a),w.value=a.message}finally{E.value=!1}},l=async o=>{try{const{data:a,error:u}=await _.from("cash_movements").select("*, vendor:vendors(first_name, last_name, initials)").eq("cash_register_id",o).order("created_at",{ascending:!0});if(u)throw u;h.value=a||[]}catch(a){console.error("Erreur chargement mouvements:",a),h.value=[]}},N=async(o,a,u)=>{E.value=!0,w.value=null;try{const{data:d,error:n}=await _.from("cash_registers").insert({date:o,opening_amount:a,vendor_id:u||null,status:"open"}).select().single();if(n)throw n;return x.value=d,h.value=[],d}catch(d){return console.error("Erreur ouverture caisse:",d),w.value=d.message,null}finally{E.value=!1}},q=async(o,a,u,d)=>{if(!x.value)return null;try{const{data:n,error:m}=await _.from("cash_movements").insert({cash_register_id:x.value.id,type:o,amount:a,label:u,vendor_id:d||null}).select("*, vendor:vendors(first_name, last_name, initials)").single();if(m)throw m;return h.value.push(n),n}catch(n){return console.error("Erreur ajout mouvement:",n),w.value=n.message,null}},H=async o=>{try{const{error:a}=await _.from("cash_movements").delete().eq("id",o);if(a)throw a;return h.value=h.value.filter(u=>u.id!==o),!0}catch(a){return console.error("Erreur suppression mouvement:",a),w.value=a.message,!1}},F=T(()=>h.value.filter(o=>o.type==="in").reduce((o,a)=>o+a.amount,0)),k=T(()=>h.value.filter(o=>o.type==="out").reduce((o,a)=>o+a.amount,0)),G=T(()=>F.value-k.value),P=async()=>{if(!x.value||x.value.status!=="closed")return null;const o=x.value.closed_at;if(!o)return null;const a=new Date(o).getTime();if((Date.now()-a)/(1e3*60*60)>=24)return null;E.value=!0,w.value=null;try{const{data:n,error:m}=await _.from("cash_registers").update({status:"open",closed_at:null,closing_amount:null,expected_amount:null,difference:null,notes:null}).eq("id",x.value.id).select().single();if(m)throw m;return x.value=n,await l(n.id),n}catch(n){return console.error("Erreur réouverture caisse:",n),w.value=n.message,null}finally{E.value=!1}},X=async(o,a,u)=>{if(!x.value)return null;try{const d=x.value.opening_amount+a+F.value-k.value,n=o-d,{data:m,error:R}=await _.from("cash_registers").update({closing_amount:o,expected_amount:d,difference:n,status:"closed",closed_at:new Date().toISOString(),notes:u||null}).eq("id",x.value.id).select().single();if(R)throw R;return x.value=m,m}catch(d){return console.error("Erreur fermeture caisse:",d),w.value=d.message,null}},J=async(o=30)=>{try{const{data:a,error:u}=await _.from("cash_registers").select("*, vendor:vendors(first_name, last_name, initials)").order("date",{ascending:!1}).limit(o);if(u)throw u;return a||[]}catch(a){return console.error("Erreur chargement historique:",a),[]}},K=T(()=>{const o=x.value;if(!o||o.status!=="closed"||!o.closed_at)return!1;const a=new Date(o.closed_at).getTime();return(Date.now()-a)/(1e3*60*60)<24});return{currentRegister:x,movements:h,isLoading:E,error:w,totalIn:F,totalOut:k,movementsBalance:G,canReopen:K,loadRegister:oe,openRegister:N,reopenRegister:P,addMovement:q,deleteMovement:H,closeRegister:X,loadRegisterHistory:J}}const Se={class:"flex-1 p-4 lg:p-6 overflow-auto bg-gray-50 dark:bg-gray-900"},De={class:"max-w-4xl mx-auto space-y-6"},$e={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Ve={class:"flex items-center gap-3"},qe={class:"text-center py-2"},Fe={class:"text-lg font-semibold text-gray-700 dark:text-gray-300 capitalize"},Oe={key:0,class:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-8 text-center"},Le={class:"w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center mx-auto mb-4"},ze={key:1,class:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-8 text-center"},Be={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},Ue={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},Ie={class:"text-xl font-bold text-gray-900 dark:text-white"},Ne={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},Pe={class:"text-xl font-bold text-emerald-600 dark:text-emerald-400"},He={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},Ge={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},Xe={class:"text-xl font-bold text-gray-900 dark:text-white"},Je={class:"flex-1"},Ke={class:"text-sm text-gray-500 dark:text-gray-400"},Qe=["disabled"],We={key:2,class:"text-sm text-gray-500 dark:text-gray-400 italic"},Ye={class:"flex-1"},Ze={key:0,class:"text-sm text-amber-600 dark:text-amber-400"},er={class:"text-right"},rr={class:"text-lg font-bold text-gray-900 dark:text-white"},tr={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"},ar={key:0,class:"p-8 text-center text-gray-500 dark:text-gray-400"},sr={key:1,class:"divide-y divide-gray-100 dark:divide-gray-700"},or={class:"flex-1 min-w-0"},lr={class:"font-medium text-gray-900 dark:text-white truncate"},dr={class:"text-xs text-gray-500 dark:text-gray-400"},nr=["onClick"],ir={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"},ur={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-md overflow-hidden border border-gray-200 dark:border-gray-700"},cr={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},gr={class:"p-6 space-y-4"},yr={class:"p-4 border-t border-gray-200 dark:border-gray-700 flex gap-3"},mr={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"},xr={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-md overflow-hidden border border-gray-200 dark:border-gray-700"},br={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},vr={class:"p-6 space-y-4"},pr={class:"grid grid-cols-2 gap-3"},fr={class:"p-4 border-t border-gray-200 dark:border-gray-700 flex gap-3"},kr=["disabled"],hr={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"},wr={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-md overflow-hidden border border-gray-200 dark:border-gray-700"},_r={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},Cr={class:"p-6 space-y-4"},Mr={class:"bg-gray-50 dark:bg-gray-700 rounded-xl p-4 space-y-2"},Rr={class:"flex justify-between text-sm"},jr={class:"font-medium dark:text-gray-100"},Er={class:"flex justify-between text-sm"},Tr={class:"font-medium text-emerald-600 dark:text-emerald-400"},Ar={class:"flex justify-between text-sm"},Sr={class:"flex justify-between text-base font-bold pt-2 border-t border-gray-200 dark:border-gray-600"},Dr={class:"dark:text-white"},$r={key:0,class:"bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-700 rounded-xl p-3 flex items-center gap-2"},Vr={class:"text-sm text-amber-700 dark:text-amber-300"},qr={class:"font-bold"},Fr={class:"p-4 border-t border-gray-200 dark:border-gray-700 flex gap-3"},Hr=ve({__name:"TiroirCaissePage",setup(oe){const{currentRegister:l,movements:N,isLoading:q,totalIn:H,totalOut:F,movementsBalance:k,canReopen:G,loadRegister:P,openRegister:X,reopenRegister:J,addMovement:K,deleteMovement:o,closeRegister:a}=Ae(),{vendor:u}=pe(),d=b(new Date().toISOString().split("T")[0]),n=b(0),m=b(0),R=b(""),A=b(0),O=b("out"),S=b(0),D=b(""),L=b(!1),z=b(!1),B=b(!1);fe(d,f=>{P(f),le(f)}),ke(()=>{P(d.value),le(d.value)});const le=async f=>{try{const{data:r}=await _.from("payments").select("amount, sale:sales!inner(created_at)").eq("method","cash").gte("sale.created_at",`${f}T00:00:00`).lt("sale.created_at",`${f}T23:59:59`);A.value=(r||[]).reduce((s,de)=>s+de.amount,0)}catch(r){console.error("Erreur chargement ventes espèces:",r),A.value=0}},U=T(()=>l.value?l.value.opening_amount+A.value+H.value-F.value:0),C=T(()=>l.value?.status==="open"),ue=T(()=>l.value?.status==="closed"),ce=f=>new Date(f).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),Q=f=>new Date(f).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),p=f=>f.toFixed(2),ge=async()=>{await X(d.value,n.value,u.value?.id),L.value=!1,n.value=0},ye=async()=>{!D.value.trim()||S.value<=0||(await K(O.value,S.value,D.value,u.value?.id),B.value=!1,D.value="",S.value=0)},me=async()=>{await a(m.value,A.value,R.value),z.value=!1,m.value=0,R.value=""},xe=()=>{m.value=U.value,z.value=!0},be=async()=>{await J()};return(f,r)=>(c(),g("main",Se,[e("div",De,[e("div",$e,[r[16]||(r[16]=e("div",null,[e("h1",{class:"text-xl lg:text-2xl font-bold text-gray-900 dark:text-white"},"Tiroir de caisse"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Gérez le fond de caisse et les mouvements")],-1)),e("div",Ve,[y(t(we),{class:"w-5 h-5 text-gray-400 dark:text-gray-500"}),$(e("input",{"onUpdate:modelValue":r[0]||(r[0]=s=>d.value=s),type:"date",class:"px-4 py-2.5 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 dark:text-gray-100 rounded-xl text-sm font-medium focus:outline-none focus:border-gray-900 dark:focus:border-emerald-500 focus:ring-2 focus:ring-gray-900/10 dark:focus:ring-emerald-500/30"},null,512),[[V,d.value]])])]),e("div",qe,[e("p",Fe,i(ce(d.value)),1)]),!t(l)&&!t(q)?(c(),g("div",Oe,[e("div",Le,[y(t(se),{class:"w-8 h-8 text-gray-400 dark:text-gray-500"})]),r[18]||(r[18]=e("h2",{class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},"Caisse fermée",-1)),r[19]||(r[19]=e("p",{class:"text-gray-500 dark:text-gray-400 mb-6"},"Aucune caisse ouverte pour cette date",-1)),e("button",{onClick:r[1]||(r[1]=s=>L.value=!0),class:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 text-white rounded-xl font-medium hover:bg-emerald-700 transition-colors"},[y(t(ae),{class:"w-5 h-5"}),r[17]||(r[17]=j(" Ouvrir la caisse ",-1))])])):t(q)?(c(),g("div",ze,[y(t(_e),{class:"w-8 h-8 text-gray-400 dark:text-gray-500 animate-spin mx-auto"})])):t(l)?(c(),g(W,{key:2},[e("div",Be,[e("div",Ue,[r[20]||(r[20]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider font-semibold mb-1"},"Fond de caisse",-1)),e("p",Ie,i(p(t(l).opening_amount))+"€",1)]),e("div",Ne,[r[21]||(r[21]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider font-semibold mb-1"},"Ventes espèces",-1)),e("p",Pe,"+"+i(p(A.value))+"€",1)]),e("div",He,[r[22]||(r[22]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider font-semibold mb-1"},"Mouvements",-1)),e("p",{class:v(["text-xl font-bold",t(k)>=0?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400"])},i(t(k)>=0?"+":"")+i(p(t(k)))+"€ ",3)]),e("div",Ge,[r[23]||(r[23]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider font-semibold mb-1"},"Solde attendu",-1)),e("p",Xe,i(p(U.value))+"€",1)])]),e("div",{class:v(["rounded-xl p-4 flex items-center gap-3",C.value?"bg-emerald-50 border border-emerald-200 dark:bg-emerald-900/30 dark:border-emerald-700":"bg-gray-100 border border-gray-200 dark:bg-gray-700 dark:border-gray-600"])},[(c(),Y(Z(C.value?t(ae):t(se)),{class:v(["w-5 h-5",C.value?"text-emerald-600 dark:text-emerald-400":"text-gray-500 dark:text-gray-400"])},null,8,["class"])),e("div",Je,[e("p",{class:v(["font-semibold",C.value?"text-emerald-700 dark:text-emerald-300":"text-gray-700 dark:text-gray-300"])},i(C.value?"Caisse ouverte":"Caisse fermée"),3),e("p",Ke,i(C.value?`Ouverte à ${Q(t(l).opened_at)}`:`Fermée à ${Q(t(l).closed_at||"")}`),1)]),C.value?(c(),g(W,{key:0},[e("button",{onClick:r[2]||(r[2]=s=>B.value=!0),class:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 border border-gray-300 rounded-xl text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[y(t(ne),{class:"w-4 h-4"}),r[24]||(r[24]=j(" Mouvement ",-1))]),e("button",{onClick:xe,class:"inline-flex items-center gap-2 px-4 py-2 bg-gray-900 dark:bg-emerald-600 dark:hover:bg-emerald-500 text-white rounded-xl text-sm font-medium hover:bg-gray-800 transition-colors"},[y(t(se),{class:"w-4 h-4"}),r[25]||(r[25]=j(" Fermer ",-1))])],64)):t(G)?(c(),g("button",{key:1,onClick:be,disabled:t(q),class:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-xl text-sm font-medium hover:bg-emerald-700 dark:hover:bg-emerald-500 transition-colors disabled:opacity-50"},[y(t(ae),{class:"w-4 h-4"}),r[26]||(r[26]=j(" Réouvrir la caisse ",-1))],8,Qe)):(c(),g("p",We,"Caisse non modifiable après 24h"))],2),ue.value&&t(l).difference!==null?(c(),g("div",{key:0,class:v(["rounded-xl p-4 flex items-center gap-3",t(l).difference===0?"bg-emerald-50 border border-emerald-200 dark:bg-emerald-900/30 dark:border-emerald-700":"bg-amber-50 border border-amber-200 dark:bg-amber-900/30 dark:border-amber-700"])},[(c(),Y(Z(t(l).difference===0?t(Ee):t(ie)),{class:v(["w-6 h-6",t(l).difference===0?"text-emerald-600 dark:text-emerald-400":"text-amber-600 dark:text-amber-400"])},null,8,["class"])),e("div",Ye,[e("p",{class:v(["font-semibold",t(l).difference===0?"text-emerald-700 dark:text-emerald-300":"text-amber-700 dark:text-amber-300"])},i(t(l).difference===0?"Caisse juste":"Écart de caisse"),3),t(l).difference!==0?(c(),g("p",Ze," Écart : "+i(t(l).difference>0?"+":"")+i(p(t(l).difference))+"€ ",1)):M("",!0)]),e("div",er,[r[27]||(r[27]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Montant compté",-1)),e("p",rr,i(p(t(l).closing_amount||0))+"€",1)])],2)):M("",!0),e("div",tr,[r[29]||(r[29]=e("div",{class:"p-4 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white uppercase tracking-wider"},"Mouvements du jour")],-1)),t(N).length===0?(c(),g("div",ar,[y(t(Te),{class:"w-10 h-10 text-gray-300 dark:text-gray-600 mx-auto mb-2"}),r[28]||(r[28]=e("p",null,"Aucun mouvement",-1))])):(c(),g("div",sr,[(c(!0),g(W,null,he(t(N),s=>(c(),g("div",{key:s.id,class:"px-4 py-3 flex items-center gap-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[e("div",{class:v(["w-10 h-10 rounded-full flex items-center justify-center",s.type==="in"?"bg-emerald-100 dark:bg-emerald-900/40":"bg-red-100 dark:bg-red-900/40"])},[(c(),Y(Z(s.type==="in"?t(Ce):t(Me)),{class:v(["w-5 h-5",s.type==="in"?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400"])},null,8,["class"]))],2),e("div",or,[e("p",lr,i(s.label),1),e("p",dr,i(Q(s.created_at)),1)]),e("p",{class:v(["font-bold text-lg",s.type==="in"?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400"])},i(s.type==="in"?"+":"-")+i(p(s.amount))+"€ ",3),C.value?(c(),g("button",{key:0,onClick:de=>t(o)(s.id),class:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/30 rounded-lg transition-colors"},[y(t(Re),{class:"w-4 h-4"})],8,nr)):M("",!0)]))),128))]))])],64)):M("",!0),y(re,{"enter-active-class":"transition-opacity duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:ee(()=>[L.value?(c(),g("div",ir,[e("div",ur,[e("div",cr,[r[30]||(r[30]=e("h3",{class:"text-lg font-bold text-gray-900 dark:text-white"},"Ouvrir la caisse",-1)),e("button",{onClick:r[3]||(r[3]=s=>L.value=!1),class:"p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"},[y(t(te),{class:"w-5 h-5"})])]),e("div",gr,[e("div",null,[r[31]||(r[31]=e("label",{class:"block text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider mb-2"},"Fond de caisse (€)",-1)),$(e("input",{"onUpdate:modelValue":r[4]||(r[4]=s=>n.value=s),type:"number",step:"0.01",min:"0",class:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 dark:placeholder-gray-400 rounded-xl text-lg font-semibold text-center focus:outline-none focus:border-gray-900 dark:focus:border-emerald-500",placeholder:"0.00"},null,512),[[V,n.value,void 0,{number:!0}]])])]),e("div",yr,[e("button",{onClick:r[5]||(r[5]=s=>L.value=!1),class:"flex-1 px-4 py-2.5 border border-gray-300 dark:border-gray-600 dark:text-gray-200 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 font-medium"}," Annuler "),e("button",{onClick:ge,class:"flex-1 px-4 py-2.5 bg-emerald-600 text-white rounded-xl hover:bg-emerald-700 dark:hover:bg-emerald-500 font-medium"}," Ouvrir ")])])])):M("",!0)]),_:1}),y(re,{"enter-active-class":"transition-opacity duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:ee(()=>[B.value?(c(),g("div",mr,[e("div",xr,[e("div",br,[r[32]||(r[32]=e("h3",{class:"text-lg font-bold text-gray-900 dark:text-white"},"Ajouter un mouvement",-1)),e("button",{onClick:r[6]||(r[6]=s=>B.value=!1),class:"p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"},[y(t(te),{class:"w-5 h-5"})])]),e("div",vr,[e("div",null,[r[35]||(r[35]=e("label",{class:"block text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider mb-2"},"Type",-1)),e("div",pr,[e("button",{onClick:r[7]||(r[7]=s=>O.value="out"),class:v(["flex items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 transition-colors font-medium",O.value==="out"?"border-red-500 bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300":"border-gray-200 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-500"])},[y(t(je),{class:"w-4 h-4"}),r[33]||(r[33]=j(" Dépense / Sortie ",-1))],2),e("button",{onClick:r[8]||(r[8]=s=>O.value="in"),class:v(["flex items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 transition-colors font-medium",O.value==="in"?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-300":"border-gray-200 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-500"])},[y(t(ne),{class:"w-4 h-4"}),r[34]||(r[34]=j(" Entrée ",-1))],2)])]),e("div",null,[r[36]||(r[36]=e("label",{class:"block text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider mb-2"},"Libellé",-1)),$(e("input",{"onUpdate:modelValue":r[9]||(r[9]=s=>D.value=s),type:"text",class:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 dark:placeholder-gray-400 rounded-xl focus:outline-none focus:border-gray-900 dark:focus:border-emerald-500",placeholder:"Ex: Achat fournitures, Retrait banque..."},null,512),[[V,D.value]])]),e("div",null,[r[37]||(r[37]=e("label",{class:"block text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider mb-2"},"Montant (€)",-1)),$(e("input",{"onUpdate:modelValue":r[10]||(r[10]=s=>S.value=s),type:"number",step:"0.01",min:"0",class:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 dark:placeholder-gray-400 rounded-xl text-lg font-semibold text-center focus:outline-none focus:border-gray-900 dark:focus:border-emerald-500",placeholder:"0.00"},null,512),[[V,S.value,void 0,{number:!0}]])])]),e("div",fr,[e("button",{onClick:r[11]||(r[11]=s=>B.value=!1),class:"flex-1 px-4 py-2.5 border border-gray-300 dark:border-gray-600 dark:text-gray-200 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 font-medium"}," Annuler "),e("button",{onClick:ye,disabled:!D.value.trim()||S.value<=0,class:"flex-1 px-4 py-2.5 bg-gray-900 dark:bg-emerald-600 dark:hover:bg-emerald-500 text-white rounded-xl hover:bg-gray-800 font-medium disabled:opacity-50"}," Ajouter ",8,kr)])])])):M("",!0)]),_:1}),y(re,{"enter-active-class":"transition-opacity duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:ee(()=>[z.value?(c(),g("div",hr,[e("div",wr,[e("div",_r,[r[38]||(r[38]=e("h3",{class:"text-lg font-bold text-gray-900 dark:text-white"},"Fermer la caisse",-1)),e("button",{onClick:r[12]||(r[12]=s=>z.value=!1),class:"p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"},[y(t(te),{class:"w-5 h-5"})])]),e("div",Cr,[e("div",Mr,[e("div",Rr,[r[39]||(r[39]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Fond de caisse",-1)),e("span",jr,i(p(t(l)?.opening_amount||0))+"€",1)]),e("div",Er,[r[40]||(r[40]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Ventes espèces",-1)),e("span",Tr,"+"+i(p(A.value))+"€",1)]),e("div",Ar,[r[41]||(r[41]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Mouvements",-1)),e("span",{class:v(["font-medium",t(k)>=0?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400"])},i(t(k)>=0?"+":"")+i(p(t(k)))+"€ ",3)]),e("div",Sr,[r[42]||(r[42]=e("span",{class:"dark:text-white"},"Solde attendu",-1)),e("span",Dr,i(p(U.value))+"€",1)])]),e("div",null,[r[43]||(r[43]=e("label",{class:"block text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider mb-2"},"Montant réellement compté (€)",-1)),$(e("input",{"onUpdate:modelValue":r[13]||(r[13]=s=>m.value=s),type:"number",step:"0.01",min:"0",class:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-xl text-lg font-semibold text-center focus:outline-none focus:border-gray-900 dark:focus:border-emerald-500"},null,512),[[V,m.value,void 0,{number:!0}]])]),m.value!==U.value?(c(),g("div",$r,[y(t(ie),{class:"w-5 h-5 text-amber-600 dark:text-amber-400 flex-shrink-0"}),e("p",Vr,[r[44]||(r[44]=j(" Écart de ",-1)),e("span",qr,i(p(m.value-U.value))+"€",1)])])):M("",!0),e("div",null,[r[45]||(r[45]=e("label",{class:"block text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider mb-2"},"Notes (optionnel)",-1)),$(e("textarea",{"onUpdate:modelValue":r[14]||(r[14]=s=>R.value=s),rows:"2",class:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 dark:placeholder-gray-400 rounded-xl focus:outline-none focus:border-gray-900 dark:focus:border-emerald-500 resize-none",placeholder:"Remarques sur la journée..."},null,512),[[V,R.value]])])]),e("div",Fr,[e("button",{onClick:r[15]||(r[15]=s=>z.value=!1),class:"flex-1 px-4 py-2.5 border border-gray-300 dark:border-gray-600 dark:text-gray-200 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 font-medium"}," Annuler "),e("button",{onClick:me,class:"flex-1 px-4 py-2.5 bg-gray-900 dark:bg-emerald-600 dark:hover:bg-emerald-500 text-white rounded-xl hover:bg-gray-800 font-medium"}," Fermer la caisse ")])])])):M("",!0)]),_:1})])]))}});export{Hr as default};
