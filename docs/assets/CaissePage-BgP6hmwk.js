import{c as ve,a as V,r as T,s as L,i as qe,d as pe,u as Je,b as Te,w as ye,e as d,f as e,t as p,g as a,F as Y,h as te,n as H,j as $,E as lt,k as z,l as oe,m as de,o as Se,p as nt,q as s,v as Ee,T as Ie,x as dt,P as Be,y as ue,z as me,A as Xe,B as it,H as ct,L as ut}from"./index-Bl-DGyDc.js";import{M as mt,u as ze,U as Ge,a as pt}from"./useLoyalty-8CizsNR5.js";import{P as gt,I as Oe,S as yt,f as We,a as Ne}from"./formatInputs-COkqqkP5.js";import{P as vt,_ as xt}from"./_plugin-vue_export-helper-BAIuDI4c.js";import{M as Ye}from"./minus-CrYUIxEy.js";import{P as Ue}from"./plus-CByRnsT9.js";import{T as et}from"./trash-2-BCpcxx1Q.js";import{B as bt,S as ft,G as tt,H as ht,W as at}from"./wrench-CdUulFOc.js";import{C as Ze}from"./credit-card-CAUDYgFf.js";import{C as kt}from"./clock-CnpBEeoX.js";import{X as _t}from"./x-DNLlolV6.js";import{S as wt}from"./shopping-bag-ClztjdFJ.js";import{S as Pe}from"./search-4JT1iSRQ.js";import{S as Ct}from"./shopping-cart-C6m_AkDP.js";const $t=ve("barcode",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]]);const Le=ve("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const rt=ve("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);const St=ve("user-pen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]]);const Pt=ve("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const Tt=ve("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),X=T([]),he=T("euro"),ne=T(0),ge=T(null),ae=T([]),je=T([]),Ve=T(!1),ce=T(null),Et=.2;function Me(){const F=(t,o,k)=>{if(t.type!=="product")return 1/0;const Q=X.value.filter(n=>n.product.id===t.id&&n.lineId!==o&&(n.stockCategory??"sale")===(k??"sale")).reduce((n,C)=>n+C.quantity,0),B=k==="technical"?t.stock_technical??0:t.stock??0;return Math.max(0,B-Q)},y=(t,o=1,k,Q="sale")=>{const B=F(t,void 0,Q),n=t.type==="product"?Math.min(o,B):o;if(n<=0)return;const O={lineId:`line-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,product:t,quantity:n,vendor_id:k?.id,vendor:k,stockCategory:Q,price_ht:t.price_ht,tva_rate:t.tva_rate||Et,subtotal_ht:0,tva:0,subtotal_ttc:0};q(O),X.value.push(O)},q=t=>{const o=t.fixedPriceTTC??t.product.price_ttc;t.subtotal_ttc=o*t.quantity;const k=1+t.tva_rate;t.subtotal_ht=t.subtotal_ttc/k,t.tva=t.subtotal_ttc-t.subtotal_ht,t.price_ht=t.subtotal_ht/t.quantity},K=t=>X.value.find(o=>o.lineId===t),R=(t,o)=>{const k=K(t);k&&(o==null||o<0?delete k.fixedPriceTTC:k.fixedPriceTTC=o,q(k))},E=(t,o)=>{const k=K(t);if(k)if(o<=0)G(t);else{const Q=k.product.type==="product"?F(k.product,t)+k.quantity:o;k.quantity=Math.min(o,Q),q(k)}},G=t=>{X.value=X.value.filter(o=>o.lineId!==t)},U=()=>{X.value=[],ne.value=0,ge.value=null,ae.value=[]},g=V(()=>X.value.reduce((t,o)=>t+o.subtotal_ht,0)),r=V(()=>X.value.reduce((t,o)=>t+o.tva,0)),u=V(()=>g.value+r.value),b=V(()=>{if(ne.value<=0)return 0;if(he.value==="euro")return Math.min(ne.value,u.value);{const t=Math.min(ne.value,100);return u.value*t/100}}),P=V(()=>ge.value!=null&&ge.value>=0?ge.value:Math.max(0,u.value-b.value)),M=V(()=>X.value.reduce((t,o)=>t+o.quantity,0)),N=V(()=>X.value.length===0),w=(t,o)=>{he.value=t,ne.value=Math.max(0,o)},m=()=>{he.value="euro",ne.value=0},S=t=>{ge.value=t},A=(t,o)=>{const k=ae.value.find(Q=>Q.method===t);k?k.amount+=o:ae.value.push({method:t,amount:o})},I=(t,o)=>{const k=ae.value.find(Q=>Q.method===t);k?k.amount=o:ae.value.push({method:t,amount:o})},v=t=>{ae.value=ae.value.filter(o=>o.method!==t)},x=()=>{ae.value=[]},D=V(()=>ae.value.reduce((t,o)=>t+o.amount,0)),J=V(()=>Math.max(0,P.value-D.value)),re=V(()=>Math.max(0,D.value-P.value)),W=V(()=>D.value>=P.value&&P.value>0),Z=()=>{const t=new Date,o=t.toISOString().split("T")[0].replace(/-/g,""),k=t.getTime().toString().slice(-4);return`T-${o}-${k}`};return{cartItems:X,discountType:he,discountValue:ne,selectedPaymentMethods:ae,recentSales:je,isProcessing:Ve,error:ce,subtotalHT:g,totalTVA:r,subtotalTTC:u,discountAmount:b,total:P,itemCount:M,isEmpty:N,totalPaid:D,remainingToPay:J,change:re,isPaymentComplete:W,addToCart:y,updateQuantity:E,removeFromCart:G,getMaxQuantityForItem:t=>t.product.type!=="product"?1/0:F(t.product,t.lineId,t.stockCategory)+t.quantity,setItemFixedPrice:R,clearCart:U,setDiscount:w,clearDiscount:m,setFixedTotal:S,fixedTotal:ge,addPayment:A,setPayment:I,removePayment:v,clearPayments:x,validateSale:async(t,o)=>{if(N.value)return ce.value="Le panier est vide",null;if(!o)return ce.value="Veuillez sélectionner ou créer un client avant de valider",null;if(!W.value)return ce.value="Le paiement n'est pas complet",null;if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t))return ce.value="Aucun vendeur sélectionné. Veuillez sélectionner un vendeur.",console.error("vendorId invalide:",t),null;Ve.value=!0,ce.value=null,console.log("Validation vente - vendorId:",t,"clientId:",o);try{if(qe()){const _=new Map;for(const ee of X.value)if(ee.product.type==="product"){const se=ee.stockCategory??"sale",le=`${ee.product.id}|${se}`,ie=_.get(le);ie?ie.qty+=ee.quantity:_.set(le,{qty:ee.quantity,name:ee.product.name,stockCat:se})}for(const[ee,{qty:se,name:le,stockCat:ie}]of _){const be=ee.split("|")[0],Ce=ie==="technical"?"stock_technical":"stock",{data:fe,error:$e}=await L.from("products").select(`${Ce}`).eq("id",be).single();if($e||!fe)throw new Error(`Produit ${le} introuvable`);const Qe=fe[Ce]??0;if(Qe<se)throw new Error(`Stock insuffisant pour "${le}" (${ie==="technical"?"technique":"vente"}) : ${Qe} en stock, ${se} demandé`)}}let Q;if(qe()){const{data:_}=await L.rpc("generate_ticket_number");Q=_||Z()}const B={ticket_number:Q,vendor_id:t,client_id:o||null,subtotal_ht:g.value,total_tva:r.value,subtotal_ttc:u.value,discount_type:he.value,discount_value:ne.value,discount_amount:b.value,total:P.value,status:"completed"},n=X.value.map(_=>({product_id:_.product.id,variant_id:_.variant?.id||null,vendor_id:_.vendor_id||t,product_name:_.product.name,price_ht:_.price_ht,tva_rate:_.tva_rate,quantity:_.quantity,subtotal_ht:_.subtotal_ht,tva:_.tva,subtotal_ttc:_.subtotal_ttc})),C=ae.value.map(_=>({method:_.method,amount:_.amount}));qe();const{data:O,error:xe}=await L.from("sales").insert(B).select().single();if(xe)throw xe;const st=n.map(_=>({..._,sale_id:O.id})),{error:He}=await L.from("sale_items").insert(st);if(He)throw He;const ot=C.map(_=>({..._,sale_id:O.id})),{error:Ke}=await L.from("payments").insert(ot);if(Ke)throw Ke;for(const _ of X.value)if(_.product.type==="product"){const ee=_.stockCategory??"sale",se=ee==="technical"?"stock_technical":"stock",{data:le,error:ie}=await L.from("products").select(`${se}`).eq("id",_.product.id).single();if(ie||!le)throw new Error(`Produit ${_.product.name} introuvable`);const be=le[se]??0;if(be<_.quantity)throw new Error(`Stock insuffisant pour "${_.product.name}" (${ee==="technical"?"technique":"vente"}) : ${be} en stock, ${_.quantity} demandé`);const Ce=be-_.quantity,{error:fe}=await L.from("products").update({[se]:Ce,updated_at:new Date().toISOString()}).eq("id",_.product.id);if(fe)throw fe;const{error:$e}=await L.from("stock_movements").insert({product_id:_.product.id,variant_id:_.variant?.id||null,type:"out",quantity:-_.quantity,reason:ee==="technical"?"Utilisation technique":"Vente",reference_id:O.id,vendor_id:t,stock_type:ee});if($e)throw $e}if(o){const{data:_}=await L.from("clients").select("visit_count, total_spent, loyalty_points").eq("id",o).single();_&&await L.from("clients").update({visit_count:_.visit_count+1,total_spent:_.total_spent+P.value,last_visit_at:new Date().toISOString()}).eq("id",o)}return je.value.unshift(O),U(),O}catch(Q){return console.error("Erreur validation vente:",Q),ce.value=Q.message||"Erreur lors de la validation",null}finally{Ve.value=!1}},loadRecentSales:async(t=10)=>{try{const{data:o,error:k}=await L.from("sales").select(`
          *,
          vendor:vendors(*),
          client:clients(*),
          items:sale_items(*),
          payments(*)
        `).order("created_at",{ascending:!1}).limit(t);if(k)throw k;return je.value=o||[],o}catch(o){return console.error("Erreur chargement ventes:",o),[]}},getSaleById:async t=>{try{const{data:o,error:k}=await L.from("sales").select(`
          *,
          vendor:vendors(*),
          client:clients(*),
          items:sale_items(*, product:products(*)),
          payments(*)
        `).eq("id",t).single();return k?null:o}catch{return null}},cancelSale:async(t,o)=>{try{const{error:k}=await L.from("sales").update({status:"cancelled",notes:o}).eq("id",t);if(k)throw k;return!0}catch(k){return console.error("Erreur annulation vente:",k),!1}}}}const It=[{id:"1",first_name:"Jean",last_name:"Dupont",phone:"06 12 34 56 78",phone2:null,email:"jean.dupont@email.com",address:"123 Rue de la Paix",city:"Paris",postal_code:"75001",birth_date:"1985-03-15",notes:"Client fidèle",company:null,loyalty_points:150,total_spent:450,visit_count:15,last_visit_at:"2026-01-15",created_at:"",updated_at:""},{id:"2",first_name:"Marie",last_name:"Martin",phone:"06 98 76 54 32",phone2:"01 23 45 67 89",email:"marie.martin@email.com",address:"456 Avenue des Champs",city:"Lyon",postal_code:"69001",birth_date:"1990-07-22",notes:null,company:null,loyalty_points:75,total_spent:225,visit_count:8,last_visit_at:"2026-01-20",created_at:"",updated_at:""},{id:"3",first_name:"Pierre",last_name:"Bernard",phone:"07 11 22 33 44",phone2:null,email:null,address:null,city:null,postal_code:null,birth_date:null,notes:"Préfère les rendez-vous le samedi",company:null,loyalty_points:30,total_spent:90,visit_count:3,last_visit_at:"2026-01-10",created_at:"",updated_at:""}],Fe=T([]),Re=T(null),Ae=T(!1),De=T(!1),ke=T(null);function we(){return{clients:Fe,selectedClient:Re,invoiceInCompanyName:Ae,isLoading:De,error:ke,loadClients:async()=>{De.value=!0,ke.value=null;try{const{data:r,error:u}=await L.from("clients").select("*").order("last_name");if(u)throw u;Fe.value=r||[]}catch(r){console.error("Erreur chargement clients:",r),ke.value=r.message,Fe.value=It}finally{De.value=!1}},searchClients:async r=>{if(!r||r.length<2)return[];try{const{data:u,error:b}=await L.from("clients").select("*").or(`first_name.ilike.%${r}%,last_name.ilike.%${r}%,phone.ilike.%${r}%`).limit(10);if(b)throw b;return u||[]}catch(u){return console.error("Erreur recherche clients:",u),[]}},getClientById:async r=>{try{const{data:u,error:b}=await L.from("clients").select("*").eq("id",r).single();return b?null:u}catch{return null}},createClient:async r=>{console.log("createClient appelé avec:",r);try{console.log("Insertion dans Supabase...");const{data:u,error:b}=await L.from("clients").insert({first_name:r.first_name,last_name:r.last_name,phone:r.phone,phone2:r.phone2||null,email:r.email||null,address:r.address||null,city:r.city||null,postal_code:r.postal_code||null,birth_date:r.birth_date||null,notes:r.notes||null,company:r.company??null}).select().single();if(b)throw console.error("Erreur Supabase:",b),b;return console.log("Client créé avec succès:",u),u}catch(u){return console.error("Erreur création client:",u),ke.value=u.message,null}},updateClient:async(r,u)=>{console.log("updateClient appelé avec:",r,u);try{const{data:b,error:P}=await L.from("clients").update(u).eq("id",r).select().single();if(P)throw P;return console.log("Client mis à jour:",b),b}catch(b){return console.error("Erreur mise à jour client:",b),ke.value=b.message,null}},selectClient:r=>{Re.value=r},setInvoiceInCompanyName:r=>{Ae.value=r},clearSelection:()=>{Re.value=null,Ae.value=!1},updateClientAfterSale:async(r,u)=>{try{const{data:b}=await L.from("clients").select("visit_count, total_spent").eq("id",r).single();b&&await L.from("clients").update({visit_count:b.visit_count+1,total_spent:b.total_spent+u,last_visit_at:new Date().toISOString()}).eq("id",r)}catch(b){console.error("Erreur mise à jour client après vente:",b)}}}}const Mt={class:"card h-full flex flex-col overflow-hidden"},qt={class:"p-4 md:p-5 border-b border-gray-200 bg-gray-50 dark:bg-gray-800 dark:border-gray-700"},Nt={class:"flex items-center justify-between"},jt={class:"text-xs md:text-sm font-semibold text-gray-900 dark:text-gray-100"},Vt={class:"flex-1 overflow-y-auto p-4 md:p-5 space-y-2 md:space-y-3 min-h-0"},Ft={class:"flex items-start justify-between gap-2 md:gap-3 mb-2 md:mb-3"},Rt={class:"flex-1 min-w-0"},At={class:"font-medium text-gray-900 dark:text-gray-100 line-clamp-2 text-xs md:text-sm leading-snug"},Dt={class:"flex items-center gap-1.5 mt-0.5"},Bt={key:0,class:"inline-flex px-1.5 py-0.5 rounded text-[9px] font-semibold bg-blue-100 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300"},Lt={key:1,class:"text-[10px] text-gray-500 dark:text-gray-400"},zt={class:"font-bold text-gray-900 dark:text-gray-100 whitespace-nowrap text-sm md:text-base tabular-nums"},Ut={class:"flex items-center gap-2 mb-2"},Ht=["value","onInput"],Kt={class:"flex items-center justify-between"},Qt={class:"flex items-center gap-2"},Gt=["onClick"],Ot={class:"w-7 md:w-9 text-center text-xs md:text-sm font-semibold tabular-nums text-gray-900 dark:text-gray-100"},Wt=["onClick","disabled"],Zt=["onClick"],Jt={key:1,class:"h-full flex items-center justify-center py-8"},Xt={class:"px-4 py-3 md:px-5 md:py-4 border-t border-gray-100 dark:border-gray-700"},Yt={class:"flex flex-col gap-2 md:gap-3"},ea={class:"flex items-center justify-between gap-2"},ta={class:"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-full p-0.5 shadow-inner border border-gray-200 dark:border-gray-600"},aa={class:"flex items-center gap-2"},ra=["value","max"],sa={class:"text-xs md:text-sm font-medium text-gray-500 dark:text-gray-400 min-w-[24px] md:min-w-[32px] text-center"},oa={class:"px-4 py-3 md:px-5 md:py-4 border-t border-gray-100 dark:border-gray-700"},la={class:"flex flex-col gap-2"},na={class:"flex items-center gap-2"},da=["value"],ia={class:"px-4 py-3 md:px-5 md:py-4 border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-800"},ca={class:"grid grid-cols-3 md:grid-cols-2 gap-1.5 md:gap-2"},ua=["onClick"],ma={class:"font-medium truncate"},pa={class:"p-4 md:p-5 border-t-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},ga={class:"space-y-2 md:space-y-2.5 mb-3 md:mb-4"},ya={class:"flex justify-between text-xs md:text-sm"},va={class:"text-gray-700 dark:text-gray-300 tabular-nums"},xa={class:"flex justify-between text-xs md:text-sm"},ba={class:"text-gray-700 dark:text-gray-300 tabular-nums"},fa={class:"flex justify-between text-xs md:text-sm font-medium"},ha={class:"text-gray-900 dark:text-gray-100 tabular-nums"},ka={key:0,class:"flex justify-between text-xs md:text-sm"},_a={class:"text-gray-600 dark:text-gray-400"},wa={class:"text-[10px] md:text-xs"},Ca={class:"text-red-600 dark:text-red-400 font-medium tabular-nums"},$a={class:"flex justify-between text-xl md:text-2xl font-bold pt-2 md:pt-3 border-t border-gray-200 dark:border-gray-600"},Sa={class:"text-gray-900 dark:text-gray-100 tabular-nums"},Pa={class:"grid grid-cols-4 gap-1.5 md:gap-2"},Ta={class:"btn-icon-sm p-2 md:p-3",title:"Imprimer","aria-label":"Imprimer"},Ea={class:"btn-icon-sm p-2 md:p-3",title:"Email","aria-label":"Envoyer par email"},Ia=["disabled"],Ma={key:0,class:"animate-spin"},qa=pe({__name:"TicketPanel",setup(F){const{cartItems:y,subtotalHT:q,totalTVA:K,subtotalTTC:R,total:E,discountAmount:G,fixedTotal:U,setFixedTotal:g,updateQuantity:r,removeFromCart:u,setItemFixedPrice:b,clearCart:P,setDiscount:M,setPayment:N,clearPayments:w,validateSale:m,isProcessing:S,getMaxQuantityForItem:A,error:I}=Me(),{vendor:v}=Je(),{selectedClient:x}=we(),{loadProducts:D}=Te(),{saveStamps:J,loadClientStamps:re}=ze(),W=T("euro"),Z=T(0),h=T("card"),c=[{id:"cash",label:"Espèces",icon:bt},{id:"card",label:"CB",icon:Ze},{id:"contactless",label:"Sans contact",icon:ft},{id:"amex",label:"American Express",icon:Ze},{id:"check",label:"Chèque",icon:nt},{id:"gift_card",label:"Chèque Cadeau",icon:tt},{id:"free",label:"Gratuit",icon:ht},{id:"technical",label:"Utilisation technique",icon:at}],l=B=>B.toFixed(2),i=B=>{W.value=B,B==="percent"&&(Z.value=Math.min(Z.value,100)),M(W.value,Z.value)},f=B=>{const n=B.target,C=Number(n.value);W.value==="percent"?Z.value=Math.min(C,100):Z.value=Math.min(C,R.value),M(W.value,Z.value)},t=B=>{h.value=B,w(),N(B,E.value)};ye([E,h],()=>{E.value>0&&h.value&&N(h.value,E.value)},{immediate:!0});const o=async()=>{if(y.value.length===0)return;if(!x.value){alert("Veuillez sélectionner ou créer un client avant de valider la vente.");return}N(h.value,E.value);const B=await m(v.value?.id||"demo",x.value?.id);B?(x.value&&v.value&&(await J(x.value.id,v.value.id,B.id),await re(x.value.id)),await D(),alert(`✅ Vente validée !
Ticket: ${B.ticket_number}
Total: ${l(B.total)}€`)):I.value&&alert(`❌ Erreur : ${I.value}`)},k=V(()=>new Date().toLocaleDateString("fr-FR")),Q=V(()=>W.value==="percent"?100:R.value);return V(()=>R.value),(B,n)=>(s(),d("div",Mt,[e("div",qt,[e("div",Nt,[e("div",null,[n[5]||(n[5]=e("p",{class:"text-[10px] md:text-[11px] text-gray-500 uppercase tracking-wider font-semibold mb-1 dark:text-gray-400"},"Date",-1)),e("p",jt,p(k.value),1)]),n[6]||(n[6]=e("div",{class:"text-right"},[e("p",{class:"text-[10px] md:text-[11px] text-gray-500 uppercase tracking-wider font-semibold mb-1 dark:text-gray-400"},"Ticket"),e("p",{class:"text-xs md:text-sm font-semibold text-gray-900 dark:text-gray-100"},"#001")],-1))])]),e("div",Vt,[a(y).length>0?(s(!0),d(Y,{key:0},te(a(y),C=>(s(),d("div",{key:C.lineId,class:"cart-item"},[e("div",Ft,[e("div",Rt,[e("p",At,p(C.product.name),1),e("div",Dt,[C.stockCategory==="technical"?(s(),d("span",Bt,"TECH")):z("",!0),C.vendor?(s(),d("p",Lt," par "+p(C.vendor.initials||`${C.vendor.first_name} ${C.vendor.last_name}`),1)):z("",!0)])]),e("p",zt,p(l(C.subtotal_ttc))+"€ ",1)]),e("div",Ut,[n[7]||(n[7]=e("label",{class:"text-[10px] text-gray-500 dark:text-gray-400 shrink-0"},"Prix unit. (€)",-1)),e("input",{type:"number",value:C.fixedPriceTTC??"",onInput:O=>{const xe=O.target.value;a(b)(C.lineId,xe===""?null:Math.max(0,Number(xe)))},min:"0",step:"0.01",placeholder:"Prix libre",class:"flex-1 min-w-0 px-2 py-1.5 text-[11px] bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-gray-400 tabular-nums"},null,40,Ht)]),e("div",Kt,[e("div",Qt,[e("button",{onClick:O=>a(r)(C.lineId,C.quantity-1),class:"w-8 h-8 md:w-9 md:h-9 rounded-lg bg-white border border-gray-300 flex items-center justify-center hover:bg-gray-100 hover:border-gray-400 dark:bg-gray-600 dark:border-gray-500 dark:hover:bg-gray-500 dark:text-gray-100 transition-colors","aria-label":"Diminuer la quantité"},[$(a(Ye),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})],8,Gt),e("span",Ot,p(C.quantity),1),e("button",{onClick:O=>a(r)(C.lineId,C.quantity+1),disabled:C.quantity>=a(A)(C),class:"w-8 h-8 md:w-9 md:h-9 rounded-lg bg-white border border-gray-300 flex items-center justify-center hover:bg-gray-100 hover:border-gray-400 dark:bg-gray-600 dark:border-gray-500 dark:hover:bg-gray-500 dark:text-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Augmenter la quantité"},[$(a(Ue),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})],8,Wt)]),e("button",{onClick:O=>a(u)(C.lineId),class:"p-1.5 md:p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/30 rounded-lg transition-colors","aria-label":"Supprimer l'article"},[$(a(et),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})],8,Zt)])]))),128)):(s(),d("div",Jt,[...n[8]||(n[8]=[e("p",{class:"text-gray-400 dark:text-gray-500 text-xs md:text-sm"},"Aucun article",-1)])]))]),e("div",Xt,[e("div",Yt,[e("div",ea,[n[13]||(n[13]=e("label",{class:"text-xs md:text-sm text-gray-600 dark:text-gray-400 font-medium"},"Réduction",-1)),e("div",ta,[e("button",{onClick:n[0]||(n[0]=C=>i("euro")),class:H(["inline-flex items-center gap-0.5 md:gap-1 px-2 md:px-3 py-1 md:py-1.5 text-[10px] md:text-xs font-semibold rounded-full transition-all duration-150",W.value==="euro"?"bg-white text-gray-900 shadow-sm dark:bg-gray-600 dark:text-gray-100":"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200"])},[$(a(lt),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),n[9]||(n[9]=e("span",{class:"hidden sm:inline"},"Montant",-1)),n[10]||(n[10]=e("span",{class:"sm:hidden"},"€",-1))],2),e("button",{onClick:n[1]||(n[1]=C=>i("percent")),class:H(["inline-flex items-center gap-0.5 md:gap-1 px-2 md:px-3 py-1 md:py-1.5 text-[10px] md:text-xs font-semibold rounded-full transition-all duration-150",W.value==="percent"?"bg-white text-gray-900 shadow-sm dark:bg-gray-600 dark:text-gray-100":"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200"])},[$(a(gt),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),n[11]||(n[11]=e("span",{class:"hidden sm:inline"},"Pourcentage",-1)),n[12]||(n[12]=e("span",{class:"sm:hidden"},"%",-1))],2)])]),e("div",aa,[e("input",{type:"number",value:Z.value,onInput:f,min:"0",max:Q.value,step:"0.01",class:"flex-1 px-3 md:px-4 py-2 md:py-2.5 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 border border-gray-300 rounded-lg text-xs md:text-sm text-right focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all tabular-nums"},null,40,ra),e("span",sa,p(W.value==="percent"?"%":"€"),1)])])]),e("div",oa,[e("div",la,[n[14]||(n[14]=e("label",{class:"text-xs md:text-sm text-gray-600 dark:text-gray-400 font-medium"},"Fixer le prix total (€)",-1)),e("div",na,[e("input",{type:"number",value:a(U)??"",onInput:n[2]||(n[2]=C=>{const O=C.target.value;a(g)(O===""?null:Math.max(0,Number(O)))}),min:"0",step:"0.01",placeholder:"Prix libre",class:"flex-1 px-3 md:px-4 py-2 md:py-2.5 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-500 border border-gray-300 rounded-lg text-xs md:text-sm text-right focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 tabular-nums"},null,40,da),a(U)!=null?(s(),d("button",{key:0,type:"button",onClick:n[3]||(n[3]=C=>a(g)(null)),class:"px-2 py-2 text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/30 rounded-lg text-xs font-medium",title:"Annuler le prix fixé"}," Réinit ")):z("",!0)])])]),e("div",ia,[n[15]||(n[15]=e("p",{class:"text-[10px] md:text-[11px] text-gray-600 dark:text-gray-400 uppercase tracking-wider font-semibold mb-2 md:mb-3"},"Règlement",-1)),e("div",ca,[(s(),d(Y,null,te(c,C=>e("button",{key:C.id,onClick:O=>t(C.id),class:H(["payment-btn text-[10px] md:text-xs",h.value===C.id&&"active"])},[(s(),de(Se(C.icon),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})),e("span",ma,p(C.label),1)],10,ua)),64))])]),e("div",pa,[e("div",ga,[e("div",ya,[n[16]||(n[16]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Sous-total HT",-1)),e("span",va,p(l(a(q)))+"€",1)]),e("div",xa,[n[17]||(n[17]=e("span",{class:"text-gray-500 dark:text-gray-400"},"TVA (20%)",-1)),e("span",ba,p(l(a(K)))+"€",1)]),e("div",fa,[n[18]||(n[18]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Sous-total TTC",-1)),e("span",ha,p(l(a(R)))+"€",1)]),Z.value>0?(s(),d("div",ka,[e("span",_a,[n[19]||(n[19]=oe(" Réduction ",-1)),e("span",wa,"("+p(W.value==="percent"?`${Z.value}%`:`${l(Z.value)}€`)+")",1)]),e("span",Ca,"-"+p(l(a(G)))+"€",1)])):z("",!0),e("div",$a,[n[20]||(n[20]=e("span",{class:"text-gray-900 dark:text-gray-100"},"Total",-1)),e("span",Sa,p(l(a(E)))+"€",1)])]),e("div",Pa,[e("button",Ta,[$(a(vt),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})]),e("button",Ea,[$(a(mt),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})]),e("button",{onClick:n[4]||(n[4]=(...C)=>a(P)&&a(P)(...C)),class:"btn-icon-sm p-2 md:p-3 text-orange-600 hover:bg-orange-50 hover:border-orange-200 dark:text-orange-400 dark:hover:bg-orange-900/30 dark:hover:border-orange-700",title:"Annuler","aria-label":"Annuler la transaction"},[$(a(rt),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})]),e("button",{onClick:o,disabled:a(y).length===0||a(S),class:H(["btn-icon-sm p-2 md:p-3",a(y).length>0&&!a(S)?"bg-emerald-600 text-white hover:bg-emerald-700 border-emerald-600 dark:bg-emerald-600 dark:border-emerald-600":"bg-gray-100 text-gray-400 cursor-not-allowed border-gray-200 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-500"]),title:"Valider","aria-label":"Valider la transaction"},[a(S)?(s(),d("span",Ma,"⏳")):(s(),de(a(Le),{key:1,class:"w-4 h-4 md:w-5 md:h-5"}))],10,Ia)])])]))}}),Na=["aria-label"],ja={class:"service-header"},Va={class:"service-header-left"},Fa={class:"service-code"},Ra=["aria-label"],Aa={class:"service-price"},Da={class:"service-body"},Ba={class:"service-name"},La={key:0,class:"service-duration"},za={class:"hidden sm:inline"},Ua={class:"sm:hidden"},Ha=pe({__name:"ServiceCard",props:{service:{}},setup(F){const y=F,{addToCart:q,cartItems:K}=Me(),{getCategoryBorderColor:R}=Te(),E=V(()=>{const g=K.value.find(r=>r.product.id===y.service.id);return g?g.quantity:0}),G=V(()=>R(y.service)),U=()=>{q(y.service)};return(g,r)=>(s(),d("button",{onClick:U,"aria-label":`Ajouter ${F.service.name} au panier`,class:H(["service-card",G.value,E.value>0&&"active"])},[e("div",ja,[e("div",Va,[e("span",Fa,p(F.service.code),1),E.value>0?(s(),d("span",{key:0,class:"quantity-badge","aria-label":`Quantité: ${E.value}`},p(E.value),9,Ra)):z("",!0)]),e("span",Aa,p(F.service.price_ttc?.toFixed(2)||F.service.price_ht?.toFixed(2))+"€ ",1)]),e("div",Da,[e("h3",Ba,p(F.service.name),1),F.service.duration?(s(),d("span",La,[$(a(kt),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),e("span",za,p(F.service.duration)+"min",1),e("span",Ua,p(F.service.duration)+"'",1)])):z("",!0)])],10,Na))}}),Ka=xt(Ha,[["__scopeId","data-v-588d3745"]]),Qa={class:"card p-4"},Ga={class:"flex items-center justify-between mb-3"},Oa={class:"flex items-center gap-2"},Wa={class:"w-8 h-8 rounded-full bg-yellow-100 dark:bg-yellow-900/40 flex items-center justify-center"},Za={class:"text-xs text-gray-500 dark:text-gray-400"},Ja={class:"flex items-center gap-2"},Xa=["disabled"],Ya=["disabled"],er={key:3,class:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-green-100 text-green-700 dark:bg-emerald-900/40 dark:text-emerald-300 rounded-full text-xs font-semibold"},tr={class:"grid grid-cols-6 sm:grid-cols-12 gap-2 w-full"},ar=["onClick"],rr={key:0,class:"absolute bottom-0.5 left-0 right-0 text-xs text-yellow-700 dark:text-amber-300 font-semibold leading-tight"},sr=pe({__name:"LoyaltyCard",setup(F){const{stamps:y,checkedCount:q,isCardComplete:K,stampsCount:R,toggleStamp:E,addPointsManually:G,removePointsManually:U,resetPointsToZero:g,loadClientStamps:r}=ze(),{selectedClient:u}=we(),{vendor:b}=Je(),P=T(!1),M=V(()=>y.value.filter(I=>I.isStamped&&!I.date).length),N=V(()=>y.value.filter(I=>I.markedForRemoval).length),w=async()=>{if(!(!u.value||!b.value||M.value===0)){P.value=!0;try{const I=await G(u.value.id,b.value.id);I?.success?(await r(u.value.id),alert(`${I.count} point(s) fidélité ajouté(s)`)):alert("Erreur lors de l'ajout des points")}catch{alert("Erreur lors de l'ajout des points")}finally{P.value=!1}}},m=async()=>{if(!(!u.value||N.value===0)&&confirm(`Retirer ${N.value} point(s) fidélité ?`)){P.value=!0;try{const I=await U(u.value.id);I?.success?(await r(u.value.id),alert(`${I.count} point(s) fidélité retiré(s)`)):alert("Erreur lors du retrait des points")}catch{alert("Erreur lors du retrait des points")}finally{P.value=!1}}},S=async()=>{if(!(!u.value||!confirm("Réinitialiser les points fidélité à 0 ?")))try{await g(u.value.id),await r(u.value.id)}catch{alert("Erreur lors de la réinitialisation")}},A=I=>{if(!I)return"";const v=new Date(I),x=String(v.getDate()).padStart(2,"0"),D=String(v.getMonth()+1).padStart(2,"0"),J=v.getFullYear();return`${x}/${D}/${J}`};return(I,v)=>(s(),d("div",Qa,[e("div",Ga,[e("div",Oa,[e("div",Wa,[$(a(tt),{class:"w-4 h-4 text-yellow-600 dark:text-yellow-400"})]),v[0]||(v[0]=e("span",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},"Carte fidélité",-1)),e("span",Za,p(a(q))+"/"+p(a(R)),1)]),e("div",Ja,[a(u)&&M.value>0?(s(),d("button",{key:0,type:"button",onClick:w,disabled:P.value,class:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-yellow-700 bg-yellow-100 hover:bg-yellow-200 dark:text-amber-300 dark:bg-amber-900/50 dark:hover:bg-amber-900/70 rounded-lg transition-colors disabled:opacity-50",title:"Enregistrer les points cochés (sans vente)"},[$(a(Ue),{class:"w-3.5 h-3.5"}),oe(" "+p(P.value?"Enregistrement...":`+${M.value} point(s)`),1)],8,Xa)):z("",!0),a(u)&&N.value>0?(s(),d("button",{key:1,type:"button",onClick:m,disabled:P.value,class:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-red-700 bg-red-100 hover:bg-red-200 dark:text-red-300 dark:bg-red-900/50 dark:hover:bg-red-900/70 rounded-lg transition-colors disabled:opacity-50",title:"Retirer les points sélectionnés"},[$(a(Ye),{class:"w-3.5 h-3.5"}),oe(" "+p(P.value?"Retrait...":`-${N.value} point(s)`),1)],8,Ya)):z("",!0),a(u)?(s(),d("button",{key:2,type:"button",onClick:S,class:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Réinitialiser les points à 0"},[$(a(rt),{class:"w-3.5 h-3.5"}),v[1]||(v[1]=oe(" Réinit. points ",-1))])):z("",!0),a(K)?(s(),d("span",er,[$(a(Le),{class:"w-3.5 h-3.5"}),v[2]||(v[2]=oe(" Complète ",-1))])):z("",!0)])]),e("div",tr,[(s(!0),d(Y,null,te(a(y),x=>(s(),d("button",{key:x.position,onClick:D=>a(E)(x.position),class:H(["relative aspect-square w-full max-w-none rounded-xl border-2 transition-all duration-200 flex flex-col items-center justify-center overflow-hidden",x.markedForRemoval?"border-red-500 bg-red-50 dark:border-red-500 dark:bg-red-900/30 ring-2 ring-red-400":x.isStamped?"border-yellow-500 bg-yellow-50 hover:bg-yellow-100 dark:border-amber-500 dark:bg-amber-900/30 dark:hover:bg-amber-900/50":"border-gray-300 bg-white hover:bg-gray-50 hover:border-gray-400 dark:border-gray-600 dark:bg-gray-700 dark:hover:bg-gray-600 dark:hover:border-gray-500"])},[e("span",{class:H(["text-base font-bold",x.markedForRemoval?"text-red-600 dark:text-red-400 line-through":x.isStamped?"text-yellow-600 dark:text-amber-400":"text-gray-400 dark:text-gray-500"])},p(x.position),3),$(Ie,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"scale-0 opacity-0","enter-to-class":"scale-100 opacity-100"},{default:Ee(()=>[x.isStamped?(s(),d("div",{key:0,class:H(["absolute inset-0 flex items-center justify-center",x.markedForRemoval?"bg-red-500/20 dark:bg-red-500/30":"bg-yellow-500/20 dark:bg-amber-500/30"])},[$(a(Le),{class:H(["w-6 h-6 drop-shadow",x.markedForRemoval?"text-red-600 dark:text-red-400":"text-yellow-600 dark:text-amber-400"])},null,8,["class"])],2)):z("",!0)]),_:2},1024),x.isStamped&&x.date?(s(),d("span",rr,p(A(x.date)),1)):z("",!0)],10,ar))),128))])]))}}),or={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-2xl max-h-[85vh] flex flex-col border border-gray-200 dark:border-gray-700 overflow-hidden",role:"dialog","aria-modal":"true","aria-labelledby":"product-picker-title"},lr={class:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 shrink-0"},nr={id:"product-picker-title",class:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2"},dr={class:"px-4 py-3 border-b border-gray-100 dark:border-gray-700 shrink-0"},ir={class:"flex rounded-xl border border-gray-200 dark:border-gray-600 overflow-hidden mb-3"},cr={class:"relative"},ur={class:"flex-1 overflow-y-auto p-4"},mr={key:0},pr={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 sticky top-0 bg-white dark:bg-gray-800 py-1"},gr={class:"space-y-4"},yr={class:"p-3 flex items-center justify-between"},vr={class:"min-w-0 flex-1"},xr={class:"font-medium text-gray-900 dark:text-white truncate"},br={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},fr={class:"px-3 pb-3 flex flex-wrap gap-2"},hr=["onClick","disabled"],kr={class:"text-xs opacity-90"},_r=["onClick","disabled"],wr={class:"text-xs opacity-90"},Cr={key:1,class:"flex flex-col items-center justify-center py-16 text-gray-500 dark:text-gray-400"},$r=pe({__name:"ProductPickerDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(F,{emit:y}){const q=F,K=y,{physicalProducts:R,loadProducts:E}=Te(),{addToCart:G}=Me(),U=T(""),g=T("sale"),r=V({get:()=>q.modelValue,set:w=>K("update:modelValue",w)});ye(r,w=>{if(w){E(),U.value="",g.value="sale";const m=S=>{S.key==="Escape"&&N()};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)}});const u=V(()=>{const w=U.value.trim().toLowerCase();let m=R.value;return w&&(m=m.filter(S=>S.name.toLowerCase().includes(w)||S.brand?.toLowerCase().includes(w)||S.model?.toLowerCase().includes(w)||S.code?.toLowerCase().includes(w)||S.barcode?.toLowerCase().includes(w))),m}),b=w=>g.value==="technical"?w.stock_technical??0:w.stock,P=V(()=>{const w=new Map;for(const S of u.value){const A=S.brand?.trim()||"Sans marque";w.has(A)||w.set(A,[]),w.get(A).push(S)}const m=[];for(const[S,A]of w){const I=new Map;for(const x of A){const D=`${x.name}|${x.model??""}`;I.has(D)||I.set(D,[]),I.get(D).push(x)}const v=[];for(const[,x]of I){const D=x[0].model?`${x[0].name} ${x[0].model}`:x[0].name;v.push({displayName:D,variants:x.map(J=>({product:J,size:J.size??null,stockSale:J.stock??0,stockTech:J.stock_technical??0}))})}v.sort((x,D)=>x.displayName.localeCompare(D.displayName)),m.push({brand:S,models:v})}return m.sort((S,A)=>S.brand.localeCompare(A.brand)),m}),M=w=>{b(w)<=0||G(w,1,void 0,g.value)},N=()=>{r.value=!1};return(w,m)=>(s(),de(dt,{to:"body"},[$(Ie,{"enter-active-class":"transition-opacity duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:Ee(()=>[r.value?(s(),d("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:Xe(N,["self"])},[e("div",or,[e("div",lr,[e("h2",nr,[$(a(Be),{class:"w-5 h-5 text-gray-500 dark:text-gray-400"}),m[3]||(m[3]=oe(" Ajouter un produit ",-1))]),e("button",{onClick:N,class:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 dark:hover:text-gray-400 dark:hover:bg-gray-700 rounded-lg transition-colors","aria-label":"Fermer"},[$(a(_t),{class:"w-5 h-5"})])]),e("div",dr,[e("div",ir,[e("button",{onClick:m[0]||(m[0]=S=>g.value="sale"),class:H(["flex-1 px-4 py-2.5 text-sm font-medium transition-colors flex items-center justify-center gap-2",g.value==="sale"?"bg-emerald-600 text-white":"bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"])},[$(a(wt),{class:"w-4 h-4"}),m[4]||(m[4]=oe(" Produit de vente ",-1))],2),e("button",{onClick:m[1]||(m[1]=S=>g.value="technical"),class:H(["flex-1 px-4 py-2.5 text-sm font-medium transition-colors flex items-center justify-center gap-2",g.value==="technical"?"bg-blue-600 text-white":"bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"])},[$(a(at),{class:"w-4 h-4"}),m[5]||(m[5]=oe(" Utilisation technique ",-1))],2)]),e("div",cr,[$(a(Pe),{class:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-gray-500 pointer-events-none"}),ue(e("input",{"onUpdate:modelValue":m[2]||(m[2]=S=>U.value=S),type:"text",placeholder:"Rechercher par nom, marque, code...",class:"w-full pl-11 pr-4 py-2.5 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-gray-900 dark:focus:ring-emerald-500 focus:border-transparent",autofocus:""},null,512),[[me,U.value]])])]),e("div",ur,[P.value.length>0?(s(),d("div",mr,[(s(!0),d(Y,null,te(P.value,({brand:S,models:A})=>(s(),d("div",{key:S,class:"mb-6 last:mb-0"},[e("h3",pr,p(S),1),e("div",gr,[(s(!0),d(Y,null,te(A,I=>(s(),d("div",{key:`${S}-${I.variants[0].product.id}`,class:"rounded-xl border border-gray-200 dark:border-gray-600 overflow-hidden bg-gray-50/50 dark:bg-gray-900/30"},[e("div",yr,[e("div",vr,[e("p",xr,p(I.displayName),1),e("p",br,p(I.variants[0].product.price_ttc?.toFixed(2))+"€ ",1)])]),e("div",fr,[(s(!0),d(Y,null,te(I.variants,v=>(s(),d(Y,{key:v.product.id},[v.size?(s(),d("button",{key:0,onClick:x=>M(v.product),disabled:(g.value==="sale"?v.stockSale:v.stockTech)<=0,class:H(["inline-flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium transition-colors",(g.value==="sale"?v.stockSale:v.stockTech)>0?g.value==="sale"?"bg-emerald-600 text-white hover:bg-emerald-700 dark:bg-emerald-500 dark:hover:bg-emerald-600":"bg-blue-600 text-white hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 cursor-not-allowed"])},[e("span",null,p(v.size),1),e("span",kr,"("+p(g.value==="sale"?v.stockSale:v.stockTech)+")",1)],10,hr)):(s(),d("button",{key:1,onClick:x=>M(v.product),disabled:(g.value==="sale"?v.stockSale:v.stockTech)<=0,class:H(["inline-flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium transition-colors",(g.value==="sale"?v.stockSale:v.stockTech)>0?g.value==="sale"?"bg-emerald-600 text-white hover:bg-emerald-700 dark:bg-emerald-500 dark:hover:bg-emerald-600":"bg-blue-600 text-white hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 cursor-not-allowed"])},[$(a(Ue),{class:"w-4 h-4"}),m[6]||(m[6]=e("span",null,"Ajouter",-1)),e("span",wr,"("+p(g.value==="sale"?v.stockSale:v.stockTech)+")",1)],10,_r))],64))),128))])]))),128))])]))),128))])):(s(),d("div",Cr,[$(a(Be),{class:"w-12 h-12 mb-4 opacity-40"}),m[7]||(m[7]=e("p",{class:"text-sm font-medium"},"Aucun produit trouvé",-1)),m[8]||(m[8]=e("p",{class:"text-xs mt-1"},"Modifiez votre recherche",-1))]))])])])):z("",!0)]),_:1})]))}}),Sr={class:"card flex flex-col bg-white dark:bg-gray-800 h-full"},Pr={class:"p-4 md:p-6 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 space-y-3"},Tr={class:"flex gap-2"},Er={class:"relative"},Ir={class:"flex items-center gap-3"},Mr={class:"relative flex-1"},qr={key:0,class:"text-xs text-red-500 dark:text-red-400 mt-1.5"},Nr={class:"space-y-1"},jr={class:"flex gap-2"},Vr={class:"relative flex-1"},Fr=["onKeydown"],Rr={key:0,class:"text-xs text-red-600 dark:text-red-400"},Ar={class:"relative"},Dr={class:"relative"},Br=["value"],Lr={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-white dark:bg-gray-700 rounded-xl shadow-xl border border-gray-200 dark:border-gray-600 py-2 z-50 max-h-60 md:max-h-80 overflow-y-auto"},zr=["onClick"],Ur={class:"flex-1 min-w-0"},Hr={class:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate"},Kr={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},Qr={class:"flex items-center gap-2 md:gap-3 ml-2 md:ml-3"},Gr={class:"text-sm font-bold text-gray-900 dark:text-gray-100 tabular-nums"},Or={key:0,class:"text-xs text-gray-400 dark:text-gray-500 hidden sm:inline"},Wr={class:"flex-1 overflow-y-auto p-4 md:p-6 bg-gray-50 dark:bg-gray-800 space-y-4"},Zr={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2.5 md:gap-3.5"},Jr={key:1,class:"h-full flex flex-col items-center justify-center text-gray-400 dark:text-gray-500 py-12"},Xr=pe({__name:"ServiceGrid",setup(F){const{products:y,searchProducts:q,findByBarcode:K}=Te(),{addToCart:R}=Me(),{selectedClient:E}=we(),{loadClientStamps:G,clearStamps:U}=ze(),g=T([]);(async()=>{const{data:i}=await L.from("vendors").select("*").eq("is_active",!0);g.value=i||[]})(),ye(E,i=>{i?G(i.id):U()});const u=T(!1),b=T(""),P=T(!1),M=T([]),N=T(""),w=T(""),m=T(""),S=T(""),A=V(()=>{const i=b.value.toLowerCase().trim(),f=y.value.filter(t=>t.type==="service"&&t.is_active!==!1).slice().sort((t,o)=>String(t.code??"").localeCompare(String(o.code??""),void 0,{numeric:!0}));return i?f.filter(t=>t.name.toLowerCase().includes(i)||t.code?.toLowerCase().includes(i)):f});ye(A,i=>{console.log("Services affichés:",i.length)},{immediate:!0});const I=async i=>{const f=i.target;if(b.value=f.value,f.value.trim().length>=2){const t=await q(f.value);M.value=(t||[]).filter(o=>o.type==="service"),P.value=M.value.length>0}else M.value=[],P.value=!1},v=()=>{b.value.trim().length>=2&&M.value.length>0&&(P.value=!0)},x=()=>{setTimeout(()=>{P.value=!1},200)},D=i=>{b.value=i.name,P.value=!1},J=i=>{if(i.key==="Enter"&&M.value.length>0){i.preventDefault();const f=M.value[0];R(f),b.value="",M.value=[],P.value=!1}},re=async()=>{const i=m.value.trim();if(!i)return;S.value="";const f=await K(i);f?(R(f,1),m.value=""):(S.value="Produit non trouvé ou sans code-barres",setTimeout(()=>{S.value=""},3e3))};ye(b,i=>{i.trim().length<2&&(M.value=[],P.value=!1)});const W=i=>{const f=i.trim().toUpperCase();if(f.length<2)return null;const t=f.match(/^([A-Z]+)(\d+.*)$/);return t?{vendorInitials:t[1],productCode:t[2]}:null},Z=i=>g.value.find(f=>f.initials?.toUpperCase()===i.toUpperCase()),h=i=>y.value.find(f=>f.code?.toUpperCase()===i.toUpperCase()),c=i=>{i.key==="Enter"&&(i.preventDefault(),l())},l=()=>{w.value="";const i=W(N.value);if(!i){w.value="Format invalide (ex: VL1)";return}const f=Z(i.vendorInitials);if(!f){w.value=`Vendeur "${i.vendorInitials}" non trouvé`;return}const t=h(i.productCode);if(!t){w.value=`Service "${i.productCode}" non trouvé`;return}R(t,1,f),N.value="",w.value=""};return(i,f)=>(s(),d("div",Sr,[e("div",Pr,[e("div",Tr,[e("button",{onClick:f[0]||(f[0]=t=>u.value=!0),class:"inline-flex items-center gap-2 px-4 py-2.5 bg-gray-900 dark:bg-emerald-600 dark:hover:bg-emerald-500 text-white rounded-xl font-medium hover:bg-gray-800 transition-colors text-sm"},[$(a(Be),{class:"w-4 h-4"}),f[4]||(f[4]=oe(" Produits ",-1))])]),e("div",Er,[e("div",Ir,[e("div",Mr,[$(a(Tt),{class:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-amber-500 dark:text-amber-400 pointer-events-none z-10"}),ue(e("input",{"onUpdate:modelValue":f[1]||(f[1]=t=>N.value=t),onKeydown:c,type:"text",placeholder:"Raccourci (ex: VL1)",class:"w-full pl-11 pr-4 py-2.5 bg-amber-50 dark:bg-gray-700 dark:border-amber-600/50 dark:text-gray-100 border border-amber-300 rounded-xl text-sm font-mono font-semibold uppercase focus:outline-none focus:border-amber-500 focus:ring-2 focus:ring-amber-500/20 dark:focus:border-amber-400 dark:focus:ring-amber-400/30 hover:border-amber-400 transition-all placeholder:normal-case placeholder:font-normal dark:placeholder-gray-400",autocomplete:"off"},null,544),[[me,N.value]])]),e("button",{onClick:l,class:"px-4 py-2.5 bg-amber-500 dark:bg-amber-600 text-white rounded-xl font-medium hover:bg-amber-600 dark:hover:bg-amber-500 transition-colors text-sm"}," OK ")]),w.value?(s(),d("p",qr,p(w.value),1)):z("",!0)]),e("div",Nr,[f[5]||(f[5]=e("label",{class:"block text-[10px] md:text-xs text-gray-500 dark:text-gray-400 font-semibold uppercase tracking-wider"},"Scan code-barres",-1)),e("div",jr,[e("div",Vr,[$(a($t),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-gray-500 pointer-events-none"}),ue(e("input",{"onUpdate:modelValue":f[2]||(f[2]=t=>m.value=t),type:"text",placeholder:"Scannez le code-barres du produit...",class:"w-full pl-10 pr-4 py-2.5 md:py-3 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30",autocomplete:"off",onKeydown:it(Xe(re,["prevent"]),["enter"])},null,40,Fr),[[me,m.value]])]),e("button",{type:"button",onClick:re,class:"px-4 py-2.5 bg-gray-900 dark:bg-emerald-600 dark:hover:bg-emerald-500 text-white rounded-xl text-sm font-medium hover:bg-gray-800"}," Ajouter ")]),S.value?(s(),d("p",Rr,p(S.value),1)):z("",!0)]),e("div",Ar,[e("div",Dr,[$(a(Pe),{class:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-gray-400 dark:text-gray-500 pointer-events-none z-10"}),e("input",{value:b.value,onInput:I,onFocus:v,onBlur:x,onKeydown:J,type:"text",placeholder:"Rechercher un service...",class:"w-full pl-11 md:pl-14 pr-4 md:pr-5 py-3 md:py-3.5 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all",autocomplete:"off"},null,40,Br)]),$(Ie,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:Ee(()=>[P.value&&M.value.length>0?(s(),d("div",Lr,[(s(!0),d(Y,null,te(M.value,t=>(s(),d("button",{key:t.id,onClick:o=>D(t),class:"w-full px-4 md:px-5 py-2.5 md:py-3 text-left hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors flex items-center justify-between"},[e("div",Ur,[e("p",Hr,p(t.name),1),e("p",Kr,p(t.code),1)]),e("div",Qr,[e("span",Gr,p(t.price_ttc?.toFixed(2))+"€",1),t.duration?(s(),d("span",Or,p(t.duration)+"min",1)):z("",!0)])],8,zr))),128))])):z("",!0)]),_:1})])]),e("div",Wr,[A.value.length>0?(s(),d("div",Zr,[(s(!0),d(Y,null,te(A.value,t=>(s(),de(Ka,{key:t.id,service:t},null,8,["service"]))),128))])):(s(),d("div",Jr,[$(a(Pe),{class:"w-10 h-10 md:w-14 md:h-14 mb-4 opacity-40"}),f[6]||(f[6]=e("p",{class:"text-sm md:text-base font-medium text-gray-500 dark:text-gray-400"},"Aucun service trouvé",-1)),f[7]||(f[7]=e("p",{class:"text-xs md:text-sm text-gray-400 dark:text-gray-500 mt-1.5"},"Modifiez votre recherche",-1))])),a(E)?(s(),de(sr,{key:2})):z("",!0)]),$($r,{modelValue:u.value,"onUpdate:modelValue":f[3]||(f[3]=t=>u.value=t)},null,8,["modelValue"])]))}}),j=T({id:"",firstName:"",lastName:"",phone:"",phone2:"",email:"",address:"",city:"",postalCode:"",birthDate:"",notes:"",company:""}),_e=T(!1);function Yr(){const{createClient:F,updateClient:y,selectClient:q}=we(),K=V(()=>!!(j.value.firstName.trim()||j.value.lastName.trim()||j.value.phone.trim())),R=()=>{j.value={id:"",firstName:"",lastName:"",phone:"",phone2:"",email:"",address:"",city:"",postalCode:"",birthDate:"",notes:"",company:""},_e.value=!1,q(null)};return{currentClient:j,isEditMode:_e,hasClientInfo:K,clearClient:R,loadClient:g=>{j.value={...g},_e.value=!0},newClient:()=>{R()},saveClient:async()=>{if(!K.value)return{success:!1,isNew:!1,message:"Veuillez remplir au moins un champ (nom, prénom ou téléphone)"};if(!j.value.phone.trim())return{success:!1,isNew:!1,message:"Le numéro de téléphone est obligatoire"};try{const g={first_name:j.value.firstName,last_name:j.value.lastName,phone:j.value.phone,phone2:j.value.phone2||null,email:j.value.email||null,address:j.value.address||null,city:j.value.city||null,postal_code:j.value.postalCode||null,birth_date:j.value.birthDate||null,notes:j.value.notes||null,company:j.value.company?.trim()||null};if(_e.value&&j.value.id){console.log("Mise à jour du client:",g);const r=await y(j.value.id,g);return r?(q(r),{success:!0,isNew:!1,message:`Client ${j.value.firstName} ${j.value.lastName} mis à jour`}):{success:!1,isNew:!1,message:"Erreur lors de la mise à jour"}}else{console.log("Création du client:",g);const r=await F(g);return r?(j.value.id=r.id,_e.value=!0,q(r),{success:!0,isNew:!0,message:`Client ${j.value.firstName} ${j.value.lastName} créé`}):{success:!1,isNew:!1,message:"Erreur lors de la création"}}}catch(g){return console.error("Erreur lors de l'enregistrement du client:",g),{success:!1,isNew:!1,message:"Erreur lors de l'enregistrement"}}}}}const es={class:"card h-full flex flex-col overflow-hidden"},ts={class:"p-4 md:p-6 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},as={class:"flex items-center justify-between mb-3 md:mb-4"},rs={class:"relative"},ss={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-white dark:bg-gray-700 rounded-xl shadow-xl border border-gray-200 dark:border-gray-600 py-2 z-50"},os=["onClick"],ls={class:"text-xs md:text-sm font-medium text-gray-900 dark:text-gray-100"},ns={class:"text-[10px] md:text-xs text-gray-500 dark:text-gray-400 mt-0.5"},ds={class:"flex-1 overflow-y-auto p-4 md:p-6 min-h-0 space-y-4 md:space-y-5 bg-gray-50 dark:bg-gray-800"},is={class:"grid grid-cols-2 gap-3 md:gap-4"},cs={class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider"},us=["value","type","placeholder","maxlength","inputmode","autocomplete","onInput"],ms={class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider"},ps=["value","type","placeholder","onInput"],gs={key:0,class:"col-span-2 flex items-center gap-3 p-3 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl"},ys=["checked"],vs={class:"col-span-2 space-y-1.5 md:space-y-2"},xs={class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider flex items-center gap-1.5 md:gap-2"},bs={class:"grid grid-cols-2 gap-3 md:gap-4"},fs={class:"space-y-1.5 md:space-y-2"},hs={class:"space-y-1.5 md:space-y-2"},ks=["value","maxlength"],_s={class:"space-y-1.5 md:space-y-2"},ws={class:"p-4 md:p-6 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},Cs={class:"grid grid-cols-3 gap-2 md:gap-3"},$s=["disabled"],Ss=["disabled"],Ps=["disabled"],Ts={class:"hidden sm:inline"},Es=pe({__name:"ClientPanel",setup(F){const{currentClient:y,isEditMode:q,clearClient:K,loadClient:R,hasClientInfo:E,saveClient:G}=Yr(),{searchClients:U,selectClient:g,clearSelection:r,selectedClient:u,invoiceInCompanyName:b,setInvoiceInCompanyName:P}=we(),M=T(""),N=T([]),w=T(!1);let m=null;ye(M,h=>{if(m&&clearTimeout(m),h.trim().length<2){N.value=[];return}m=window.setTimeout(async()=>{w.value=!0;try{const c=await U(h);N.value=c}catch(c){console.error("Erreur recherche clients:",c),N.value=[]}finally{w.value=!1}},300)});const S=V(()=>M.value.trim().length>=2&&N.value.length>0),A=async()=>{const h=await G();h.success,alert(h.message)},I=()=>{K(),M.value="",r()},v=()=>{alert("Historique client à implémenter")},x=h=>{g(h),P(!1);const c={id:h.id,firstName:h.first_name,lastName:h.last_name,phone:Ne(h.phone||""),phone2:Ne(h.phone2||""),email:h.email||"",address:h.address||"",city:h.city||"",postalCode:We(h.postal_code||""),birthDate:h.birth_date||"",notes:h.notes||"",company:h.company||""};R(c),M.value=`${c.firstName} ${c.lastName}`,N.value=[]},D=h=>{const c=N.value[0];h.key==="Enter"&&c&&(h.preventDefault(),x(c))},J=[{key:"lastName",label:"Nom",type:"text",placeholder:"Dupont",span:1,format:null},{key:"firstName",label:"Prénom",type:"text",placeholder:"Jean",span:1,format:null},{key:"phone",label:"Tél. 1",type:"tel",placeholder:"06 12 34 56 78",span:1,format:"phone"},{key:"phone2",label:"Tél. 2",type:"tel",placeholder:"01 23 45 67 89",span:1,format:"phone"},{key:"email",label:"Email",type:"email",placeholder:"jean@email.com",span:2,format:null},{key:"birthDate",label:"Anniversaire",type:"date",placeholder:"",span:2,format:null},{key:"company",label:"Entreprise",type:"text",placeholder:"Nom de l'entreprise (optionnel)",span:2,format:null}];function re(h,c,l){const i=l==="phone"?Ne(c):c;y.value[h]=i}function W(h,c){y.value[h]=c}function Z(h){y.value.postalCode=We(h)}return(h,c)=>(s(),d("div",es,[e("div",ts,[e("div",as,[c[6]||(c[6]=e("h2",{class:"text-xs md:text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider"},"Client",-1)),a(E)?(s(),d("div",{key:0,class:H(["inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[10px] md:text-xs font-semibold transition-colors",a(q)?"bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300":"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-300"])},[(s(),de(Se(a(q)?a(St):a(Ge)),{class:"w-3 h-3"})),e("span",null,p(a(q)?"Modification":"Nouveau"),1)],2)):z("",!0)]),e("div",rs,[$(a(Pe),{class:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-gray-400 dark:text-gray-500 pointer-events-none z-10"}),ue(e("input",{"onUpdate:modelValue":c[0]||(c[0]=l=>M.value=l),onKeydown:D,type:"text",placeholder:"Rechercher un client...",class:"w-full pl-11 md:pl-14 pr-4 md:pr-5 py-3 md:py-3.5 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all",autocomplete:"off"},null,544),[[me,M.value]]),$(Ie,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:Ee(()=>[S.value?(s(),d("div",ss,[(s(!0),d(Y,null,te(N.value,l=>(s(),d("button",{key:l.id,onClick:i=>x(l),class:"w-full px-4 md:px-5 py-2.5 md:py-3 text-left hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[e("p",ls,p(l.first_name)+" "+p(l.last_name),1),e("p",ns,p(l.phone),1)],8,os))),128))])):z("",!0)]),_:1})])]),e("div",ds,[e("div",is,[(s(!0),d(Y,null,te(J.filter(l=>l.span!==2),l=>(s(),d("div",{key:l.key,class:"space-y-1.5 md:space-y-2"},[e("label",cs,p(l.label),1),e("input",{value:a(y)[l.key],type:l.type,placeholder:l.placeholder,maxlength:l.format==="phone"?a(Oe).phone:void 0,inputmode:l.format==="phone"?"numeric":void 0,autocomplete:l.format==="phone"?"tel":void 0,class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all",onInput:i=>re(l.key,i.target.value,l.format)},null,40,us)]))),128)),(s(!0),d(Y,null,te(J.filter(l=>l.span===2),l=>(s(),d("div",{key:l.key,class:"col-span-2 space-y-1.5 md:space-y-2"},[e("label",ms,p(l.label),1),e("input",{value:a(y)[l.key],type:l.type,placeholder:l.placeholder,class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all",onInput:i=>l.format?re(l.key,i.target.value,l.format):W(l.key,i.target.value)},null,40,ps)]))),128))]),a(u)?(s(),d("div",gs,[e("input",{id:"cb-invoice-company",type:"checkbox",checked:a(b),onChange:c[1]||(c[1]=l=>a(P)(l.target.checked)),class:"w-4 h-4 rounded border-gray-300 dark:border-gray-500 text-gray-900 dark:bg-gray-600 focus:ring-gray-900 dark:focus:ring-emerald-500"},null,40,ys),c[7]||(c[7]=e("label",{for:"cb-invoice-company",class:"text-xs md:text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer"}," Facture au nom de l'entreprise ",-1))])):z("",!0),e("div",vs,[e("label",xs,[$(a(pt),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),c[8]||(c[8]=e("span",null,"Adresse",-1))]),ue(e("input",{"onUpdate:modelValue":c[2]||(c[2]=l=>a(y).address=l),type:"text",placeholder:"123 Rue de la Paix",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all"},null,512),[[me,a(y).address]])]),e("div",bs,[e("div",fs,[c[9]||(c[9]=e("label",{class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider"}," Ville ",-1)),ue(e("input",{"onUpdate:modelValue":c[3]||(c[3]=l=>a(y).city=l),type:"text",placeholder:"Paris",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all"},null,512),[[me,a(y).city]])]),e("div",hs,[c[10]||(c[10]=e("label",{class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider"}," CP ",-1)),e("input",{value:a(y).postalCode,type:"text",inputmode:"numeric",maxlength:a(Oe).postalCode,placeholder:"75001",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all",onInput:c[4]||(c[4]=l=>Z(l.target.value))},null,40,ks)])]),e("div",_s,[c[11]||(c[11]=e("label",{class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider"}," Notes ",-1)),ue(e("textarea",{"onUpdate:modelValue":c[5]||(c[5]=l=>a(y).notes=l),placeholder:"Commentaires, préférences...",rows:"2",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all resize-none"},null,512),[[me,a(y).notes]])])]),e("div",ws,[e("div",Cs,[e("button",{onClick:v,disabled:!a(q),class:"btn-secondary text-[10px] md:text-xs px-2 md:px-4 py-2.5 md:py-3"},[$(a(ct),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),c[12]||(c[12]=e("span",{class:"hidden sm:inline"},"Historique",-1))],8,$s),e("button",{onClick:I,disabled:!a(E),class:H(["inline-flex items-center justify-center gap-1 md:gap-2 px-2 md:px-4 py-2.5 md:py-3 text-[10px] md:text-xs font-medium rounded-xl transition-all duration-200",a(E)?"bg-white border border-gray-300 text-red-600 hover:bg-red-50 hover:border-red-200 dark:bg-gray-700 dark:border-gray-600 dark:text-red-400 dark:hover:bg-red-900/30 dark:hover:border-red-800":"bg-gray-100 text-gray-400 cursor-not-allowed border border-gray-200 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-500"])},[$(a(et),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),c[13]||(c[13]=e("span",{class:"hidden sm:inline"},"Effacer",-1))],10,Ss),e("button",{onClick:A,disabled:!a(E),class:H(["btn-primary text-[10px] md:text-xs px-2 md:px-4 py-2.5 md:py-3",a(q)?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-500":"bg-emerald-600 hover:bg-emerald-700 dark:bg-emerald-600 dark:hover:bg-emerald-500"])},[(s(),de(Se(a(q)?a(yt):a(Ge)),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})),e("span",Ts,p(a(q)?"Modifier":"Créer"),1)],10,Ps)])])]))}}),Is={class:"flex-1 flex flex-col lg:flex-row gap-4 p-4 lg:gap-6 lg:p-6 pb-20 lg:pb-6"},Ms={class:"lg:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 shadow-lg z-50"},qs={class:"flex"},Ns=["onClick"],js={class:"text-xs font-medium"},Ws=pe({__name:"CaissePage",setup(F){const y=T("services"),q=[{id:"services",label:"Services",icon:ut},{id:"ticket",label:"Ticket",icon:Ct},{id:"client",label:"Client",icon:Pt}];return(K,R)=>(s(),d(Y,null,[e("main",Is,[e("aside",{class:H(["lg:w-80 lg:flex-shrink-0",y.value==="ticket"?"block":"hidden lg:block"])},[$(qa)],2),e("section",{class:H(["flex-1 min-w-0",y.value==="services"?"block":"hidden lg:block"])},[$(Xr)],2),e("aside",{class:H(["lg:w-80 xl:w-96 lg:flex-shrink-0",y.value==="client"?"block":"hidden lg:block"])},[$(Es)],2)]),e("nav",Ms,[e("div",qs,[(s(),d(Y,null,te(q,E=>e("button",{key:E.id,onClick:G=>y.value=E.id,class:H(["flex-1 flex flex-col items-center justify-center py-3 transition-colors",y.value===E.id?"text-gray-900 bg-gray-100 dark:text-gray-100 dark:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-50 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:bg-gray-700/70"])},[(s(),de(Se(E.icon),{class:"w-5 h-5 mb-1"})),e("span",js,p(E.label),1)],10,Ns)),64))])])],64))}});export{Ws as default};
