import{c as me,a as D,r as E,s as L,i as Ie,d as pe,u as We,b as Se,w as ve,e as n,f as e,t as g,g as t,F as Z,h as Y,n as Q,j as C,k as H,l as ie,m as le,o as Ce,p as st,q as a,v as Pe,T as Ee,x as ot,P as Ae,y as ce,z as ue,A as Ze,B as lt,H as nt,L as dt}from"./index-DlgJK6M0.js";import{M as it,u as Be,U as Qe,a as ct}from"./useLoyalty-CtbipH7F.js";import{E as ut}from"./euro-B53o3jEP.js";import{P as mt,I as Ke,S as pt,f as Ge,a as Me}from"./formatInputs-D2y1egEn.js";import{P as gt,_ as yt}from"./_plugin-vue_export-helper-BznbHkax.js";import{M as Je}from"./minus-DjAp8Rwv.js";import{P as Le}from"./plus-BHVcOIaE.js";import{T as Xe}from"./trash-2-DpAZAPWA.js";import{B as vt,C as Oe,S as xt,G as Ye,H as bt,W as ft}from"./wrench-DQjPp6xT.js";import{C as ht}from"./clock-rwr5KbxI.js";import{X as kt}from"./x--dGNUvlK.js";import{S as $e}from"./search-TkKmFztP.js";const _t=me("barcode",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]]);const De=me("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const et=me("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);const wt=me("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);const Ct=me("user-pen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]]);const $t=me("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const St=me("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),W=E([]),be=E("euro"),oe=E(0),ye=E(null),ee=E([]),Ne=E([]),qe=E(!1),de=E(null),Pt=.2;function Te(){const B=(r,o)=>W.value.filter(x=>x.product.id===r&&x.lineId!==o).reduce((x,I)=>x+I.quantity,0),y=(r,o)=>{if(r.type!=="product")return 1/0;const x=B(r.id,o);return Math.max(0,(r.stock??0)-x)},j=(r,o=1,x)=>{const I=y(r),u=r.type==="product"?Math.min(o,I):o;if(u<=0)return;const X={lineId:`line-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,product:r,quantity:u,vendor_id:x?.id,vendor:x,price_ht:r.price_ht,tva_rate:r.tva_rate||Pt,subtotal_ht:0,tva:0,subtotal_ttc:0};z(X),W.value.push(X)},z=r=>{const o=r.fixedPriceTTC??r.product.price_ttc;r.subtotal_ttc=o*r.quantity;const x=1+r.tva_rate;r.subtotal_ht=r.subtotal_ttc/x,r.tva=r.subtotal_ttc-r.subtotal_ht,r.price_ht=r.subtotal_ht/r.quantity},R=r=>W.value.find(o=>o.lineId===r),P=(r,o)=>{const x=R(r);x&&(o==null||o<0?delete x.fixedPriceTTC:x.fixedPriceTTC=o,z(x))},G=(r,o)=>{const x=R(r);if(x)if(o<=0)U(r);else{const I=x.product.type==="product"?y(x.product,r)+x.quantity:o;x.quantity=Math.min(o,I),z(x)}},U=r=>{W.value=W.value.filter(o=>o.lineId!==r)},M=()=>{W.value=[],oe.value=0,ye.value=null,ee.value=[]},s=D(()=>W.value.reduce((r,o)=>r+o.subtotal_ht,0)),m=D(()=>W.value.reduce((r,o)=>r+o.tva,0)),v=D(()=>s.value+m.value),S=D(()=>{if(oe.value<=0)return 0;if(be.value==="euro")return Math.min(oe.value,v.value);{const r=Math.min(oe.value,100);return v.value*r/100}}),d=D(()=>ye.value!=null&&ye.value>=0?ye.value:Math.max(0,v.value-S.value)),p=D(()=>W.value.reduce((r,o)=>r+o.quantity,0)),k=D(()=>W.value.length===0),A=(r,o)=>{be.value=r,oe.value=Math.max(0,o)},V=()=>{be.value="euro",oe.value=0},q=r=>{ye.value=r},_=(r,o)=>{const x=ee.value.find(I=>I.method===r);x?x.amount+=o:ee.value.push({method:r,amount:o})},N=(r,o)=>{const x=ee.value.find(I=>I.method===r);x?x.amount=o:ee.value.push({method:r,amount:o})},T=r=>{ee.value=ee.value.filter(o=>o.method!==r)},te=()=>{ee.value=[]},J=D(()=>ee.value.reduce((r,o)=>r+o.amount,0)),ae=D(()=>Math.max(0,d.value-J.value)),O=D(()=>Math.max(0,J.value-d.value)),K=D(()=>J.value>=d.value&&d.value>0),b=()=>{const r=new Date,o=r.toISOString().split("T")[0].replace(/-/g,""),x=r.getTime().toString().slice(-4);return`T-${o}-${x}`};return{cartItems:W,discountType:be,discountValue:oe,selectedPaymentMethods:ee,recentSales:Ne,isProcessing:qe,error:de,subtotalHT:s,totalTVA:m,subtotalTTC:v,discountAmount:S,total:d,itemCount:p,isEmpty:k,totalPaid:J,remainingToPay:ae,change:O,isPaymentComplete:K,addToCart:j,updateQuantity:G,removeFromCart:U,getMaxQuantityForItem:r=>r.product.type!=="product"?1/0:y(r.product,r.lineId)+r.quantity,setItemFixedPrice:P,clearCart:M,setDiscount:A,clearDiscount:V,setFixedTotal:q,fixedTotal:ye,addPayment:_,setPayment:N,removePayment:T,clearPayments:te,validateSale:async(r,o)=>{if(k.value)return de.value="Le panier est vide",null;if(!o)return de.value="Veuillez sélectionner ou créer un client avant de valider",null;if(!K.value)return de.value="Le paiement n'est pas complet",null;if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r))return de.value="Aucun vendeur sélectionné. Veuillez sélectionner un vendeur.",console.error("vendorId invalide:",r),null;qe.value=!0,de.value=null,console.log("Validation vente - vendorId:",r,"clientId:",o);try{if(Ie()){const h=new Map;for(const re of W.value)if(re.product.type==="product"){const ge=h.get(re.product.id)??0;h.set(re.product.id,ge+re.quantity)}for(const[re,ge]of h){const ne=W.value.find(at=>at.product.id===re);if(!ne)continue;const{data:_e,error:we}=await L.from("products").select("stock").eq("id",re).single();if(we||!_e)throw new Error(`Produit ${ne.product.name} introuvable`);const xe=_e.stock??0;if(xe<ge)throw new Error(`Stock insuffisant pour "${ne.product.name}" : ${xe} en stock, ${ge} demandé`)}}let I;if(Ie()){const{data:h}=await L.rpc("generate_ticket_number");I=h||b()}const u={ticket_number:I,vendor_id:r,client_id:o||null,subtotal_ht:s.value,total_tva:m.value,subtotal_ttc:v.value,discount_type:be.value,discount_value:oe.value,discount_amount:S.value,total:d.value,status:"completed"},$=W.value.map(h=>({product_id:h.product.id,variant_id:h.variant?.id||null,vendor_id:h.vendor_id||r,product_name:h.product.name,price_ht:h.price_ht,tva_rate:h.tva_rate,quantity:h.quantity,subtotal_ht:h.subtotal_ht,tva:h.tva,subtotal_ttc:h.subtotal_ttc})),X=ee.value.map(h=>({method:h.method,amount:h.amount}));Ie();const{data:se,error:ze}=await L.from("sales").insert(u).select().single();if(ze)throw ze;const tt=$.map(h=>({...h,sale_id:se.id})),{error:Ue}=await L.from("sale_items").insert(tt);if(Ue)throw Ue;const rt=X.map(h=>({...h,sale_id:se.id})),{error:He}=await L.from("payments").insert(rt);if(He)throw He;for(const h of W.value)if(h.product.type==="product"){const{data:re,error:ge}=await L.from("products").select("stock").eq("id",h.product.id).single();if(ge||!re)throw new Error(`Produit ${h.product.name} introuvable`);const ne=re.stock??0;if(ne<h.quantity)throw new Error(`Stock insuffisant pour "${h.product.name}" : ${ne} en stock, ${h.quantity} demandé`);const _e=ne-h.quantity,{error:we}=await L.from("products").update({stock:_e,updated_at:new Date().toISOString()}).eq("id",h.product.id);if(we)throw we;const{error:xe}=await L.from("stock_movements").insert({product_id:h.product.id,variant_id:h.variant?.id||null,type:"out",quantity:-h.quantity,reason:"Vente",reference_id:se.id,vendor_id:r});if(xe)throw xe}if(o){const{data:h}=await L.from("clients").select("visit_count, total_spent, loyalty_points").eq("id",o).single();h&&await L.from("clients").update({visit_count:h.visit_count+1,total_spent:h.total_spent+d.value,last_visit_at:new Date().toISOString()}).eq("id",o)}return Ne.value.unshift(se),M(),se}catch(I){return console.error("Erreur validation vente:",I),de.value=I.message||"Erreur lors de la validation",null}finally{qe.value=!1}},loadRecentSales:async(r=10)=>{try{const{data:o,error:x}=await L.from("sales").select(`
          *,
          vendor:vendors(*),
          client:clients(*),
          items:sale_items(*),
          payments(*)
        `).order("created_at",{ascending:!1}).limit(r);if(x)throw x;return Ne.value=o||[],o}catch(o){return console.error("Erreur chargement ventes:",o),[]}},getSaleById:async r=>{try{const{data:o,error:x}=await L.from("sales").select(`
          *,
          vendor:vendors(*),
          client:clients(*),
          items:sale_items(*, product:products(*)),
          payments(*)
        `).eq("id",r).single();return x?null:o}catch{return null}},cancelSale:async(r,o)=>{try{const{error:x}=await L.from("sales").update({status:"cancelled",notes:o}).eq("id",r);if(x)throw x;return!0}catch(x){return console.error("Erreur annulation vente:",x),!1}}}}const Et=[{id:"1",first_name:"Jean",last_name:"Dupont",phone:"06 12 34 56 78",phone2:null,email:"jean.dupont@email.com",address:"123 Rue de la Paix",city:"Paris",postal_code:"75001",birth_date:"1985-03-15",notes:"Client fidèle",company:null,loyalty_points:150,total_spent:450,visit_count:15,last_visit_at:"2026-01-15",created_at:"",updated_at:""},{id:"2",first_name:"Marie",last_name:"Martin",phone:"06 98 76 54 32",phone2:"01 23 45 67 89",email:"marie.martin@email.com",address:"456 Avenue des Champs",city:"Lyon",postal_code:"69001",birth_date:"1990-07-22",notes:null,company:null,loyalty_points:75,total_spent:225,visit_count:8,last_visit_at:"2026-01-20",created_at:"",updated_at:""},{id:"3",first_name:"Pierre",last_name:"Bernard",phone:"07 11 22 33 44",phone2:null,email:null,address:null,city:null,postal_code:null,birth_date:null,notes:"Préfère les rendez-vous le samedi",company:null,loyalty_points:30,total_spent:90,visit_count:3,last_visit_at:"2026-01-10",created_at:"",updated_at:""}],je=E([]),Ve=E(null),Fe=E(!1),Re=E(!1),fe=E(null);function ke(){return{clients:je,selectedClient:Ve,invoiceInCompanyName:Fe,isLoading:Re,error:fe,loadClients:async()=>{Re.value=!0,fe.value=null;try{const{data:s,error:m}=await L.from("clients").select("*").order("last_name");if(m)throw m;je.value=s||[]}catch(s){console.error("Erreur chargement clients:",s),fe.value=s.message,je.value=Et}finally{Re.value=!1}},searchClients:async s=>{if(!s||s.length<2)return[];try{const{data:m,error:v}=await L.from("clients").select("*").or(`first_name.ilike.%${s}%,last_name.ilike.%${s}%,phone.ilike.%${s}%`).limit(10);if(v)throw v;return m||[]}catch(m){return console.error("Erreur recherche clients:",m),[]}},getClientById:async s=>{try{const{data:m,error:v}=await L.from("clients").select("*").eq("id",s).single();return v?null:m}catch{return null}},createClient:async s=>{console.log("createClient appelé avec:",s);try{console.log("Insertion dans Supabase...");const{data:m,error:v}=await L.from("clients").insert({first_name:s.first_name,last_name:s.last_name,phone:s.phone,phone2:s.phone2||null,email:s.email||null,address:s.address||null,city:s.city||null,postal_code:s.postal_code||null,birth_date:s.birth_date||null,notes:s.notes||null,company:s.company??null}).select().single();if(v)throw console.error("Erreur Supabase:",v),v;return console.log("Client créé avec succès:",m),m}catch(m){return console.error("Erreur création client:",m),fe.value=m.message,null}},updateClient:async(s,m)=>{console.log("updateClient appelé avec:",s,m);try{const{data:v,error:S}=await L.from("clients").update(m).eq("id",s).select().single();if(S)throw S;return console.log("Client mis à jour:",v),v}catch(v){return console.error("Erreur mise à jour client:",v),fe.value=v.message,null}},selectClient:s=>{Ve.value=s},setInvoiceInCompanyName:s=>{Fe.value=s},clearSelection:()=>{Ve.value=null,Fe.value=!1},updateClientAfterSale:async(s,m)=>{try{const{data:v}=await L.from("clients").select("visit_count, total_spent").eq("id",s).single();v&&await L.from("clients").update({visit_count:v.visit_count+1,total_spent:v.total_spent+m,last_visit_at:new Date().toISOString()}).eq("id",s)}catch(v){console.error("Erreur mise à jour client après vente:",v)}}}}const Tt={class:"card h-full flex flex-col overflow-hidden"},It={class:"p-4 md:p-5 border-b border-gray-200 bg-gray-50 dark:bg-gray-800 dark:border-gray-700"},Mt={class:"flex items-center justify-between"},Nt={class:"text-xs md:text-sm font-semibold text-gray-900 dark:text-gray-100"},qt={class:"flex-1 overflow-y-auto p-4 md:p-5 space-y-2 md:space-y-3 min-h-0"},jt={class:"flex items-start justify-between gap-2 md:gap-3 mb-2 md:mb-3"},Vt={class:"flex-1 min-w-0"},Ft={class:"font-medium text-gray-900 dark:text-gray-100 line-clamp-2 text-xs md:text-sm leading-snug"},Rt={key:0,class:"text-[10px] text-gray-500 dark:text-gray-400 mt-0.5"},At={class:"font-bold text-gray-900 dark:text-gray-100 whitespace-nowrap text-sm md:text-base tabular-nums"},Dt={class:"flex items-center gap-2 mb-2"},Bt=["value","onInput"],Lt={class:"flex items-center justify-between"},zt={class:"flex items-center gap-2"},Ut=["onClick"],Ht={class:"w-7 md:w-9 text-center text-xs md:text-sm font-semibold tabular-nums text-gray-900 dark:text-gray-100"},Qt=["onClick","disabled"],Kt=["onClick"],Gt={key:1,class:"h-full flex items-center justify-center py-8"},Ot={class:"px-4 py-3 md:px-5 md:py-4 border-t border-gray-100 dark:border-gray-700"},Wt={class:"flex flex-col gap-2 md:gap-3"},Zt={class:"flex items-center justify-between gap-2"},Jt={class:"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-full p-0.5 shadow-inner border border-gray-200 dark:border-gray-600"},Xt={class:"flex items-center gap-2"},Yt=["value","max"],er={class:"text-xs md:text-sm font-medium text-gray-500 dark:text-gray-400 min-w-[24px] md:min-w-[32px] text-center"},tr={class:"px-4 py-3 md:px-5 md:py-4 border-t border-gray-100 dark:border-gray-700"},rr={class:"flex flex-col gap-2"},ar={class:"flex items-center gap-2"},sr=["value"],or={class:"px-4 py-3 md:px-5 md:py-4 border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-800"},lr={class:"grid grid-cols-3 md:grid-cols-2 gap-1.5 md:gap-2"},nr=["onClick"],dr={class:"font-medium truncate"},ir={class:"p-4 md:p-5 border-t-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},cr={class:"space-y-2 md:space-y-2.5 mb-3 md:mb-4"},ur={class:"flex justify-between text-xs md:text-sm"},mr={class:"text-gray-700 dark:text-gray-300 tabular-nums"},pr={class:"flex justify-between text-xs md:text-sm"},gr={class:"text-gray-700 dark:text-gray-300 tabular-nums"},yr={class:"flex justify-between text-xs md:text-sm font-medium"},vr={class:"text-gray-900 dark:text-gray-100 tabular-nums"},xr={key:0,class:"flex justify-between text-xs md:text-sm"},br={class:"text-gray-600 dark:text-gray-400"},fr={class:"text-[10px] md:text-xs"},hr={class:"text-red-600 dark:text-red-400 font-medium tabular-nums"},kr={class:"flex justify-between text-xl md:text-2xl font-bold pt-2 md:pt-3 border-t border-gray-200 dark:border-gray-600"},_r={class:"text-gray-900 dark:text-gray-100 tabular-nums"},wr={class:"grid grid-cols-4 gap-1.5 md:gap-2"},Cr={class:"btn-icon-sm p-2 md:p-3",title:"Imprimer","aria-label":"Imprimer"},$r={class:"btn-icon-sm p-2 md:p-3",title:"Email","aria-label":"Envoyer par email"},Sr=["disabled"],Pr={key:0,class:"animate-spin"},Er=pe({__name:"TicketPanel",setup(B){const{cartItems:y,subtotalHT:j,totalTVA:z,subtotalTTC:R,total:P,discountAmount:G,fixedTotal:U,setFixedTotal:M,updateQuantity:s,removeFromCart:m,setItemFixedPrice:v,clearCart:S,setDiscount:d,setPayment:p,clearPayments:k,validateSale:A,isProcessing:V,getMaxQuantityForItem:q,error:_}=Te(),{vendor:N}=We(),{selectedClient:T}=ke(),{loadProducts:te}=Se(),{saveStamps:J,loadClientStamps:ae}=Be(),O=E("euro"),K=E(0),b=E("card"),c=[{id:"cash",label:"Espèces",icon:vt},{id:"card",label:"CB",icon:Oe},{id:"contactless",label:"Sans contact",icon:xt},{id:"amex",label:"American Express",icon:Oe},{id:"check",label:"Chèque",icon:st},{id:"gift_card",label:"Chèque Cadeau",icon:Ye},{id:"free",label:"Gratuit",icon:bt},{id:"technical",label:"Utilisation technique",icon:ft}],l=I=>I.toFixed(2),i=I=>{O.value=I,I==="percent"&&(K.value=Math.min(K.value,100)),d(O.value,K.value)},f=I=>{const u=I.target,$=Number(u.value);O.value==="percent"?K.value=Math.min($,100):K.value=Math.min($,R.value),d(O.value,K.value)},w=I=>{b.value=I,k(),p(I,P.value)};ve([P,b],()=>{P.value>0&&b.value&&p(b.value,P.value)},{immediate:!0});const r=async()=>{if(y.value.length===0)return;if(!T.value){alert("Veuillez sélectionner ou créer un client avant de valider la vente.");return}p(b.value,P.value);const I=await A(N.value?.id||"demo",T.value?.id);I?(T.value&&N.value&&(await J(T.value.id,N.value.id,I.id),await ae(T.value.id)),await te(),alert(`✅ Vente validée !
Ticket: ${I.ticket_number}
Total: ${l(I.total)}€`)):_.value&&alert(`❌ Erreur : ${_.value}`)},o=D(()=>new Date().toLocaleDateString("fr-FR")),x=D(()=>O.value==="percent"?100:R.value);return D(()=>R.value),(I,u)=>(a(),n("div",Tt,[e("div",It,[e("div",Mt,[e("div",null,[u[5]||(u[5]=e("p",{class:"text-[10px] md:text-[11px] text-gray-500 uppercase tracking-wider font-semibold mb-1 dark:text-gray-400"},"Date",-1)),e("p",Nt,g(o.value),1)]),u[6]||(u[6]=e("div",{class:"text-right"},[e("p",{class:"text-[10px] md:text-[11px] text-gray-500 uppercase tracking-wider font-semibold mb-1 dark:text-gray-400"},"Ticket"),e("p",{class:"text-xs md:text-sm font-semibold text-gray-900 dark:text-gray-100"},"#001")],-1))])]),e("div",qt,[t(y).length>0?(a(!0),n(Z,{key:0},Y(t(y),$=>(a(),n("div",{key:$.lineId,class:"cart-item"},[e("div",jt,[e("div",Vt,[e("p",Ft,g($.product.name),1),$.vendor?(a(),n("p",Rt," par "+g($.vendor.initials||`${$.vendor.first_name} ${$.vendor.last_name}`),1)):H("",!0)]),e("p",At,g(l($.subtotal_ttc))+"€ ",1)]),e("div",Dt,[u[7]||(u[7]=e("label",{class:"text-[10px] text-gray-500 dark:text-gray-400 shrink-0"},"Prix unit. (€)",-1)),e("input",{type:"number",value:$.fixedPriceTTC??"",onInput:X=>{const se=X.target.value;t(v)($.lineId,se===""?null:Math.max(0,Number(se)))},min:"0",step:"0.01",placeholder:"Prix libre",class:"flex-1 min-w-0 px-2 py-1.5 text-[11px] bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-gray-400 tabular-nums"},null,40,Bt)]),e("div",Lt,[e("div",zt,[e("button",{onClick:X=>t(s)($.lineId,$.quantity-1),class:"w-8 h-8 md:w-9 md:h-9 rounded-lg bg-white border border-gray-300 flex items-center justify-center hover:bg-gray-100 hover:border-gray-400 dark:bg-gray-600 dark:border-gray-500 dark:hover:bg-gray-500 dark:text-gray-100 transition-colors","aria-label":"Diminuer la quantité"},[C(t(Je),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})],8,Ut),e("span",Ht,g($.quantity),1),e("button",{onClick:X=>t(s)($.lineId,$.quantity+1),disabled:$.quantity>=t(q)($),class:"w-8 h-8 md:w-9 md:h-9 rounded-lg bg-white border border-gray-300 flex items-center justify-center hover:bg-gray-100 hover:border-gray-400 dark:bg-gray-600 dark:border-gray-500 dark:hover:bg-gray-500 dark:text-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Augmenter la quantité"},[C(t(Le),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})],8,Qt)]),e("button",{onClick:X=>t(m)($.lineId),class:"p-1.5 md:p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/30 rounded-lg transition-colors","aria-label":"Supprimer l'article"},[C(t(Xe),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})],8,Kt)])]))),128)):(a(),n("div",Gt,[...u[8]||(u[8]=[e("p",{class:"text-gray-400 dark:text-gray-500 text-xs md:text-sm"},"Aucun article",-1)])]))]),e("div",Ot,[e("div",Wt,[e("div",Zt,[u[13]||(u[13]=e("label",{class:"text-xs md:text-sm text-gray-600 dark:text-gray-400 font-medium"},"Réduction",-1)),e("div",Jt,[e("button",{onClick:u[0]||(u[0]=$=>i("euro")),class:Q(["inline-flex items-center gap-0.5 md:gap-1 px-2 md:px-3 py-1 md:py-1.5 text-[10px] md:text-xs font-semibold rounded-full transition-all duration-150",O.value==="euro"?"bg-white text-gray-900 shadow-sm dark:bg-gray-600 dark:text-gray-100":"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200"])},[C(t(ut),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),u[9]||(u[9]=e("span",{class:"hidden sm:inline"},"Montant",-1)),u[10]||(u[10]=e("span",{class:"sm:hidden"},"€",-1))],2),e("button",{onClick:u[1]||(u[1]=$=>i("percent")),class:Q(["inline-flex items-center gap-0.5 md:gap-1 px-2 md:px-3 py-1 md:py-1.5 text-[10px] md:text-xs font-semibold rounded-full transition-all duration-150",O.value==="percent"?"bg-white text-gray-900 shadow-sm dark:bg-gray-600 dark:text-gray-100":"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200"])},[C(t(mt),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),u[11]||(u[11]=e("span",{class:"hidden sm:inline"},"Pourcentage",-1)),u[12]||(u[12]=e("span",{class:"sm:hidden"},"%",-1))],2)])]),e("div",Xt,[e("input",{type:"number",value:K.value,onInput:f,min:"0",max:x.value,step:"0.01",class:"flex-1 px-3 md:px-4 py-2 md:py-2.5 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 border border-gray-300 rounded-lg text-xs md:text-sm text-right focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all tabular-nums"},null,40,Yt),e("span",er,g(O.value==="percent"?"%":"€"),1)])])]),e("div",tr,[e("div",rr,[u[14]||(u[14]=e("label",{class:"text-xs md:text-sm text-gray-600 dark:text-gray-400 font-medium"},"Fixer le prix total (€)",-1)),e("div",ar,[e("input",{type:"number",value:t(U)??"",onInput:u[2]||(u[2]=$=>{const X=$.target.value;t(M)(X===""?null:Math.max(0,Number(X)))}),min:"0",step:"0.01",placeholder:"Prix libre",class:"flex-1 px-3 md:px-4 py-2 md:py-2.5 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-500 border border-gray-300 rounded-lg text-xs md:text-sm text-right focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 tabular-nums"},null,40,sr),t(U)!=null?(a(),n("button",{key:0,type:"button",onClick:u[3]||(u[3]=$=>t(M)(null)),class:"px-2 py-2 text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/30 rounded-lg text-xs font-medium",title:"Annuler le prix fixé"}," Réinit ")):H("",!0)])])]),e("div",or,[u[15]||(u[15]=e("p",{class:"text-[10px] md:text-[11px] text-gray-600 dark:text-gray-400 uppercase tracking-wider font-semibold mb-2 md:mb-3"},"Règlement",-1)),e("div",lr,[(a(),n(Z,null,Y(c,$=>e("button",{key:$.id,onClick:X=>w($.id),class:Q(["payment-btn text-[10px] md:text-xs",b.value===$.id&&"active"])},[(a(),le(Ce($.icon),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})),e("span",dr,g($.label),1)],10,nr)),64))])]),e("div",ir,[e("div",cr,[e("div",ur,[u[16]||(u[16]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Sous-total HT",-1)),e("span",mr,g(l(t(j)))+"€",1)]),e("div",pr,[u[17]||(u[17]=e("span",{class:"text-gray-500 dark:text-gray-400"},"TVA (20%)",-1)),e("span",gr,g(l(t(z)))+"€",1)]),e("div",yr,[u[18]||(u[18]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Sous-total TTC",-1)),e("span",vr,g(l(t(R)))+"€",1)]),K.value>0?(a(),n("div",xr,[e("span",br,[u[19]||(u[19]=ie(" Réduction ",-1)),e("span",fr,"("+g(O.value==="percent"?`${K.value}%`:`${l(K.value)}€`)+")",1)]),e("span",hr,"-"+g(l(t(G)))+"€",1)])):H("",!0),e("div",kr,[u[20]||(u[20]=e("span",{class:"text-gray-900 dark:text-gray-100"},"Total",-1)),e("span",_r,g(l(t(P)))+"€",1)])]),e("div",wr,[e("button",Cr,[C(t(gt),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})]),e("button",$r,[C(t(it),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})]),e("button",{onClick:u[4]||(u[4]=(...$)=>t(S)&&t(S)(...$)),class:"btn-icon-sm p-2 md:p-3 text-orange-600 hover:bg-orange-50 hover:border-orange-200 dark:text-orange-400 dark:hover:bg-orange-900/30 dark:hover:border-orange-700",title:"Annuler","aria-label":"Annuler la transaction"},[C(t(et),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})]),e("button",{onClick:r,disabled:t(y).length===0||t(V),class:Q(["btn-icon-sm p-2 md:p-3",t(y).length>0&&!t(V)?"bg-emerald-600 text-white hover:bg-emerald-700 border-emerald-600 dark:bg-emerald-600 dark:border-emerald-600":"bg-gray-100 text-gray-400 cursor-not-allowed border-gray-200 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-500"]),title:"Valider","aria-label":"Valider la transaction"},[t(V)?(a(),n("span",Pr,"⏳")):(a(),le(t(De),{key:1,class:"w-4 h-4 md:w-5 md:h-5"}))],10,Sr)])])]))}}),Tr=["aria-label"],Ir={class:"service-header"},Mr={class:"service-header-left"},Nr={class:"service-code"},qr=["aria-label"],jr={class:"service-price"},Vr={class:"service-body"},Fr={class:"service-name"},Rr={key:0,class:"service-duration"},Ar={class:"hidden sm:inline"},Dr={class:"sm:hidden"},Br=pe({__name:"ServiceCard",props:{service:{}},setup(B){const y=B,{addToCart:j,cartItems:z}=Te(),{getCategoryBorderColor:R}=Se(),P=D(()=>{const M=z.value.find(s=>s.product.id===y.service.id);return M?M.quantity:0}),G=D(()=>R(y.service)),U=()=>{j(y.service)};return(M,s)=>(a(),n("button",{onClick:U,"aria-label":`Ajouter ${B.service.name} au panier`,class:Q(["service-card",G.value,P.value>0&&"active"])},[e("div",Ir,[e("div",Mr,[e("span",Nr,g(B.service.code),1),P.value>0?(a(),n("span",{key:0,class:"quantity-badge","aria-label":`Quantité: ${P.value}`},g(P.value),9,qr)):H("",!0)]),e("span",jr,g(B.service.price_ttc?.toFixed(2)||B.service.price_ht?.toFixed(2))+"€ ",1)]),e("div",Vr,[e("h3",Fr,g(B.service.name),1),B.service.duration?(a(),n("span",Rr,[C(t(ht),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),e("span",Ar,g(B.service.duration)+"min",1),e("span",Dr,g(B.service.duration)+"'",1)])):H("",!0)])],10,Tr))}}),Lr=yt(Br,[["__scopeId","data-v-588d3745"]]),zr={class:"card p-4"},Ur={class:"flex items-center justify-between mb-3"},Hr={class:"flex items-center gap-2"},Qr={class:"w-8 h-8 rounded-full bg-yellow-100 dark:bg-yellow-900/40 flex items-center justify-center"},Kr={class:"text-xs text-gray-500 dark:text-gray-400"},Gr={class:"flex items-center gap-2"},Or=["disabled"],Wr=["disabled"],Zr={key:3,class:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-green-100 text-green-700 dark:bg-emerald-900/40 dark:text-emerald-300 rounded-full text-xs font-semibold"},Jr={class:"grid grid-cols-6 sm:grid-cols-12 gap-2 w-full"},Xr=["onClick"],Yr={key:0,class:"absolute bottom-0.5 left-0 right-0 text-xs text-yellow-700 dark:text-amber-300 font-semibold leading-tight"},ea=pe({__name:"LoyaltyCard",setup(B){const{stamps:y,checkedCount:j,isCardComplete:z,stampsCount:R,toggleStamp:P,addPointsManually:G,removePointsManually:U,resetPointsToZero:M,loadClientStamps:s}=Be(),{selectedClient:m}=ke(),{vendor:v}=We(),S=E(!1),d=D(()=>y.value.filter(_=>_.isStamped&&!_.date).length),p=D(()=>y.value.filter(_=>_.markedForRemoval).length),k=async()=>{if(!(!m.value||!v.value||d.value===0)){S.value=!0;try{const _=await G(m.value.id,v.value.id);_?.success?(await s(m.value.id),alert(`${_.count} point(s) fidélité ajouté(s)`)):alert("Erreur lors de l'ajout des points")}catch{alert("Erreur lors de l'ajout des points")}finally{S.value=!1}}},A=async()=>{if(!(!m.value||p.value===0)&&confirm(`Retirer ${p.value} point(s) fidélité ?`)){S.value=!0;try{const _=await U(m.value.id);_?.success?(await s(m.value.id),alert(`${_.count} point(s) fidélité retiré(s)`)):alert("Erreur lors du retrait des points")}catch{alert("Erreur lors du retrait des points")}finally{S.value=!1}}},V=async()=>{if(!(!m.value||!confirm("Réinitialiser les points fidélité à 0 ?")))try{await M(m.value.id),await s(m.value.id)}catch{alert("Erreur lors de la réinitialisation")}},q=_=>{if(!_)return"";const N=new Date(_),T=String(N.getDate()).padStart(2,"0"),te=String(N.getMonth()+1).padStart(2,"0"),J=N.getFullYear();return`${T}/${te}/${J}`};return(_,N)=>(a(),n("div",zr,[e("div",Ur,[e("div",Hr,[e("div",Qr,[C(t(Ye),{class:"w-4 h-4 text-yellow-600 dark:text-yellow-400"})]),N[0]||(N[0]=e("span",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},"Carte fidélité",-1)),e("span",Kr,g(t(j))+"/"+g(t(R)),1)]),e("div",Gr,[t(m)&&d.value>0?(a(),n("button",{key:0,type:"button",onClick:k,disabled:S.value,class:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-yellow-700 bg-yellow-100 hover:bg-yellow-200 dark:text-amber-300 dark:bg-amber-900/50 dark:hover:bg-amber-900/70 rounded-lg transition-colors disabled:opacity-50",title:"Enregistrer les points cochés (sans vente)"},[C(t(Le),{class:"w-3.5 h-3.5"}),ie(" "+g(S.value?"Enregistrement...":`+${d.value} point(s)`),1)],8,Or)):H("",!0),t(m)&&p.value>0?(a(),n("button",{key:1,type:"button",onClick:A,disabled:S.value,class:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-red-700 bg-red-100 hover:bg-red-200 dark:text-red-300 dark:bg-red-900/50 dark:hover:bg-red-900/70 rounded-lg transition-colors disabled:opacity-50",title:"Retirer les points sélectionnés"},[C(t(Je),{class:"w-3.5 h-3.5"}),ie(" "+g(S.value?"Retrait...":`-${p.value} point(s)`),1)],8,Wr)):H("",!0),t(m)?(a(),n("button",{key:2,type:"button",onClick:V,class:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Réinitialiser les points à 0"},[C(t(et),{class:"w-3.5 h-3.5"}),N[1]||(N[1]=ie(" Réinit. points ",-1))])):H("",!0),t(z)?(a(),n("span",Zr,[C(t(De),{class:"w-3.5 h-3.5"}),N[2]||(N[2]=ie(" Complète ",-1))])):H("",!0)])]),e("div",Jr,[(a(!0),n(Z,null,Y(t(y),T=>(a(),n("button",{key:T.position,onClick:te=>t(P)(T.position),class:Q(["relative aspect-square w-full max-w-none rounded-xl border-2 transition-all duration-200 flex flex-col items-center justify-center overflow-hidden",T.markedForRemoval?"border-red-500 bg-red-50 dark:border-red-500 dark:bg-red-900/30 ring-2 ring-red-400":T.isStamped?"border-yellow-500 bg-yellow-50 hover:bg-yellow-100 dark:border-amber-500 dark:bg-amber-900/30 dark:hover:bg-amber-900/50":"border-gray-300 bg-white hover:bg-gray-50 hover:border-gray-400 dark:border-gray-600 dark:bg-gray-700 dark:hover:bg-gray-600 dark:hover:border-gray-500"])},[e("span",{class:Q(["text-base font-bold",T.markedForRemoval?"text-red-600 dark:text-red-400 line-through":T.isStamped?"text-yellow-600 dark:text-amber-400":"text-gray-400 dark:text-gray-500"])},g(T.position),3),C(Ee,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"scale-0 opacity-0","enter-to-class":"scale-100 opacity-100"},{default:Pe(()=>[T.isStamped?(a(),n("div",{key:0,class:Q(["absolute inset-0 flex items-center justify-center",T.markedForRemoval?"bg-red-500/20 dark:bg-red-500/30":"bg-yellow-500/20 dark:bg-amber-500/30"])},[C(t(De),{class:Q(["w-6 h-6 drop-shadow",T.markedForRemoval?"text-red-600 dark:text-red-400":"text-yellow-600 dark:text-amber-400"])},null,8,["class"])],2)):H("",!0)]),_:2},1024),T.isStamped&&T.date?(a(),n("span",Yr,g(q(T.date)),1)):H("",!0)],10,Xr))),128))])]))}}),ta={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-2xl max-h-[85vh] flex flex-col border border-gray-200 dark:border-gray-700 overflow-hidden",role:"dialog","aria-modal":"true","aria-labelledby":"product-picker-title"},ra={class:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 shrink-0"},aa={id:"product-picker-title",class:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2"},sa={class:"px-4 py-3 border-b border-gray-100 dark:border-gray-700 shrink-0"},oa={class:"relative"},la={class:"flex-1 overflow-y-auto p-4"},na={key:0},da={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 sticky top-0 bg-white dark:bg-gray-800 py-1"},ia={class:"space-y-4"},ca={class:"p-3 flex items-center justify-between"},ua={class:"min-w-0 flex-1"},ma={class:"font-medium text-gray-900 dark:text-white truncate"},pa={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},ga={class:"px-3 pb-3 flex flex-wrap gap-2"},ya=["onClick","disabled"],va={class:"text-xs opacity-90"},xa=["onClick","disabled"],ba={class:"text-xs opacity-90"},fa={key:1,class:"flex flex-col items-center justify-center py-16 text-gray-500 dark:text-gray-400"},ha=pe({__name:"ProductPickerDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(B,{emit:y}){const j=B,z=y,{physicalProducts:R,loadProducts:P}=Se(),{addToCart:G}=Te(),U=E(""),M=D({get:()=>j.modelValue,set:d=>z("update:modelValue",d)});ve(M,d=>{if(d){P(),U.value="";const p=k=>{k.key==="Escape"&&S()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)}});const s=D(()=>{const d=U.value.trim().toLowerCase();let p=R.value;return d&&(p=p.filter(k=>k.name.toLowerCase().includes(d)||k.brand?.toLowerCase().includes(d)||k.model?.toLowerCase().includes(d)||k.code?.toLowerCase().includes(d)||k.barcode?.toLowerCase().includes(d))),p}),m=D(()=>{const d=new Map;for(const k of s.value){const A=k.brand?.trim()||"Sans marque";d.has(A)||d.set(A,[]),d.get(A).push(k)}const p=[];for(const[k,A]of d){const V=new Map;for(const _ of A){const N=`${_.name}|${_.model??""}`;V.has(N)||V.set(N,[]),V.get(N).push(_)}const q=[];for(const[,_]of V){const N=_[0].model?`${_[0].name} ${_[0].model}`:_[0].name;q.push({displayName:N,variants:_.map(T=>({product:T,size:T.size??null,stock:T.stock??0}))})}q.sort((_,N)=>_.displayName.localeCompare(N.displayName)),p.push({brand:k,models:q})}return p.sort((k,A)=>k.brand.localeCompare(A.brand)),p}),v=d=>{(d.stock??0)<=0||G(d,1)},S=()=>{M.value=!1};return(d,p)=>(a(),le(ot,{to:"body"},[C(Ee,{"enter-active-class":"transition-opacity duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:Pe(()=>[M.value?(a(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:Ze(S,["self"])},[e("div",ta,[e("div",ra,[e("h2",aa,[C(t(Ae),{class:"w-5 h-5 text-gray-500 dark:text-gray-400"}),p[1]||(p[1]=ie(" Ajouter un produit ",-1))]),e("button",{onClick:S,class:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 dark:hover:text-gray-400 dark:hover:bg-gray-700 rounded-lg transition-colors","aria-label":"Fermer"},[C(t(kt),{class:"w-5 h-5"})])]),e("div",sa,[e("div",oa,[C(t($e),{class:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-gray-500 pointer-events-none"}),ce(e("input",{"onUpdate:modelValue":p[0]||(p[0]=k=>U.value=k),type:"text",placeholder:"Rechercher par nom, marque, code...",class:"w-full pl-11 pr-4 py-2.5 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-gray-900 dark:focus:ring-emerald-500 focus:border-transparent",autofocus:""},null,512),[[ue,U.value]])])]),e("div",la,[m.value.length>0?(a(),n("div",na,[(a(!0),n(Z,null,Y(m.value,({brand:k,models:A})=>(a(),n("div",{key:k,class:"mb-6 last:mb-0"},[e("h3",da,g(k),1),e("div",ia,[(a(!0),n(Z,null,Y(A,V=>(a(),n("div",{key:`${k}-${V.variants[0].product.id}`,class:"rounded-xl border border-gray-200 dark:border-gray-600 overflow-hidden bg-gray-50/50 dark:bg-gray-900/30"},[e("div",ca,[e("div",ua,[e("p",ma,g(V.displayName),1),e("p",pa,g(V.variants[0].product.price_ttc?.toFixed(2))+"€ ",1)])]),e("div",ga,[(a(!0),n(Z,null,Y(V.variants,q=>(a(),n(Z,{key:q.product.id},[q.size?(a(),n("button",{key:0,onClick:_=>v(q.product),disabled:q.stock<=0,class:Q(["inline-flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium transition-colors",q.stock>0?"bg-emerald-600 text-white hover:bg-emerald-700 dark:bg-emerald-500 dark:hover:bg-emerald-600 cursor-pointer":"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 cursor-not-allowed"])},[e("span",null,g(q.size),1),e("span",va,"("+g(q.stock)+")",1)],10,ya)):(a(),n("button",{key:1,onClick:_=>v(q.product),disabled:q.stock<=0,class:Q(["inline-flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium transition-colors",q.stock>0?"bg-emerald-600 text-white hover:bg-emerald-700 dark:bg-emerald-500 dark:hover:bg-emerald-600 cursor-pointer":"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 cursor-not-allowed"])},[C(t(Le),{class:"w-4 h-4"}),p[2]||(p[2]=e("span",null,"Ajouter",-1)),e("span",ba,"("+g(q.stock)+")",1)],10,xa))],64))),128))])]))),128))])]))),128))])):(a(),n("div",fa,[C(t(Ae),{class:"w-12 h-12 mb-4 opacity-40"}),p[3]||(p[3]=e("p",{class:"text-sm font-medium"},"Aucun produit trouvé",-1)),p[4]||(p[4]=e("p",{class:"text-xs mt-1"},"Modifiez votre recherche",-1))]))])])])):H("",!0)]),_:1})]))}}),ka={class:"card flex flex-col bg-white dark:bg-gray-800 h-full"},_a={class:"p-4 md:p-6 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 space-y-3"},wa={class:"flex gap-2"},Ca={class:"relative"},$a={class:"flex items-center gap-3"},Sa={class:"relative flex-1"},Pa={key:0,class:"text-xs text-red-500 dark:text-red-400 mt-1.5"},Ea={class:"space-y-1"},Ta={class:"flex gap-2"},Ia={class:"relative flex-1"},Ma=["onKeydown"],Na={key:0,class:"text-xs text-red-600 dark:text-red-400"},qa={class:"relative"},ja={class:"relative"},Va=["value"],Fa={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-white dark:bg-gray-700 rounded-xl shadow-xl border border-gray-200 dark:border-gray-600 py-2 z-50 max-h-60 md:max-h-80 overflow-y-auto"},Ra=["onClick"],Aa={class:"flex-1 min-w-0"},Da={class:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate"},Ba={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},La={class:"flex items-center gap-2 md:gap-3 ml-2 md:ml-3"},za={class:"text-sm font-bold text-gray-900 dark:text-gray-100 tabular-nums"},Ua={key:0,class:"text-xs text-gray-400 dark:text-gray-500 hidden sm:inline"},Ha={class:"flex-1 overflow-y-auto p-4 md:p-6 bg-gray-50 dark:bg-gray-800 space-y-4"},Qa={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2.5 md:gap-3.5"},Ka={key:1,class:"h-full flex flex-col items-center justify-center text-gray-400 dark:text-gray-500 py-12"},Ga=pe({__name:"ServiceGrid",setup(B){const{products:y,searchProducts:j,findByBarcode:z}=Se(),{addToCart:R}=Te(),{selectedClient:P}=ke(),{loadClientStamps:G,clearStamps:U}=Be(),M=E([]);(async()=>{const{data:i}=await L.from("vendors").select("*").eq("is_active",!0);M.value=i||[]})(),ve(P,i=>{i?G(i.id):U()});const m=E(!1),v=E(""),S=E(!1),d=E([]),p=E(""),k=E(""),A=E(""),V=E(""),q=D(()=>{const i=v.value.toLowerCase().trim(),f=y.value.filter(w=>w.type==="service"&&w.is_active!==!1).slice().sort((w,r)=>String(w.code??"").localeCompare(String(r.code??""),void 0,{numeric:!0}));return i?f.filter(w=>w.name.toLowerCase().includes(i)||w.code?.toLowerCase().includes(i)):f});ve(q,i=>{console.log("Services affichés:",i.length)},{immediate:!0});const _=async i=>{const f=i.target;if(v.value=f.value,f.value.trim().length>=2){const w=await j(f.value);d.value=(w||[]).filter(r=>r.type==="service"),S.value=d.value.length>0}else d.value=[],S.value=!1},N=()=>{v.value.trim().length>=2&&d.value.length>0&&(S.value=!0)},T=()=>{setTimeout(()=>{S.value=!1},200)},te=i=>{v.value=i.name,S.value=!1},J=i=>{if(i.key==="Enter"&&d.value.length>0){i.preventDefault();const f=d.value[0];R(f),v.value="",d.value=[],S.value=!1}},ae=async()=>{const i=A.value.trim();if(!i)return;V.value="";const f=await z(i);f?(R(f,1),A.value=""):(V.value="Produit non trouvé ou sans code-barres",setTimeout(()=>{V.value=""},3e3))};ve(v,i=>{i.trim().length<2&&(d.value=[],S.value=!1)});const O=i=>{const f=i.trim().toUpperCase();if(f.length<2)return null;const w=f.match(/^([A-Z]+)(\d+.*)$/);return w?{vendorInitials:w[1],productCode:w[2]}:null},K=i=>M.value.find(f=>f.initials?.toUpperCase()===i.toUpperCase()),b=i=>y.value.find(f=>f.code?.toUpperCase()===i.toUpperCase()),c=i=>{i.key==="Enter"&&(i.preventDefault(),l())},l=()=>{k.value="";const i=O(p.value);if(!i){k.value="Format invalide (ex: VL1)";return}const f=K(i.vendorInitials);if(!f){k.value=`Vendeur "${i.vendorInitials}" non trouvé`;return}const w=b(i.productCode);if(!w){k.value=`Service "${i.productCode}" non trouvé`;return}R(w,1,f),p.value="",k.value=""};return(i,f)=>(a(),n("div",ka,[e("div",_a,[e("div",wa,[e("button",{onClick:f[0]||(f[0]=w=>m.value=!0),class:"inline-flex items-center gap-2 px-4 py-2.5 bg-gray-900 dark:bg-emerald-600 dark:hover:bg-emerald-500 text-white rounded-xl font-medium hover:bg-gray-800 transition-colors text-sm"},[C(t(Ae),{class:"w-4 h-4"}),f[4]||(f[4]=ie(" Produits ",-1))])]),e("div",Ca,[e("div",$a,[e("div",Sa,[C(t(St),{class:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-amber-500 dark:text-amber-400 pointer-events-none z-10"}),ce(e("input",{"onUpdate:modelValue":f[1]||(f[1]=w=>p.value=w),onKeydown:c,type:"text",placeholder:"Raccourci (ex: VL1)",class:"w-full pl-11 pr-4 py-2.5 bg-amber-50 dark:bg-gray-700 dark:border-amber-600/50 dark:text-gray-100 border border-amber-300 rounded-xl text-sm font-mono font-semibold uppercase focus:outline-none focus:border-amber-500 focus:ring-2 focus:ring-amber-500/20 dark:focus:border-amber-400 dark:focus:ring-amber-400/30 hover:border-amber-400 transition-all placeholder:normal-case placeholder:font-normal dark:placeholder-gray-400",autocomplete:"off"},null,544),[[ue,p.value]])]),e("button",{onClick:l,class:"px-4 py-2.5 bg-amber-500 dark:bg-amber-600 text-white rounded-xl font-medium hover:bg-amber-600 dark:hover:bg-amber-500 transition-colors text-sm"}," OK ")]),k.value?(a(),n("p",Pa,g(k.value),1)):H("",!0)]),e("div",Ea,[f[5]||(f[5]=e("label",{class:"block text-[10px] md:text-xs text-gray-500 dark:text-gray-400 font-semibold uppercase tracking-wider"},"Scan code-barres",-1)),e("div",Ta,[e("div",Ia,[C(t(_t),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-gray-500 pointer-events-none"}),ce(e("input",{"onUpdate:modelValue":f[2]||(f[2]=w=>A.value=w),type:"text",placeholder:"Scannez le code-barres du produit...",class:"w-full pl-10 pr-4 py-2.5 md:py-3 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30",autocomplete:"off",onKeydown:lt(Ze(ae,["prevent"]),["enter"])},null,40,Ma),[[ue,A.value]])]),e("button",{type:"button",onClick:ae,class:"px-4 py-2.5 bg-gray-900 dark:bg-emerald-600 dark:hover:bg-emerald-500 text-white rounded-xl text-sm font-medium hover:bg-gray-800"}," Ajouter ")]),V.value?(a(),n("p",Na,g(V.value),1)):H("",!0)]),e("div",qa,[e("div",ja,[C(t($e),{class:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-gray-400 dark:text-gray-500 pointer-events-none z-10"}),e("input",{value:v.value,onInput:_,onFocus:N,onBlur:T,onKeydown:J,type:"text",placeholder:"Rechercher un service...",class:"w-full pl-11 md:pl-14 pr-4 md:pr-5 py-3 md:py-3.5 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all",autocomplete:"off"},null,40,Va)]),C(Ee,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:Pe(()=>[S.value&&d.value.length>0?(a(),n("div",Fa,[(a(!0),n(Z,null,Y(d.value,w=>(a(),n("button",{key:w.id,onClick:r=>te(w),class:"w-full px-4 md:px-5 py-2.5 md:py-3 text-left hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors flex items-center justify-between"},[e("div",Aa,[e("p",Da,g(w.name),1),e("p",Ba,g(w.code),1)]),e("div",La,[e("span",za,g(w.price_ttc?.toFixed(2))+"€",1),w.duration?(a(),n("span",Ua,g(w.duration)+"min",1)):H("",!0)])],8,Ra))),128))])):H("",!0)]),_:1})])]),e("div",Ha,[q.value.length>0?(a(),n("div",Qa,[(a(!0),n(Z,null,Y(q.value,w=>(a(),le(Lr,{key:w.id,service:w},null,8,["service"]))),128))])):(a(),n("div",Ka,[C(t($e),{class:"w-10 h-10 md:w-14 md:h-14 mb-4 opacity-40"}),f[6]||(f[6]=e("p",{class:"text-sm md:text-base font-medium text-gray-500 dark:text-gray-400"},"Aucun service trouvé",-1)),f[7]||(f[7]=e("p",{class:"text-xs md:text-sm text-gray-400 dark:text-gray-500 mt-1.5"},"Modifiez votre recherche",-1))])),t(P)?(a(),le(ea,{key:2})):H("",!0)]),C(ha,{modelValue:m.value,"onUpdate:modelValue":f[3]||(f[3]=w=>m.value=w)},null,8,["modelValue"])]))}}),F=E({id:"",firstName:"",lastName:"",phone:"",phone2:"",email:"",address:"",city:"",postalCode:"",birthDate:"",notes:"",company:""}),he=E(!1);function Oa(){const{createClient:B,updateClient:y,selectClient:j}=ke(),z=D(()=>!!(F.value.firstName.trim()||F.value.lastName.trim()||F.value.phone.trim())),R=()=>{F.value={id:"",firstName:"",lastName:"",phone:"",phone2:"",email:"",address:"",city:"",postalCode:"",birthDate:"",notes:"",company:""},he.value=!1,j(null)};return{currentClient:F,isEditMode:he,hasClientInfo:z,clearClient:R,loadClient:M=>{F.value={...M},he.value=!0},newClient:()=>{R()},saveClient:async()=>{if(!z.value)return{success:!1,isNew:!1,message:"Veuillez remplir au moins un champ (nom, prénom ou téléphone)"};if(!F.value.phone.trim())return{success:!1,isNew:!1,message:"Le numéro de téléphone est obligatoire"};try{const M={first_name:F.value.firstName,last_name:F.value.lastName,phone:F.value.phone,phone2:F.value.phone2||null,email:F.value.email||null,address:F.value.address||null,city:F.value.city||null,postal_code:F.value.postalCode||null,birth_date:F.value.birthDate||null,notes:F.value.notes||null,company:F.value.company?.trim()||null};if(he.value&&F.value.id){console.log("Mise à jour du client:",M);const s=await y(F.value.id,M);return s?(j(s),{success:!0,isNew:!1,message:`Client ${F.value.firstName} ${F.value.lastName} mis à jour`}):{success:!1,isNew:!1,message:"Erreur lors de la mise à jour"}}else{console.log("Création du client:",M);const s=await B(M);return s?(F.value.id=s.id,he.value=!0,j(s),{success:!0,isNew:!0,message:`Client ${F.value.firstName} ${F.value.lastName} créé`}):{success:!1,isNew:!1,message:"Erreur lors de la création"}}}catch(M){return console.error("Erreur lors de l'enregistrement du client:",M),{success:!1,isNew:!1,message:"Erreur lors de l'enregistrement"}}}}}const Wa={class:"card h-full flex flex-col overflow-hidden"},Za={class:"p-4 md:p-6 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},Ja={class:"flex items-center justify-between mb-3 md:mb-4"},Xa={class:"relative"},Ya={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-white dark:bg-gray-700 rounded-xl shadow-xl border border-gray-200 dark:border-gray-600 py-2 z-50"},es=["onClick"],ts={class:"text-xs md:text-sm font-medium text-gray-900 dark:text-gray-100"},rs={class:"text-[10px] md:text-xs text-gray-500 dark:text-gray-400 mt-0.5"},as={class:"flex-1 overflow-y-auto p-4 md:p-6 min-h-0 space-y-4 md:space-y-5 bg-gray-50 dark:bg-gray-800"},ss={class:"grid grid-cols-2 gap-3 md:gap-4"},os={class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider"},ls=["value","type","placeholder","maxlength","inputmode","autocomplete","onInput"],ns={class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider"},ds=["value","type","placeholder","onInput"],is={key:0,class:"col-span-2 flex items-center gap-3 p-3 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl"},cs=["checked"],us={class:"col-span-2 space-y-1.5 md:space-y-2"},ms={class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider flex items-center gap-1.5 md:gap-2"},ps={class:"grid grid-cols-2 gap-3 md:gap-4"},gs={class:"space-y-1.5 md:space-y-2"},ys={class:"space-y-1.5 md:space-y-2"},vs=["value","maxlength"],xs={class:"space-y-1.5 md:space-y-2"},bs={class:"p-4 md:p-6 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},fs={class:"grid grid-cols-3 gap-2 md:gap-3"},hs=["disabled"],ks=["disabled"],_s=["disabled"],ws={class:"hidden sm:inline"},Cs=pe({__name:"ClientPanel",setup(B){const{currentClient:y,isEditMode:j,clearClient:z,loadClient:R,hasClientInfo:P,saveClient:G}=Oa(),{searchClients:U,selectClient:M,clearSelection:s,selectedClient:m,invoiceInCompanyName:v,setInvoiceInCompanyName:S}=ke(),d=E(""),p=E([]),k=E(!1);let A=null;ve(d,b=>{if(A&&clearTimeout(A),b.trim().length<2){p.value=[];return}A=window.setTimeout(async()=>{k.value=!0;try{const c=await U(b);p.value=c}catch(c){console.error("Erreur recherche clients:",c),p.value=[]}finally{k.value=!1}},300)});const V=D(()=>d.value.trim().length>=2&&p.value.length>0),q=async()=>{const b=await G();b.success,alert(b.message)},_=()=>{z(),d.value="",s()},N=()=>{alert("Historique client à implémenter")},T=b=>{M(b),S(!1);const c={id:b.id,firstName:b.first_name,lastName:b.last_name,phone:Me(b.phone||""),phone2:Me(b.phone2||""),email:b.email||"",address:b.address||"",city:b.city||"",postalCode:Ge(b.postal_code||""),birthDate:b.birth_date||"",notes:b.notes||"",company:b.company||""};R(c),d.value=`${c.firstName} ${c.lastName}`,p.value=[]},te=b=>{const c=p.value[0];b.key==="Enter"&&c&&(b.preventDefault(),T(c))},J=[{key:"lastName",label:"Nom",type:"text",placeholder:"Dupont",span:1,format:null},{key:"firstName",label:"Prénom",type:"text",placeholder:"Jean",span:1,format:null},{key:"phone",label:"Tél. 1",type:"tel",placeholder:"06 12 34 56 78",span:1,format:"phone"},{key:"phone2",label:"Tél. 2",type:"tel",placeholder:"01 23 45 67 89",span:1,format:"phone"},{key:"email",label:"Email",type:"email",placeholder:"jean@email.com",span:2,format:null},{key:"birthDate",label:"Anniversaire",type:"date",placeholder:"",span:2,format:null},{key:"company",label:"Entreprise",type:"text",placeholder:"Nom de l'entreprise (optionnel)",span:2,format:null}];function ae(b,c,l){const i=l==="phone"?Me(c):c;y.value[b]=i}function O(b,c){y.value[b]=c}function K(b){y.value.postalCode=Ge(b)}return(b,c)=>(a(),n("div",Wa,[e("div",Za,[e("div",Ja,[c[6]||(c[6]=e("h2",{class:"text-xs md:text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider"},"Client",-1)),t(P)?(a(),n("div",{key:0,class:Q(["inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[10px] md:text-xs font-semibold transition-colors",t(j)?"bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300":"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-300"])},[(a(),le(Ce(t(j)?t(Ct):t(Qe)),{class:"w-3 h-3"})),e("span",null,g(t(j)?"Modification":"Nouveau"),1)],2)):H("",!0)]),e("div",Xa,[C(t($e),{class:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-gray-400 dark:text-gray-500 pointer-events-none z-10"}),ce(e("input",{"onUpdate:modelValue":c[0]||(c[0]=l=>d.value=l),onKeydown:te,type:"text",placeholder:"Rechercher un client...",class:"w-full pl-11 md:pl-14 pr-4 md:pr-5 py-3 md:py-3.5 bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all",autocomplete:"off"},null,544),[[ue,d.value]]),C(Ee,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:Pe(()=>[V.value?(a(),n("div",Ya,[(a(!0),n(Z,null,Y(p.value,l=>(a(),n("button",{key:l.id,onClick:i=>T(l),class:"w-full px-4 md:px-5 py-2.5 md:py-3 text-left hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[e("p",ts,g(l.first_name)+" "+g(l.last_name),1),e("p",rs,g(l.phone),1)],8,es))),128))])):H("",!0)]),_:1})])]),e("div",as,[e("div",ss,[(a(!0),n(Z,null,Y(J.filter(l=>l.span!==2),l=>(a(),n("div",{key:l.key,class:"space-y-1.5 md:space-y-2"},[e("label",os,g(l.label),1),e("input",{value:t(y)[l.key],type:l.type,placeholder:l.placeholder,maxlength:l.format==="phone"?t(Ke).phone:void 0,inputmode:l.format==="phone"?"numeric":void 0,autocomplete:l.format==="phone"?"tel":void 0,class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all",onInput:i=>ae(l.key,i.target.value,l.format)},null,40,ls)]))),128)),(a(!0),n(Z,null,Y(J.filter(l=>l.span===2),l=>(a(),n("div",{key:l.key,class:"col-span-2 space-y-1.5 md:space-y-2"},[e("label",ns,g(l.label),1),e("input",{value:t(y)[l.key],type:l.type,placeholder:l.placeholder,class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all",onInput:i=>l.format?ae(l.key,i.target.value,l.format):O(l.key,i.target.value)},null,40,ds)]))),128))]),t(m)?(a(),n("div",is,[e("input",{id:"cb-invoice-company",type:"checkbox",checked:t(v),onChange:c[1]||(c[1]=l=>t(S)(l.target.checked)),class:"w-4 h-4 rounded border-gray-300 dark:border-gray-500 text-gray-900 dark:bg-gray-600 focus:ring-gray-900 dark:focus:ring-emerald-500"},null,40,cs),c[7]||(c[7]=e("label",{for:"cb-invoice-company",class:"text-xs md:text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer"}," Facture au nom de l'entreprise ",-1))])):H("",!0),e("div",us,[e("label",ms,[C(t(ct),{class:"w-3 h-3 md:w-3.5 md:h-3.5"}),c[8]||(c[8]=e("span",null,"Adresse",-1))]),ce(e("input",{"onUpdate:modelValue":c[2]||(c[2]=l=>t(y).address=l),type:"text",placeholder:"123 Rue de la Paix",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all"},null,512),[[ue,t(y).address]])]),e("div",ps,[e("div",gs,[c[9]||(c[9]=e("label",{class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider"}," Ville ",-1)),ce(e("input",{"onUpdate:modelValue":c[3]||(c[3]=l=>t(y).city=l),type:"text",placeholder:"Paris",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all"},null,512),[[ue,t(y).city]])]),e("div",ys,[c[10]||(c[10]=e("label",{class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider"}," CP ",-1)),e("input",{value:t(y).postalCode,type:"text",inputmode:"numeric",maxlength:t(Ke).postalCode,placeholder:"75001",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all",onInput:c[4]||(c[4]=l=>K(l.target.value))},null,40,vs)])]),e("div",xs,[c[11]||(c[11]=e("label",{class:"block text-[10px] md:text-xs text-gray-600 dark:text-gray-400 font-semibold uppercase tracking-wider"}," Notes ",-1)),ce(e("textarea",{"onUpdate:modelValue":c[5]||(c[5]=l=>t(y).notes=l),placeholder:"Commentaires, préférences...",rows:"2",class:"w-full px-3 md:px-4 py-2.5 md:py-3 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 dark:placeholder-gray-400 border border-gray-300 rounded-xl text-xs md:text-sm font-medium focus:outline-none focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10 dark:focus:border-emerald-500 dark:focus:ring-emerald-500/30 hover:border-gray-400 transition-all resize-none"},null,512),[[ue,t(y).notes]])])]),e("div",bs,[e("div",fs,[e("button",{onClick:N,disabled:!t(j),class:"btn-secondary text-[10px] md:text-xs px-2 md:px-4 py-2.5 md:py-3"},[C(t(nt),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),c[12]||(c[12]=e("span",{class:"hidden sm:inline"},"Historique",-1))],8,hs),e("button",{onClick:_,disabled:!t(P),class:Q(["inline-flex items-center justify-center gap-1 md:gap-2 px-2 md:px-4 py-2.5 md:py-3 text-[10px] md:text-xs font-medium rounded-xl transition-all duration-200",t(P)?"bg-white border border-gray-300 text-red-600 hover:bg-red-50 hover:border-red-200 dark:bg-gray-700 dark:border-gray-600 dark:text-red-400 dark:hover:bg-red-900/30 dark:hover:border-red-800":"bg-gray-100 text-gray-400 cursor-not-allowed border border-gray-200 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-500"])},[C(t(Xe),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),c[13]||(c[13]=e("span",{class:"hidden sm:inline"},"Effacer",-1))],10,ks),e("button",{onClick:q,disabled:!t(P),class:Q(["btn-primary text-[10px] md:text-xs px-2 md:px-4 py-2.5 md:py-3",t(j)?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-500":"bg-emerald-600 hover:bg-emerald-700 dark:bg-emerald-600 dark:hover:bg-emerald-500"])},[(a(),le(Ce(t(j)?t(pt):t(Qe)),{class:"w-3.5 h-3.5 md:w-4 md:h-4"})),e("span",ws,g(t(j)?"Modifier":"Créer"),1)],10,_s)])])]))}}),$s={class:"flex-1 flex flex-col lg:flex-row gap-4 p-4 lg:gap-6 lg:p-6 pb-20 lg:pb-6"},Ss={class:"lg:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 shadow-lg z-50"},Ps={class:"flex"},Es=["onClick"],Ts={class:"text-xs font-medium"},zs=pe({__name:"CaissePage",setup(B){const y=E("services"),j=[{id:"services",label:"Services",icon:dt},{id:"ticket",label:"Ticket",icon:wt},{id:"client",label:"Client",icon:$t}];return(z,R)=>(a(),n(Z,null,[e("main",$s,[e("aside",{class:Q(["lg:w-80 lg:flex-shrink-0",y.value==="ticket"?"block":"hidden lg:block"])},[C(Er)],2),e("section",{class:Q(["flex-1 min-w-0",y.value==="services"?"block":"hidden lg:block"])},[C(Ga)],2),e("aside",{class:Q(["lg:w-80 xl:w-96 lg:flex-shrink-0",y.value==="client"?"block":"hidden lg:block"])},[C(Cs)],2)]),e("nav",Ss,[e("div",Ps,[(a(),n(Z,null,Y(j,P=>e("button",{key:P.id,onClick:G=>y.value=P.id,class:Q(["flex-1 flex flex-col items-center justify-center py-3 transition-colors",y.value===P.id?"text-gray-900 bg-gray-100 dark:text-gray-100 dark:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-50 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:bg-gray-700/70"])},[(a(),le(Ce(P.icon),{class:"w-5 h-5 mb-1"})),e("span",Ts,g(P.label),1)],10,Es)),64))])])],64))}});export{zs as default};
